(function(A,B){typeof exports=="object"&&typeof module!="undefined"?B(exports,require("crypto"),require("path"),require("posthtml"),require("posthtml-expressions"),require("posthtml-match-helper"),require("posthtml-render"),require("lodash"),require("fs-extra"),require("postcss"),require("postcss-load-config"),require("postcss-safe-parser"),require("postcss-selector-parser"),require("connect-history-api-fallback"),require("fast-glob"),require("shelljs"),require("circular"),require("execa"),require("html-minifier-terser"),require("@rollup/pluginutils"),require("node-localstorage")):typeof define=="function"&&define.amd?define(["exports","crypto","path","posthtml","posthtml-expressions","posthtml-match-helper","posthtml-render","lodash","fs-extra","postcss","postcss-load-config","postcss-safe-parser","postcss-selector-parser","connect-history-api-fallback","fast-glob","shelljs","circular","execa","html-minifier-terser","@rollup/pluginutils","node-localstorage"],B):(A=typeof globalThis!="undefined"?globalThis:A||self,B(A.posthtmlView={},A.crypto,A.path,A.posthtml,A.expressions,A.match,A.posthtmlRender,A.lodash,A.fse,A.postcss,A.postcssrc,A.postcssSafeParser,A.postcssSelectorParser,A.history,A.fg,A.shell,A.circular,A.execa,A.htmlMinifierTerser,A.pluginutils,A.nodeLocalstorage))})(this,function(A,B,ie,oe,ue,fe,pe,_t,he,me,de,ge,ye,_e,ve,we,be,$e,xe,je,Ee){"use strict";function q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var N=q(ie),L=q(oe),Pe=q(ue),k=q(fe),Y=q(he),Ce=q(me),Ie=q(de),vt=q(ge),wt=q(ye),ke=q(_e),Se=q(ve),Ae=q(we),Re=q(be),De=q($e);function Te(t,e=0){const s=1540483477,r=24;let a=t.length,i=e^a,u=0;for(;a>=4;){let f=He(t,u);f=F(f,s),f^=f>>>r,f=F(f,s),i=F(i,s),i^=f,u+=4,a-=4}switch(a){case 3:i^=bt(t,u),i^=t.charCodeAt(u+2)<<16,i=F(i,s);break;case 2:i^=bt(t,u),i=F(i,s);break;case 1:i^=t.charCodeAt(u),i=F(i,s);break}return i^=i>>>13,i=F(i,s),i^=i>>>15,i>>>0}function He(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function bt(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function F(t,e){t|=0,e|=0;const s=t&65535,r=t>>>16;return s*e+((r*e&65535)<<16)|0}function $t(t){return Te(t).toString(36)}const Ne=/[^-_a-z0-9\u00A0-\uFFFF]/gi,qe=/^\d/;function Z(t,e){return t&&t.replace(Ne,e||"_").replace(qe,e||"_")}const Me=/^(https?:)?\/\//,xt=t=>Me.test(t),Oe=/^\s*data:/i,jt=t=>Oe.test(t),Fe=/({|@|:|})/g;function Et(t){return t.replace(Fe,"\\$1")}function*at(t=[],e=!0,s){s=s||(d=>!0);let r="abcdefghijklmnopqrstuvwxyz";e&&(r=r+r.toUpperCase());const i=r+"0123456789",u=r.length,f=i.length;t=[...t||[],/ad/i];let m=0,h=0;for(;;){let d=u,x="";do x=x+i.charAt(h%d),h=~~(h/d),d=f;while(h>0);!t.some(w=>w.test(x))&&s(x)&&(yield x),m++,h=m}}function Be(t,e,s,r){return N.default.join(N.default.isAbsolute(r)?t:N.default.dirname(s||e),r)}function Ve(t,e,s){return e=We(N.default.normalize(N.default.relative(t,e))),s?e[0]==="/"?e:`/${e}`:e}function We(t){const e=/^\\\\\?\\/.test(t),s=/[^\u0000-\u0080]+/.test(t);return e||s?t:t.replace(/\\/g,"/")}const Ue=require("cssjanus"),Pt=new Map,Ct=/\/\*(.*?)\*\//gs,Ge=/--noflip-rtl-placeholder-\d+:\s*1;?/g,Le=/{(.*?)}/gs;function nt(t,e){const s=Pt.get(t);if(s)return s;let r=ct(t);return r=Ue.transform(r,{transformDirInUrl:!1,transformEdgeInUrl:!1,...e}),r=r.replace(Ct,""),Pt.set(t,r),r}function It(t){return t.replace(Le,e=>{let s=-1;return e.replace(Ct,r=>r.includes("@noflip")?(s=s+1,`--noflip-rtl-placeholder-${s}:1;`):r)})}function ct(t,e){return t.replace(Ge,e===""?e:"/* @noflip */")}const kt=/^(?:x-|v-|:|@)/,Je=/\B([A-Z])/g;function ze(t){return(t||"").replace(Je,"-$1").toLowerCase()}function Qe(t){let e=t.replace(".html","-html").replace(/\.|_/g,"").split("/").map(s=>ze(s)).filter(Boolean);return Z(e.join("-"),"-")}const X=/\\?{\\?@(\\?:|\\?#)(.*?)\\?@\\?}/gs;function K(t){const e=!!(t&&X.test(t));return X.lastIndex=0,e}function St(t){return K(t)}const Ye=/\.(ttf|eot|woff|woff2)$/;function Ze(t){return t=t.split("#")[0],t=t.split("?")[0],Ye.test(t)}const Xe=/\/\*(.*?)\*\//gs;function Ke(t){return t=t&&t.replace(Xe,e=>K(e)?"":e),K(t)}function ts(t){return t&&t.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function At(t,e=!0){return t=t.replace(/ ?[\n\r]+ ?/g,"").replace(/\s{2,}/g,e?" ":""),ts(t).replace(/\s*;\s*/g,";")}const es=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],ss=["a","animate","animateMotion","animateTransform","circle","clipPath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"];function rs(t,e,s){return function(r){const a=t.content||[],i={};a.length&&r.match.call(a,k.default("template"),f=>(!f.attrs||!f.attrs.slot||(i[f.attrs.slot]=f),f));const u=r.match(k.default("slot"),f=>{const m=f.attrs&&f.attrs.name||"";if(!m)return Rt(f.content,a.filter(d=>!(d.tag==="template"&&d.attrs&&d.attrs.slot)));const h=i[m];return h?Rt(f.content,h.content,as(h)):f.content||[]});return t.tag=!1,t.content=u,r}}function Rt(t,e,s){switch(t=Array.isArray(t)?t:[t||""],e=Array.isArray(e)?e:[e||""],s){case"replace":t=e;break;case"prepend":t=[...e,...t];break;case"append":t=[...t,...e];break;default:t=e.filter(Boolean).length===0?t:e;break}return t}function as(t){let e=t.attrs&&t.attrs.type||"";return["replace","prepend","append"].includes(e)||(e="replace"),e}function Dt(t,e,s,r){return L.default((r||[]).concat(e)).process(pe.render(s),t).then(a=>a.tree)}function ns(t,e,s,r){const a={};Object.entries(e||{}).forEach(([f,m])=>{a[f]=cs(m)});const i={MODE:s.mode,DEV:s.mode==="development",PROD:s.mode==="production",PAGE:s.slash(s.from,!0)},u={[s.$attrs]:_t.merge({},s.locals,t.locals,a,{env:i})};return Pe.default({locals:u})}function cs(t){try{return new Function(`return ${t}`)()}catch{return t}}let lt;async function ls({registerComponentsFile:t,root:e,mode:s,encoding:r,prefix:a,join:i,slash:u}){if(lt)return lt;if(!t)return{};const f={},m=i(e,t),h=await Y.default.readFile(m,r);function d(x){x.match(k.default(a("components")),w=>(w.content&&w.content.forEach(E=>{if(typeof E=="string")return;let{src:C,...j}=E.attrs||{};E.tag&&C&&(C=i(m,C),f[E.tag]={tag:E.tag,src:C,resolveId:u(C),locals:j})}),w))}return await L.default([]).use(d).process(h,{}),s!=="development"&&(lt=f),f}const is=/^(-\w+-)?animation-name$/,os=/^(-\w+-)?animation$/,us=/-?keyframes$/,Tt=/(?<=^|[^\w\-\u0080-\uffff])url\(\s*('[^']+'|"[^"]+"|[^'")]+)\s*\)/,Ht=/image-set\(([^)]+)\)/;function Nt(t,e,s,r,a,i,u){const f=vt.default(t,{from:r}),m={classNames:[],tags:{},assetsCache:new Set},h=Object.create(null);let d=!1,x="";if(!u){let w=function(l){l.forEach(o=>{if(o.type==="atrule"&&(o.name==="media"||o.name==="supports"))w(o.nodes);else switch(o.type){case"rule":if([a,i].includes(o.selector+"{}"))return;gs(o.nodes),o.selector=Ft(ds(o.selector,x,m));break;case"atrule":if(us.test(o.name))if(o.params.startsWith(":global"))o.params=Ft(o.params);else{const y=`_${j}`;o.params.endsWith(y)||(d=!0,h[o.params]=o.params=o.params+y)}break}})};const E=l=>l.replace(a,"").replace(i,""),C=s.mode==="production",j=$t(`scoped-${e}:`+(C?E(t||""):""));x=Z((s.styled.prefix||"")+j),w(f.nodes)}return f.walkDecls(w=>{d&&(is.test(w.prop)&&(w.value=w.value.split(",").map(j=>h[j.trim()]||j.trim()).join(",")),os.test(w.prop)&&(w.value=w.value.split(",").map(j=>{const l=j.trim().split(/\s+/),o=l.findIndex(P=>h[P]);return o!==-1?(l.splice(o,1,h[l[o]]),l.join(" ")):j}).join(",")));const E=Tt.test(w.value),C=Ht.test(w.value);if(E||C){const j=o=>(o=s.join(r,o),o=s.slash(o,!0),m.assetsCache.add(o),o),l=E?fs:ps;w.value=l(w.value,j)}}),{scopedHash:x,scopedClasses:m,css:f.toString()}}function fs(t,e){return qt(t,Tt,s=>{const[r,a]=s;return Mt(a,r,e)})}function ps(t,e){return qt(t,Ht,s=>{const[r,a]=s;return`image-set(${ms(a,({url:u})=>Mt(u,r,e))})`})}function qt(t,e,s){let r,a=t,i="";for(;r=e.exec(a);)i+=a.slice(0,r.index),i+=s(r),a=a.slice(r.index+r[0].length);return i+=a,i}function Mt(t,e,s){let r="";const a=t[0];return(a==='"'||a==="'")&&(r=a,t=t.slice(1,-1)),xt(t)||jt(t)||t.startsWith("#")?e:`url(${r}${s(t)}${r})`}const hs=/( |\\t|\\n|\\f|\\r)+/g;function ms(t,e){const r=t.split(",").map(a=>{const[i,u]=a.replace(hs," ").trim().split(" ",2);return{url:i,descriptor:u}}).filter(({url:a})=>!!a).map(({url:a,descriptor:i})=>({url:e({url:a,descriptor:i}),descriptor:i}));return r.reduce((a,{url:i,descriptor:u},f)=>(u=u||"",a+=i+` ${u}${f===r.length-1?"":", "}`),"")}function ds(t,e,s){return wt.default(r=>{r.walk(a=>{if((a.type==="class"||a.type==="tag")&&!(Ot(a.parent)||Ot(a.parent&&a.parent.parent))){let u=a.value;a.type==="class"&&(St(u)&&(u=Et(u)),s.classNames.includes(u)||s.classNames.push(u)),a.type==="tag"&&(s.tags[u]=!0),a.setPropertyWithoutEscape("value",`${u}.${e}`)}})}).processSync(t)}function gs(t){t.forEach(e=>{e.type==="decl"&&["undefined","null"].includes(e.value)&&(e.remove(),e.cleanRaws())})}function Ot(t){return!!(t&&t.type==="pseudo"&&t.value===":global")}const ys=/:global\((.*?)\)/gs;function Ft(t){return t.replace(ys,"$1")}let V,tt;const Bt=()=>{try{V=V||Ie.default.sync()}catch{V={file:"",options:{},plugins:[]}}tt=tt||Ce.default(V.plugins)};function _s(t){function e(s,r){return async function(a){const i=[],u=js(a,s);if(a.walk(f=>{if(typeof f=="string"||!f.tag)return f;const m=f.attrs||{},h=xs(m,f.tag,u,s);if(h){if(es.includes(h.tag))throw new Error(`The component <${h.tag}> is the HTML tag. page file: ${s.from}`);if(ss.includes(h.tag))throw new Error(`The component <${h.tag}> is the SVG tag. page file: ${s.from}`);f.attrs&&delete f.attrs[s.prefix("query")],i.push($s(h,s.encoding).then(ws(f,h,s)).then(d=>{const x={...s,from:h.src};return e(x,!1)(d)}).then(rs(f)))}return f}),r){const f=s.slash(s.from);i.push(Vt(null,{tag:f.replace(/\/|\./g,"-"),src:s.from,resolveId:f,locals:{}},s)(a))}return i.length>0&&(await Promise.all(i),i.length=0),r?await vs(a,s):a}}return e(t,!0)}async function vs(t,e){const{styled:s,js:r,from:a,mode:i,rtl:u}=e,f=i==="development",m="@",h="__posthtml_view_css__";let d="";const x=[];f&&(t.match(k.default("body"),c=>{const p={tag:"div",attrs:{id:h,"data-id":"development_css_container",style:"display: none !important;"}};return c.content=[p,...c.content||[]],c}),t.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir=u?"rtl":"ltr",c)));const w=new Map,E=[],C=new Map,j=[],l=typeof s.extract=="function",o=r.type==="ts"?"ts":"js";t.match(k.default("style"),function(c){const p=et(c.content);c.attrs=c.attrs||{};const b=c.attrs["data-scoped-hash"]||"",S=c.attrs["data-resolve-id"]||"";let $=c.attrs["data-to"]||s.to||"head";if(f&&$!=="*"&&($=`#${h}`),(c.attrs["data-to"]==="file"||$==="file")&&l)p&&!C.has(S)&&(C.set(S,{}),!j.includes(S)&&j.push(S),C.set(S,{to:"file",css:p,scopedHash:b,resolveId:S}));else if(p&&!w.has(S)){if(w.set(S,{}),$==="*")return f||(delete c.attrs["data-to"],delete c.attrs["data-scoped-hash"],delete c.attrs["data-resolve-id"]),c;!E.includes(S)&&E.push(S),w.set(S,{to:$,css:p,scopedHash:b,resolveId:S})}return c.tag=!1,delete c.content,c}),t.match(k.default('script[type="module"]'),c=>{if(!d&&c.attrs&&c.attrs.src){if(/^(https?:)?\/\//.test(c.attrs.src))return c;c.attrs.src=c.attrs.src+"?__posthtml_view__=0",d=c.attrs.src}return c});function P(){return d||(d=e.slash(a,!0).replace(".html","."+o)+"?__posthtml_view__=1",Array.isArray(t)&&t.push({tag:"script",attrs:{type:"module",src:d}}),d)}const y=new Map,_=c=>{r&&typeof r.extract=="function"&&r.extract(c)};t.match(k.default("script[data-resolve-id]"),c=>{c.attrs=c.attrs||{};const p=c.attrs["data-resolve-id"]||"";if(p&&!y.has(p)){y.set(p,null);const b=c.attrs.src||"",S=c.attrs["data-scoped-hash"]||"",$=(b?"":et(c.content))||"";let v=b&&N.default.extname(b).replace(".","")||o;v=v==="ts"?"ts":"js",_({type:v,from:a,resolveId:p,scopedHash:S,source:$,mainjs:P(),src:b.replace(`.${v}`,"")})}return c.tag=!1,delete c.content,c});const R=new Set;Bt(),j.forEach(c=>{const p=C.get(c);if(!!p&&!!p.css){if(f){p.to=`#${h}`,R.add(p.to),t.match(k.default(p.to),b=>{R.delete(p.to);const S={tag:"style",attrs:{"data-to":"file","data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};return b.content?b.content=[S,...b.content]:b.content=[S],b});return}l&&x.push(tt.process(p.css,{...V.options,from:a||void 0}).then(b=>{s.extract&&s.extract({type:"css",from:a,mainjs:P(),resolveId:p.resolveId,scopedHash:p.scopedHash,source:b.css})}))}}),E.forEach(c=>{const p=w.get(c);!p||!p.css||(R.add(p.to),t.match(k.default(p.to),b=>{switch(R.delete(p.to),b.tag){case"head":const S=b.content&&b.content.find(v=>!v||typeof v=="string"?!1:v.tag==="style"&&v.attrs&&v.attrs[h]===m);if(S)S.content=st(S.content,p.css);else{const v={tag:"style",attrs:{[h]:m},content:p.css};b.content?b.content=st(b.content,v):b.content=[v]}break;case"style":b.content=st(b.content,p.css);break;default:const $={tag:"style",attrs:{"data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};b.content?b.content=st(b.content,$):b.content=[$];break}return b}))});const n=typeof e.trimAttr=="function"?e.trimAttr:null,g=typeof e.cumbersomeTrim=="function"?e.cumbersomeTrim:null,I=(c,p)=>{if(typeof p=="string"&&p.trim()){if(n)return n(c,p,At);if(c==="application/ld+json"||kt.test(c))if(p=At(p).trim(),p=p.replace(/^{\s+/g,"{").replace(/\s+}$/g,"}"),g)p=g(c,p);else{const b="[<?=@#$%!*&^@?>]";let S=[],$="";p.replace(/('|")(.*?)('|")/g,(v,D,M,yt)=>(S.push(`${D}${M}${yt}`),b)).replace(/\s+(&&|\|\||===?|!==?|<=|>=|\+=|-=)\s+/g,"$1").replace(/\s*\?\s*(.*?)\s*:\s*/g,"?$1:").replace(/(?<=[():\[\],\{\}"!'=])\s+/g,"").replace(/\s+(?=[():\[\],\{\}"!'=])/g,"").split(b).forEach((v,D)=>{$=$+v+(S[D]||"")}),p=$}return p}return null};return t.walk(c=>{if(c.tag&&c.attrs){if(Object.entries(c.attrs).forEach(([p,b])=>{if(["null","undefined"].includes(b)){delete c.attrs[p];return}const S=I(p,b||"");S&&(c.attrs[p]=S)}),c.tag==="script"&&c.attrs.type==="application/ld+json"&&c.content){const p=I(c.attrs.type,[].concat(c.content).join(""));p&&(c.content=[p])}c.attrs.class=(c.attrs.class||"").trim(),c.attrs.class||delete c.attrs.class}return c.tag&&(c.attrs=c.attrs||{},c.tag==="img"&&(c.attrs.alt=c.attrs.alt||""),c.tag==="button"&&(c.attrs.type=c.attrs.type||"button")),c}),t.match(k.default("style"),c=>{const p=et(c.content);return p&&x.push(tt.process(p,{...V.options,from:a||void 0}).then(b=>{c.content=[b.css]})),c}),R.forEach(c=>{throw Error("Invalid selector: "+c)}),await Promise.all(x).then(()=>(f||t.match(k.default("head"),c=>{const p={tag:"meta",attrs:{property:"posthtml:view-head-placeholder",content:"*"}};return c.content?c.content.push(p):c.content=[p],c}),t))}function ws(t,e,s,r){return function(a){return typeof s.htmlProcessor=="function"&&(a=s.htmlProcessor(a)),Dt(s.parser,s.plugins,a,[Vt(t,e,s),ns(e,t.attrs,s)])}}function Vt(t,e,s){Bt();const{stylePreprocessor:r,styled:a,addClassIncludes:i,assets:u,noflip:f,cssjanus:m}=s,h=d=>Promise.resolve(r(d));return async function(d){const x=[];let w=!1,E="",C=null;if(d.match(k.default("style"),l=>{const o=l.attrs||{},P=bs(a,o),y=et(l.content);let _=o.src;const R=o.dynamic!=null||Ke(y);return(_||y)&&x.push(Promise.resolve(null).then(()=>_?(_=s.join(e.src,_),Y.default.readFile(_,s.encoding)):Promise.resolve(y)).then(n=>n?(n=f(n),h(n)):{code:""}).then(n=>{const g=n&&n.code;return{...n,code:m(g||""),to:R&&P.to==="file"?"head":P.to,type:P.type}})),w&&(l.tag=!1,delete l.content),w=!0,l}),x.length>0){const l=await Promise.all(x);x.length=0;const o=l[0].type;let P="",y="",_=a.to;const R=":__posthtml_view_to_file_start_mark__{}",n=":__posthtml_view_to_file_end_mark__{}";l.forEach($=>{$.to==="file"&&$.code&&($.code=`${R}${$.code}${n}`),$.type==="scoped"&&(P=P+($.code||"")),$.type==="global"&&(y=y+($.code||"")),$.to!=="file"&&$.to!==a.to&&(_=$.to)});const g=Nt(P,e.resolveId,s,e.src,R,n,!1),I=Nt(y,e.resolveId,s,e.src,R,n,!0);P=g.css,E=g.scopedHash,C=g.scopedClasses,y=I.css,I.scopedClasses.assetsCache.forEach($=>{C&&C.assetsCache.add($)}),I.scopedClasses.assetsCache.clear(),l.length=0;const c=$=>{let v="";return $=$.replace(/:__posthtml_view_to_file_start_mark__{}(.*?):__posthtml_view_to_file_end_mark__{}/gs,function(D,M){return v=v+M,""}),{css:$,fileCss:v}},p=c(P),b=c(y);P=p.css,y=b.css;let S="";o==="global"?S=b.fileCss+p.fileCss:S=p.fileCss+b.fileCss,d.match(k.default("style"),$=>(o==="global"?$.content=[y+P]:$.content=[P+y],P="",y="",$.attrs=$.attrs||{},$.attrs["data-to"]=_,$.attrs["data-scoped-hash"]=E,$.attrs["data-resolve-id"]=e.resolveId,delete $.attrs.scoped,delete $.attrs.global,delete $.attrs.src,delete $.attrs.to,delete $.attrs.dynamic,$)),S&&Array.isArray(d)&&d.push({tag:"style",attrs:{"data-to":"file","data-scoped-hash":E,"data-resolve-id":e.resolveId},content:S})}const j=s.prefix("js");if(d.match(k.default("script"),l=>{l.attrs=l.attrs||{};let o=l.attrs.src;return o&&/^(https?:)?\/\//.test(o)?l:l.attrs[j]==="null"||l.attrs[j]==="false"?(delete l.attrs[j],l):o&&l.attrs.type&&l.attrs.type==="module"?(l.attrs.src=s.join(e.src,o),l.attrs.src=s.slash(l.attrs.src,!0),l):(l.attrs.type&&l.attrs[j]==null||(o&&(o=s.join(e.src,o),l.attrs.src=s.slash(o,!0)),l.attrs["data-to"]=l.attrs.to,l.attrs["data-scoped-hash"]=E,l.attrs["data-resolve-id"]=e.resolveId,delete l.attrs.to),l)}),d.walk(l=>{if(typeof l=="string")return l;l.attrs=l.attrs||{};const o=C;if(o&&E&&l.tag){const _=l.attrs,R=_.class||"",n=g=>{i&&i.length&&(g={},i.forEach(I=>{g[I]=_[I]}));for(const I in g)if(Object.prototype.hasOwnProperty.call(g,I)){const c=g[I]||"";if(o.classNames.some(p=>c.includes(p)))return!0}return!1};(o.tags[l.tag]||n(_))&&!R.includes(E)&&(l.attrs.class=`${E} ${R}`.trim())}Object.keys(l.attrs).forEach(_=>{!u.attributes.includes(_)&&u.attrRegExp.test(_)&&u.attributes.push(_)});const P=typeof u._include=="function"&&u._include,y=_=>{if(!String(_).trim()||P&&!P(_)||xt(_)||jt(_)||_.startsWith("#")||K(_))return _;let R=s.join(e.src,_);return R=s.slash(R,!0),C&&C.assetsCache.add(R),R};return u.attributes.forEach(_=>{if(l.attrs[_]){const R=l.attrs[_];let n;const g=R.replace(/('|")(.*?)('|")/g,(I,c,p,b)=>(n=!0,`${c}${y(p)}${b}`));l.attrs[_]=n?g:y(R)}}),l}),x.length>0&&(await Promise.all(x),x.length=0),s.mode!=="development"&&C&&C.assetsCache.size){const l={tag:"div",attrs:{__posthtml_view_assets_div__:!0,style:"display:none;"},content:[]};C.assetsCache.forEach(o=>{Ze(o)?l.content.push({tag:"link",attrs:{rel:"preload",as:"font",href:o,"data-raw-url":o}}):l.content.push({tag:"img",attrs:{src:o,"data-raw-url":o}})}),l.content.length&&Array.isArray(d)&&d.push(l),C.assetsCache.clear()}return d}}function bs(t,e){t={...t},t.to=e.to||t.to||"head";let s=t.type;return e.scoped!=null?s="scoped":e.global!=null&&(s="global"),t.type=s||"scoped",t}function $s(t,e){return t.source!=null?Promise.resolve(t.source||""):Y.default.readFile(t.src,e)}function xs(t,e,s,r){const a=r.prefix("query");return(t[a]||"")==="global"?r.components[e]:s[e]||r.components[e]}function js(t,{from:e,prefix:s,join:r,slash:a}){const i={};return t.match(k.default(s("components")),u=>(u.content&&u.content.forEach(f=>{if(typeof f=="string")return;let{src:m,...h}=f.attrs||{};f.tag&&m&&(m=r(e,m),i[f.tag]={tag:f.tag,src:m,resolveId:a(m),locals:h})}),u.tag=!1,delete u.content,u)),t.match(k.default(s("component")),u=>{const f=u.attrs||{};let m=!1;if(f.src){const h="view-src-"+Qe(f.src),d=r(e,f.src);i[h]={tag:h,src:d,resolveId:a(d),locals:{}},u.tag=h,delete f.src}else m=!0;return m&&(u.tag=!1,delete u.content),u}),i}function et(t){return[].concat(t||"").join("").trim()}function st(...t){return[].concat(...t).filter(Boolean)}function Wt(t){const e={...t||{}};return e.root=e.root||process.cwd(),e.mode=e.mode||"development",e.encoding=e.encoding||"utf8",e.viewPrefix=e.viewPrefix||"view:",e.from=e.from||"",e.plugins=e.plugins||[],e.parser=e.parser||{},e.locals=e.locals||{},e.$attrs=e.$attrs||"$attrs",e.stylePreprocessor=e.stylePreprocessor||(s=>({code:s})),e.js={type:"ts",...e.js},e.assets={...e.assets},e.assets.attributes=e.assets.attributes||["data-src","data-img"],e.assets.attrRegExp=e.assets.attrRegExp||kt,e.styled={type:"scoped",to:"head",prefix:"view-",...e.styled},typeof e.getOptions=="function"&&e.getOptions(e),e.join=(s,r)=>Be(e.root,e.from,s,r),e.slash=(s,r)=>Ve(e.root,s,r),e.prefix=s=>`${e.viewPrefix}${s}`,e.rtl=e.rtl||!1,e.cssjanus=s=>e.rtl&&e.mode==="development"?nt(s,{transformEdgeInUrl:e.rtl.transformEdgeInUrl,transformDirInUrl:e.rtl.transformDirInUrl}):s,e.noflip=s=>e.rtl?It(s):s,async function(r){e.components=await ls(e);const a=await _s(e)(r);return await Dt(e.parser,e.plugins,a)}}const Ut=/\.(css|scss|less|sass|styl|stylus|pcss|postcss)$/;function Gt(t){const e=Ut.test(t);return Ut.lastIndex=0,e}function Es(t,e){t.build=t.build||{},t.build.rollupOptions=t.build.rollupOptions||{},t.build.ssr=!1;const{input:s,pages:r}=Cs(t.root||process.cwd(),e);return t.build.rollupOptions.input=s,t.server=t.server||{},t.server.open===!0&&(t.server.open=r[0]&&`/${r[0].route||""}`||"/"),t}function Ps(t){const e=[];return Lt(t).forEach(r=>{const a=`./${r.path}`;r.pageName==="index"&&e.push({from:/^\/$/,to:a}),e.push({from:new RegExp(`^/${r.route}/*`),to:a}),e.push({from:new RegExp(`^/${r.route}$`),to:a})}),e}function Cs(t,e){const s=Lt(e),r={};return s.forEach(a=>{r[a.pageName]=N.default.resolve(t,a.path)}),{input:r,pages:s}}function Lt({pagesDirectory:t,includes:e,ignore:s}){return e=e.filter(Boolean).map(r=>r[0]==="/"?r:"/"+r),Se.default.sync(`${t}/**/*.html`.replace("//","/"),{objectMode:!0,ignore:s.map(r=>(r.includes(".")?r:`**/${r}/**`).replace("//","/"))}).filter(r=>e.some(a=>r.path.includes(a))?!0:!r.path.includes("/_")).map(({name:r,path:a})=>{const i={filename:r,path:a,route:"",pageName:""};return i.route=a.replace(`${t}/`,""),i.pageName=i.route.replace(/(\/index)?\.html/,"").replace("/","-"),i})}const Jt="0123456789abcdef",zt={"=":"\\:",php:"\\#","\\:":"=","\\#":"php"},Qt=/\\{\\@(\\:|\\#)(.*?)\\@\\}/gs,Is=/<\?(=|php)(.*?)\?>/gs,ks=/(\\@\\})=""/g;function Yt(t){return t.replace(Qt,function(e,s,r){return`<?${zt[s]||s}${r}?>`})}function Zt(t){return t.replace(Is,function(e,s,r){return`\\{\\@${zt[s]||s}${Ss(r,Jt)}\\@\\}`})}function Xt(t){return t.replace(ks,"$1").replace(Qt,function(e,s,r){return`\\{\\@${s}${As(r,Jt)}\\@\\}`})}function Ss(t,e){const s=B.createCipheriv("aes128",e,e);let r=s.update(t,"utf8","hex");return r+=s.final("hex"),r}function As(t,e){const s=B.createDecipheriv("aes128",e,e);let r=s.update(t,"hex","utf8");return r+=s.final("utf8"),r}async function Rs(t,e,s=!0){let r=null;if(Ae.default.test("-f",t))try{let a=null;(u=>{s&&require&&require.cache&&!!require.cache[u]&&delete require.cache[u]})(t),a=require(t),a&&(a=a.__esModule?a.default:a,typeof a=="function"?r=a(e):r=a)}catch(a){console.error(a)}return r||{}}const Kt=new Map;async function Ds(t,e,s,r){const a=N.default.join(s,".php-dev",r);return Kt.get(r)!==t&&(Kt.set(r,t),await Y.default.outputFile(N.default.resolve(e,a),t,"utf8")),{tplFileName:a,__views:""}}async function Ts(t,e,s){const{__views:r,...a}=s,i=a;i._TEMPLATE=t,i._REGISTER_GLOBAL_MODEL=!0,i._VIEWS_PATH=r;const u=JSON.stringify(i,Re.default()),{stdout:f}=await De.default("php",e&&e.length?e:[N.default.join(__dirname,"/loader.php")],{input:u});return f}const it={caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!0,collapseWhitespace:!0,conservativeCollapse:!1,html5:!0,minifyCSS:!0,minifyJS:!0,minifyURLs:!0,noNewlinesBeforeTagClose:!0,removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!1,useShortDoctype:!0};let ot;async function rt(t,e){return typeof e.minifyHtml=="function"&&(e.minifyHtml=e.minifyHtml(it)),e.minifyHtml&&(ot=ot||(e.minifyHtml===!0?it:{...it,...e.minifyHtml,removeTagWhitespace:!1}),t=await xe.minify(t,ot),typeof e.minifyHtmlAfter=="function"?t=e.minifyHtmlAfter(t):t=t.replace(/>(\s+)</g,"><")),t}function ut(t){return t.split("?__posthtml_view__=")[0]}const Hs=(t,e,s,r,a)=>{function i(m){const h=N.default.resolve(t.root,e.pagesDirectory);return N.default.relative(h,m)}const u=t.command==="serve",f='<div style="text-align:center;"><h1>posthtml-view</h1><p>No content</p></div>';return async(m,h)=>{const d=i(h.filename);e.php&&(m=Zt(m));const x=L.default([Wt({...e,from:h.filename,htmlProcessor(w){return Zt(w)},styled:{...e.styled,extract:w=>{const E=ut(w.mainjs),C=`${s}/${w.resolveId.replace(".html",".css")}`,j=`import '${C}';`;a.set(C,w.source||"");const l=r.get(E)||"";l.includes(C)||r.set(E,l+j)}},js:{...e.js,extract:w=>{const E=ut(w.mainjs);if(w.src){const C=r.get(E)||"",j=`import '${w.src}';`;C.includes(w.src)||r.set(E,C+j)}else{const C=`${s}/${w.resolveId.replace(".html","")}`,j=`import '${C}';`;a.set(C,w.source||"");const l=r.get(E)||"";l.includes(C)||r.set(E,l+j)}}}}),...e.plugins||[]]);if(typeof e.usePlugins=="function"&&e.usePlugins(x),m=(await x.process(m,{directives:[{name:"!DOCTYPE",start:"<",end:">"},{name:"?php",start:"<",end:">"},{name:"?=",start:"<",end:">"}],...e.parser,sync:!1})).html.trim(),u)if(e.php){if(m=Xt(m),e.devMinifyHtml&&(m=await rt(m,e)),m=Yt(m),typeof e.php.devRender=="function")m=await e.php.devRender({html:m,options:e});else{const w=N.default.join(t.root,e.mocksDirectory,d.replace(".html",".js"));typeof e.php.writeTemplateBefore=="function"&&(m=e.php.writeTemplateBefore(m)||m);const[E,{tplFileName:C,__views:j}]=await Promise.all([Rs(w,h.originalUrl||"",!0),Ds(m,t.root,e.cacheDirectory,d)]);m=await Ts(C,e.php.args,{__views:j,...E})}return m||f}else e.devMinifyHtml&&(m=await rt(m,e));return m}};let O,ft,pt,W;const T={classesKey:"_classes",idsKey:"_ids",_classes:{},_ids:{},classes:{},ids:{}},J={},z={};function te(t,e){try{const s=W.getItem(t)||{};return Object.keys(s).forEach(r=>{const a=s[r];e[a]=null}),s}catch{return{}}}async function Ns(){W&&(W.setItem(T.classesKey,T.classes),W.setItem(T.idsKey,T.ids))}function qs(t){O=O||t,O.__cache_file__&&!W&&(W=new Ee.JSONStorage(O.__cache_file__),T._classes=te(T.classesKey,J),T._ids=te(T.idsKey,z)),ft=ft||at(O.generateNameFilters,O.upperCase,e=>J[e]!==null),pt=pt||at(O.generateNameFilters,O.upperCase,e=>z[e]!==null)}function ee(t){const e=vt.default(t);function s(r){r.forEach(a=>{if(a.type==="atrule"&&(a.name==="media"||a.name==="supports"))s(a.nodes);else switch(a.type){case"rule":a.selector=Ms(a.selector);break}})}return s(e.nodes),e.toString()}function Ms(t){return wt.default(e=>{e.walkClasses(s=>{if(U(s.value,!1,!1))return;let r=s.value,a=!1;const i=r.replace(X,u=>(a=!0,` ${u} `));if(a){r=i.split(/\s+/).map(u=>{if(!u)return"";if(U(u,!1))return u;const f=ht(u);return G(f)||u}).filter(Boolean).join("").trim(),r=Et(r),s.setPropertyWithoutEscape("value",r);return}s.setPropertyWithoutEscape("value",G(ht(r))||r)}),e.walkIds(s=>{U(s.value,!0)||(s.value=G(mt(s.value))||s.value)})}).processSync(t)}function ht(t){const e=T._classes[t];if(e)return J[e]=null,T.classes[t]=e,delete T._classes[t],e;const s=T.classes[t];if(s)return J[s]=null,s;const r=ft.next().value;return J[r]=null,T.classes[t]=r,r}function mt(t){const e=T._ids[t];if(e)return z[e]=null,T.ids[t]=e,delete T._ids[t],e;const s=T.ids[t];if(s)return z[s]=null,s;const r=pt.next().value;return z[r]=null,T.ids[t]=r,r}function U(t,e,s){return s!==!1&&St(t)?!0:(t=(e?"#":".")+t,O.filters.some(r=>typeof r=="string"?r===t:r.test(t)))}function G(t){return t&&O.prefix+t}function Os(t){if(U(t,!0))return;const e=mt(t);if(e)return G(e)}function se(t){if(t=t.slice(1),U(t,!0))return;const e=T.ids[t];if(e)return"#"+G(e)}const Fs=/\\?@\\?}(.*?)\\?{\\?@/gs,Bs=/\s+(\\?{\\?@)/g;function Q(t,e,s){return t&&(e||(t=t.replace(X,r=>` ${r} `)),t=t.split(/\s+/).map(r=>{if(!r)return"";if(U(r,e)||typeof s=="function"&&s(r))return r;const a=e?mt(r):ht(r);return G(a)||r}).filter(Boolean).join(" ").trim(),e||(t=t.replace(Fs,(r,a)=>a?r.replace(a,` ${a.trim()} `):r).replace(Bs,"$1")),t)}const re="[[rtl]]",ae="[[ltr]]",dt={type:"syntax",syntax:`<?php if($rtl): ?>${re}<?php else: ?>${ae}<?php endif; ?>`,devPreview:t=>!!(t&&(t.includes("rtl=1")||t.includes("lang=ar")))},ne={enableCache:!0,generateNameFilters:[],upperCase:!0,filters:[/^(\.|#)js-/],attributes:[],blurryAttrs:[],prefix:"",__cache_file__:""};let H;function Vs(t){return typeof t.rtl=="boolean"?t.rtl?dt:!1:{...dt,...t.rtl}}const Ws=/(.*)\[\[(rtl|ltr)\]\](.*)\[\[(rtl|ltr)\]\](.*)/si;function Us(t,e){const s=je.createFilter(["**/*.html"]);let r,a=t.preloadCss!==!1;const{type:i,syntax:u}=e||dt,f=j=>nt(j,{transformDirInUrl:e&&e.transformDirInUrl||!1,transformEdgeInUrl:e&&e.transformEdgeInUrl||!1}),m=()=>u&&(u.includes(re)||u.includes(ae));let h=null;if(e&&i==="syntax"&&m()){const j=u.match(Ws);j&&j.length>=6&&(h=j.slice(1).map(l=>l.trim()).filter(Boolean))}const d=["crossorigin","nomodule","defer","async","hidden","x-transition","x-ignore","x-cloak","x-collapse",...t.boolAttrs||[]],x=[],w=[];function E(j){j.walk(l=>(l.attrs&&Object.keys(l.attrs).forEach(P=>{l.attrs[P]===""&&d.some(y=>y.indexOf(P)===0)&&(l.attrs[P]=!0)}),l))}const C=async j=>(await L.default([]).use(l=>(l.match(k.default("head"),o=>{const P=[];l.match.call(o,k.default('link[rel="preload"][as="style"][href]'),n=>(n.tag=!1,n)),l.match.call(o,k.default('link[rel="stylesheet"][href]'),n=>{const g=n.attrs||{};return n.tag&&g.href&&x.some(I=>g.href&&g.href.includes(I))&&(a&&P.push({tag:"link",attrs:{...g,rel:"preload",as:"style",href:g.href}}),P.push({tag:"link",attrs:g}),n.tag=!1),n}),l.match.call(o,k.default('script[type="module"][src],link[rel="modulepreload"][href]'),n=>{const g=n.attrs||{},I=g.href||g.src;return n.tag&&I&&w.some(c=>I.includes(c))&&(P.push({tag:n.tag,attrs:g}),n.tag=!1),n});const y=[];l.match.call(o,k.default('link[rel="preload"][as="image"][href]'),n=>{const g=n.attrs||{};return n.tag&&g.href&&(y.push({tag:"link",attrs:g}),n.tag=!1),n});const _=[];l.match.call(o,k.default("style[__posthtml_view_css__]"),n=>{const g=le(n.content);return n.tag&&g&&!_.includes(g)&&_.push(g),n.tag=!1,delete n.content,n});const R=_.map(n=>({tag:"style",content:n}));return l.match.call(o,k.default('meta[property="posthtml:view-head-placeholder"]'),n=>(n.content=[...P,...y,...R],n.tag=!1,n)),o}),H&&l.match(k.default("style"),o=>{if(o.attrs&&o.attrs["data-min-class-ignore"]!=null)return delete o.attrs["data-min-class-ignore"],o;const P=le(o.content);return P&&(o.content=[ee(P)]),o}),l)).use(l=>{const o=new Map,P=n=>(n&&o.size&&o.forEach((g,I)=>{n=ce(n,I,g)}),n);l.match(k.default("div[__posthtml_view_assets_div__]"),n=>(l.match.call(n,k.default("[data-raw-url]"),g=>(g.attrs&&g.attrs["data-raw-url"]&&o.set(g.attrs["data-raw-url"],g.attrs.href||g.attrs.src||""),g.tag=!1,g)),n.tag=!1,delete n.content,n));const y=t.assets.attributes,_=t.assets.attrRegExp;l.walk(n=>{if(typeof n=="string")return n;if(n.attrs){const g=Object.keys(n.attrs);g.forEach(c=>{!y.includes(c)&&_.test(c)&&y.push(c)}),y&&y.forEach(c=>{n.attrs[c]&&(n.attrs[c]=P(n.attrs[c]))}),n.attrs.style&&(n.attrs.style=P(n.attrs.style));const I=(n.attrs["view-build-class"]||"").split(" ").filter(Boolean);if(delete n.attrs["view-build-class"],H){const c=[...H.attributes,/^[xv]-transition/],p=[...H.blurryAttrs,/^([xv]-bind)?:class/],b=(v,D)=>v.some(M=>typeof M=="string"?M===D:M.test&&M.test(D)),S=v=>r.assetsInclude(v)?!0:I.length?!I.includes(v):!1;if(g.forEach(v=>{if(!(v==="id"||v==="class")&&typeof n.attrs[v]=="string"&&!(typeof n.attrs[v]=="string"&&!n.attrs[v].trim()))if(b(c,v))n.attrs[v]=Q(n.attrs[v],!1,S);else if(b(p,v)){const D=n.attrs[v]||"";let M;const yt=D.replace(/('|")(.*?)('|")/g,(Ys,Js,zs,Qs)=>(M=!0,`${Js}${Q(zs,!1,S)}${Qs}`));n.attrs[v]=M?yt:D}else I.length&&I.forEach(D=>{if(n.attrs[v].includes(D)){const M=Q(D);n.attrs[v]=ce(n.attrs[v],D,M)}})}),n.attrs.class&&(n.attrs.class=Q(n.attrs.class)),n.attrs.id&&(n.attrs.id=Q(n.attrs.id,!0)),n.attrs.for){const v=Os(n.attrs.for);v&&(n.attrs.for=v)}if(["mask","fill","filter"].forEach(v=>{if(n.attrs[v]){const D=se(n.attrs[v].replace(/url\((.*?)\)/g,"$1"));D&&(n.attrs[v]=`url(${D})`)}}),n.tag==="use"&&(n.attrs.href||n.attrs["xlink:href"])){const v=n.attrs.href?"href":"xlink:href",D=se(n.attrs[v]||"");D&&(n.attrs[v]=D)}}}return n});const R="posthtml-view-syntax-style-x";return l.match(k.default("style"),n=>{let g=P([].concat(n.content||"").join("").trim()),I=g&&ct(g,"");if(I&&h&&h.length){const c=f(g);if(c!==I)return n.content=h.map(p=>p==="rtl"?{tag:R,attrs:n.attrs,content:c}:p==="ltr"?{tag:R,attrs:n.attrs,content:I}:p),n.tag=!1,n.attrs=void 0,n}return I&&(n.content=[I]),n}),h&&h.length?(l.match(k.default("link[href]"),n=>{const g=n.attrs&&n.attrs.href;if(n.attrs&&g&&g.endsWith(".css")&&h){const I=g.replace(".css",".rtl.css");n.attrs.href=h.map(c=>c==="rtl"?I:c==="ltr"?g:c).join("")}return n}),l.match(k.default("html"),n=>(h&&(n.attrs=n.attrs||{},n.attrs.dir=h.map(g=>g==="rtl"?"rtl":g==="ltr"?"ltr":g).join("")),n))):l.match(k.default("html"),n=>(n.attrs=n.attrs||{},n.attrs.dir="ltr",n)),Promise.resolve().then(()=>(l.match(k.default(R),n=>(n.tag="style",n)),l))}).use(l=>Promise.resolve().then(()=>{let o;return typeof t.generateUsePlugins=="function"&&(o=t.generateUsePlugins(l)),E(o||l)})).process(j,{})).html;return{name:"view:posthtml-view-bundle",enforce:"post",apply:"build",configResolved(j){r=j},async generateBundle(j,l){const o=t.minifyClassnames;o&&!H&&(H=o===!0?ne:{...ne,...o},H.prefix=H.prefix&&Z(H.prefix),H.filters=[...H.filters,"#vite-legacy-polyfill","#vite-legacy-entry"],H.enableCache?H.__cache_file__=N.default.join(r.root,N.default.join(t.cacheDirectory,"css")):H.__cache_file__="",qs(H));const P=Object.values(l);for(const y of P)if(y.fileName.endsWith(".js")&&!w.includes(y.fileName)&&w.push(y.fileName),y.type==="asset"&&y.fileName.endsWith(".css")){!x.includes(y.fileName)&&x.push(y.fileName);let _=gt(y.source);H&&(_=ee(_)),y.source=ct(_,""),e&&this.emitFile({type:"asset",fileName:y.fileName.replace(".css",".rtl.css"),name:y.name?y.name.replace(".css",".rtl.css"):void 0,source:f(_)})}for(const y of P){if(y.type==="asset"&&s(y.fileName)){let _=gt(y.source);_=await C(_),t.php&&(_=Xt(_)),_=await rt(_,t),t.php&&(_=Yt(_)),y.source=_;const{fileName:R,name:n}=Gs(y.fileName,y.name,t);if(y.fileName=R,y.name=n,e&&i==="new-html"){let g=(await L.default([]).use(I=>(I.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir="rtl",c)),I.match(k.default("link[href]"),c=>(c.attrs&&c.attrs.href&&c.attrs.href.endsWith(".css")&&(c.attrs.href=c.attrs.href.replace(".css",".rtl.css")),c)),I.match(k.default("style"),c=>{const p=[].concat(c.content||"").join("").trim();return p&&(c.content=[f(p)]),c}),E(I))).process(_,{})).html;g&&(g=await rt(g,t),this.emitFile({type:"asset",fileName:R.replace(/\.(html?|php)/g,".rtl.$1"),name:n?n.replace(/\.(html?|php)/g,".rtl.$1"):void 0,source:g}))}}if(y.type==="chunk"&&y.fileName.includes("-legacy")&&typeof t.removeCssInJs=="function"){const _=t.removeCssInJs(gt(y.code));y.code=_||y.code}}await Ns()}}}function Gs(t,e,s){const{buildPagesDirectory:r,pagesDirectory:a,php:i}=s;if(r!==a){const u=t.indexOf(a);u>=0&&(t=r+t.slice(u+a.length))}return i&&i.rename&&(t=t.replace(/\.(html?)/g,".php"),e&&(e=e.replace(/\.(html?)/g,".php"))),{fileName:t,name:e}}function gt(t){return t instanceof Uint8Array?Buffer.from(t).toString("utf-8"):t}function ce(t,e,s){for(;t.includes(e);)t=t.replace(e,s);return t}function le(...t){return[].concat(...t).filter(Boolean).join("").trim()}function Ls(t){const e=_t.merge({includes:[],ignore:[],pagesDirectory:"pages",mocksDirectory:"mocks",buildPagesDirectory:"pages",cacheDirectory:".posthtml-view-cache",usePlugins:null,rtl:!1,minifyHtml:!0,devMinifyHtml:!1,minifyClassnames:!1,preloadCss:!0},t||{});e.pagesDirectory=e.pagesDirectory||"pages",e.buildPagesDirectory=e.buildPagesDirectory||e.pagesDirectory,e.cacheDirectory=e.cacheDirectory||".posthtml-view-cache",e.getOptions=m=>{e.styled=m.styled,e.assets=m.assets};const s=new Map,r=new Map,a="virtual:posthtml-view",i=Vs(e),u=()=>{const m="view:posthtml-view-pages";let h;return{name:m,enforce:"pre",config(d,{mode:x}){Es(d,e)},configResolved(d){h=d,e.root=h.root,e.assets=e.assets||{},e.assets._include=h.assetsInclude,e.mode=h.command==="build"?"production":"development"},transformIndexHtml:{enforce:"pre",async transform(d,x){return h.command==="serve"?i&&typeof i.devPreview=="function"&&i.devPreview(x.originalUrl)?e.rtl=i:e.rtl=!1:e.rtl=i,await Hs(h,e,a,s,r)(d,x)}},async resolveId(d,x){return d===a||/\?__posthtml_view__=(0|1)/g.test(d)||d.startsWith(a)?d:null},async load(d){if(d===a)return"";if(/\?__posthtml_view__=(0|1)/g.test(d)){const x=ut(d),w=d.includes("__posthtml_view__=1");let E="";return w||(E=E+`import '${x.replace(/\.(t|j)s/g,"")}';`),E=E+(s.get(x)||""),E}return d.startsWith(a)?r.get(d)||"":null},async transform(d,x){return h.command==="build"&&i&&Gt(x)?It(d):null}}};return[(()=>({name:"view:posthtml-view-dev",enforce:"pre",apply:"serve",configureServer(m){m.middlewares.use(ke.default({verbose:Boolean({}.DEBUG)&&{}.DEBUG!=="false",disableDotRule:void 0,htmlAcceptHeaders:["text/html","application/xhtml+xml"],rewrites:Ps(e)}))},async transform(m,h){return i&&e.rtl&&Gt(h)?nt(m,{transformDirInUrl:i.transformDirInUrl||!1,transformEdgeInUrl:i.transformEdgeInUrl||!1}):null},async handleHotUpdate({file:m,server:h}){return(m.includes("/"+e.mocksDirectory)||m.includes(".html"))&&h.ws.send({type:"full-reload",path:"*"}),[]}}))(),u(),Us(e,i)]}A.compilerViewPlugin=Wt,A.generateName=at,A.slugify=$t,A.toValidCSSIdentifier=Z,A.vitePluginPosthtmlView=Ls,Object.defineProperty(A,"__esModule",{value:!0}),A[Symbol.toStringTag]="Module"});

(function(R,B){typeof exports=="object"&&typeof module!="undefined"?B(exports,require("crypto"),require("path"),require("posthtml"),require("posthtml-expressions"),require("posthtml-match-helper"),require("posthtml-render"),require("lodash"),require("fs-extra"),require("postcss"),require("postcss-load-config"),require("postcss-safe-parser"),require("postcss-selector-parser"),require("connect-history-api-fallback"),require("fast-glob"),require("circular"),require("execa"),require("html-minifier-terser"),require("@rollup/pluginutils"),require("node-localstorage")):typeof define=="function"&&define.amd?define(["exports","crypto","path","posthtml","posthtml-expressions","posthtml-match-helper","posthtml-render","lodash","fs-extra","postcss","postcss-load-config","postcss-safe-parser","postcss-selector-parser","connect-history-api-fallback","fast-glob","circular","execa","html-minifier-terser","@rollup/pluginutils","node-localstorage"],B):(R=typeof globalThis!="undefined"?globalThis:R||self,B(R.posthtmlView={},R.crypto,R.path,R.posthtml,R.expressions,R.match,R.posthtmlRender,R.lodash,R.fse,R.postcss,R.postcssrc,R.postcssSafeParser,R.postcssSelectorParser,R.history,R.fg,R.circular,R.execa,R.htmlMinifierTerser,R.pluginutils,R.nodeLocalstorage))})(this,function(R,B,ie,oe,ue,fe,pe,vt,he,me,de,ge,ye,_e,ve,we,be,$e,xe,je){"use strict";function q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var N=q(ie),L=q(oe),Ce=q(ue),k=q(fe),Z=q(he),Ee=q(me),Pe=q(de),wt=q(ge),bt=q(ye),Ie=q(_e),ke=q(ve),Se=q(we),Ae=q(be);function Re(t,e=0){const s=1540483477,r=24;let a=t.length,i=e^a,u=0;for(;a>=4;){let f=De(t,u);f=F(f,s),f^=f>>>r,f=F(f,s),i=F(i,s),i^=f,u+=4,a-=4}switch(a){case 3:i^=$t(t,u),i^=t.charCodeAt(u+2)<<16,i=F(i,s);break;case 2:i^=$t(t,u),i=F(i,s);break;case 1:i^=t.charCodeAt(u),i=F(i,s);break}return i^=i>>>13,i=F(i,s),i^=i>>>15,i>>>0}function De(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function $t(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function F(t,e){t|=0,e|=0;const s=t&65535,r=t>>>16;return s*e+((r*e&65535)<<16)|0}function xt(t){return Re(t).toString(36)}const He=/[^-_a-z0-9\u00A0-\uFFFF]/gi,Te=/^\d/;function X(t,e){return t&&t.replace(He,e||"_").replace(Te,e||"_")}const Ne=/^(https?:)?\/\//,jt=t=>Ne.test(t),qe=/^\s*data:/i,Ct=t=>qe.test(t),Me=/({|%|:|})/g;function Et(t){return t.replace(Me,"\\$1")}function*at(t=[],e=!0,s){s=s||(g=>!0);let r="abcdefghijklmnopqrstuvwxyz";e&&(r=r+r.toUpperCase());const i=r+"0123456789",u=r.length,f=i.length;t=[...t||[],/ad/i];let d=0,h=0;for(;;){let g=u,x="";do x=x+i.charAt(h%g),h=~~(h/g),g=f;while(h>0);!t.some(w=>w.test(x))&&s(x)&&(yield x),d++,h=d}}function Oe(t,e,s,r){return N.default.join(N.default.isAbsolute(r)?t:N.default.dirname(s||e),r)}function Fe(t,e,s){return e=Ve(N.default.normalize(N.default.relative(t,e))),s?e[0]==="/"?e:`/${e}`:e}function Ve(t){const e=/^\\\\\?\\/.test(t),s=/[^\u0000-\u0080]+/.test(t);return e||s?t:t.replace(/\\/g,"/")}const Be=require("cssjanus"),Pt=new Map,It=/\/\*(.*?)\*\//gs,We=/--noflip-rtl-placeholder-\d+:\s*1;?/g,Ue=/{(.*?)}/gs;function nt(t,e){const s=Pt.get(t);if(s)return s;let r=ct(t);return r=Be.transform(r,{transformDirInUrl:!1,transformEdgeInUrl:!1,...e}),r=r.replace(It,""),Pt.set(t,r),r}function kt(t){return t.replace(Ue,e=>{let s=-1;return e.replace(It,r=>r.includes("@noflip")?(s=s+1,`--noflip-rtl-placeholder-${s}:1;`):r)})}function ct(t,e){return t.replace(We,e===""?e:"/* @noflip */")}const St=/^(?:x-|v-|:|@)/,Ge=/\B([A-Z])/g;function Le(t){return(t||"").replace(Ge,"-$1").toLowerCase()}function Je(t){let e=t.replace(".html","-html").replace(/\.|_/g,"").split("/").map(s=>Le(s)).filter(Boolean);return X(e.join("-"),"-")}const K=/\\?{\\?%(\\?:|\\?#)(.*?)\\?%\\?}/gs;function tt(t){const e=!!(t&&K.test(t));return K.lastIndex=0,e}function At(t){return tt(t)}const ze=/\.(ttf|eot|woff|woff2)$/;function Qe(t){return t=t.split("#")[0],t=t.split("?")[0],ze.test(t)}const Ye=/\/\*(.*?)\*\//gs;function Ze(t){return t=t&&t.replace(Ye,e=>tt(e)?"":e),tt(t)}function Xe(t){return t&&t.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function Rt(t,e=!0){return t=t.replace(/ ?[\n\r]+ ?/g,"").replace(/\s{2,}/g,e?" ":""),Xe(t).replace(/\s*;\s*/g,";")}const Ke=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],ts=["a","animate","animateMotion","animateTransform","circle","clipPath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"];function es(t,e,s){return function(r){const a=t.content||[],i={};a.length&&r.match.call(a,k.default("template"),f=>(!f.attrs||!f.attrs.slot||(i[f.attrs.slot]=f),f));const u=r.match(k.default("slot"),f=>{const d=f.attrs&&f.attrs.name||"";if(!d)return Dt(f.content,a.filter(g=>!(g.tag==="template"&&g.attrs&&g.attrs.slot)));const h=i[d];return h?Dt(f.content,h.content,ss(h)):f.content||[]});return t.tag=!1,t.content=u,r}}function Dt(t,e,s){switch(t=Array.isArray(t)?t:[t||""],e=Array.isArray(e)?e:[e||""],s){case"replace":t=e;break;case"prepend":t=[...e,...t];break;case"append":t=[...t,...e];break;default:t=e.filter(Boolean).length===0?t:e;break}return t}function ss(t){let e=t.attrs&&t.attrs.type||"";return["replace","prepend","append"].includes(e)||(e="replace"),e}function Ht(t,e,s,r){return L.default((r||[]).concat(e)).process(pe.render(s),t).then(a=>a.tree)}function rs(t,e,s,r){const a={};Object.entries(e||{}).forEach(([f,d])=>{a[f]=as(d)});const i={MODE:s.mode,DEV:s.mode==="development",PROD:s.mode==="production",PAGE:s.slash(s.from,!0)},u={[s.$attrs]:vt.merge({},s.locals,t.locals,a,{env:i})};return Ce.default({locals:u})}function as(t){try{return new Function(`return ${t}`)()}catch{return t}}let lt;async function ns({registerComponentsFile:t,root:e,mode:s,encoding:r,prefix:a,join:i,slash:u}){if(lt)return lt;if(!t)return{};const f={},d=i(e,t),h=await Z.default.readFile(d,r);function g(x){x.match(k.default(a("components")),w=>(w.content&&w.content.forEach(E=>{if(typeof E=="string")return;let{src:j,...C}=E.attrs||{};E.tag&&j&&(j=i(d,j),f[E.tag]={tag:E.tag,src:j,resolveId:u(j),locals:C})}),w))}return await L.default([]).use(g).process(h,{}),s!=="development"&&(lt=f),f}const cs=/^(-\w+-)?animation-name$/,ls=/^(-\w+-)?animation$/,is=/-?keyframes$/,Tt=/(?<=^|[^\w\-\u0080-\uffff])url\(\s*('[^']+'|"[^"]+"|[^'")]+)\s*\)/,Nt=/image-set\(([^)]+)\)/;function it(t,e,s,r,a,i,u){const f=wt.default(t,{from:r}),d={classNames:[],tags:{},assetsCache:new Set},h=Object.create(null);let g=!1,x="";if(!u){let w=function(l){l.forEach(o=>{if(o.type==="atrule"&&(o.name==="media"||o.name==="supports"))w(o.nodes);else switch(o.type){case"rule":if([a,i].includes(o.selector+"{}"))return;ms(o.nodes),o.selector=Ft(hs(o.selector,x,d));break;case"atrule":if(is.test(o.name))if(o.params.startsWith(":global"))o.params=Ft(o.params);else{const y=`_${C}`;o.params.endsWith(y)||(g=!0,h[o.params]=o.params=o.params+y)}break}})};const E=l=>l.replace(a,"").replace(i,""),j=s.mode==="production",C=xt(`scoped-${e}:`+(j?E(t||""):""));x=X((s.styled.prefix||"")+C),w(f.nodes)}return f.walkDecls(w=>{g&&(cs.test(w.prop)&&(w.value=w.value.split(",").map(C=>h[C.trim()]||C.trim()).join(",")),ls.test(w.prop)&&(w.value=w.value.split(",").map(C=>{const l=C.trim().split(/\s+/),o=l.findIndex(P=>h[P]);return o!==-1?(l.splice(o,1,h[l[o]]),l.join(" ")):C}).join(",")));const E=Tt.test(w.value),j=Nt.test(w.value);if(E||j){const C=o=>(o=s.join(r,o),o=s.slash(o,!0),d.assetsCache.add(o),o),l=E?os:us;w.value=l(w.value,C)}}),{scopedHash:x,scopedClasses:d,css:f.toString()}}function os(t,e){return qt(t,Tt,s=>{const[r,a]=s;return Mt(a,r,e)})}function us(t,e){return qt(t,Nt,s=>{const[r,a]=s;return`image-set(${ps(a,({url:u})=>Mt(u,r,e))})`})}function qt(t,e,s){let r,a=t,i="";for(;r=e.exec(a);)i+=a.slice(0,r.index),i+=s(r),a=a.slice(r.index+r[0].length);return i+=a,i}function Mt(t,e,s){let r="";const a=t[0];return(a==='"'||a==="'")&&(r=a,t=t.slice(1,-1)),jt(t)||Ct(t)||t.startsWith("#")?e:`url(${r}${s(t)}${r})`}const fs=/( |\\t|\\n|\\f|\\r)+/g;function ps(t,e){const r=t.split(",").map(a=>{const[i,u]=a.replace(fs," ").trim().split(" ",2);return{url:i,descriptor:u}}).filter(({url:a})=>!!a).map(({url:a,descriptor:i})=>({url:e({url:a,descriptor:i}),descriptor:i}));return r.reduce((a,{url:i,descriptor:u},f)=>(u=u||"",a+=i+` ${u}${f===r.length-1?"":", "}`),"")}function hs(t,e,s){return bt.default(r=>{r.walk(a=>{if((a.type==="class"||a.type==="tag")&&!(Ot(a.parent)||Ot(a.parent&&a.parent.parent))){let u=a.value;a.type==="class"&&(At(u)&&(u=Et(u)),s.classNames.includes(u)||s.classNames.push(u)),a.type==="tag"&&(s.tags[u]=!0),a.setPropertyWithoutEscape("value",`${u}.${e}`)}})}).processSync(t)}function ms(t){t.forEach(e=>{e.type==="decl"&&["undefined","null"].includes(e.value)&&(e.remove(),e.cleanRaws())})}function Ot(t){return!!(t&&t.type==="pseudo"&&t.value===":global")}const ds=/:global\((.*?)\)/gs;function Ft(t){return t.replace(ds,"$1")}let V,J;const Vt=()=>{try{V=V||Pe.default.sync()}catch{V={file:"",options:{},plugins:[]}}J=J||Ee.default(V.plugins)};function gs(t){function e(s,r){return async function(a){const i=[],u=$s(a,s);if(a.walk(f=>{if(typeof f=="string"||!f.tag)return f;const d=f.attrs||{},h=bs(d,f.tag,u,s);if(h){if(Ke.includes(h.tag))throw new Error(`The component <${h.tag}> is the HTML tag. page file: ${s.from}`);if(ts.includes(h.tag))throw new Error(`The component <${h.tag}> is the SVG tag. page file: ${s.from}`);f.attrs&&delete f.attrs[s.prefix("query")],i.push(ws(h,s.encoding).then(_s(f,h,s)).then(g=>{const x={...s,from:h.src};return e(x,!1)(g)}).then(es(f)))}return f}),r){const f=s.slash(s.from);i.push(Bt(null,{tag:f.replace(/\/|\./g,"-"),src:s.from,resolveId:f,locals:{}},s)(a))}return i.length>0&&(await Promise.all(i),i.length=0),r?await ys(a,s):a}}return e(t,!0)}async function ys(t,e){const{styled:s,js:r,from:a,mode:i,rtl:u}=e,f=i==="development",d="@",h="__posthtml_view_css__";let g="";const x=[];f&&(t.match(k.default("body"),c=>{const p={tag:"div",attrs:{id:h,"data-id":"development_css_container",style:"display: none !important;"}};return c.content=[p,...c.content||[]],c}),t.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir=u?"rtl":"ltr",c)));const w=new Map,E=[],j=new Map,C=[],l=typeof s.extract=="function",o=r.type==="ts"?"ts":"js";t.match(k.default("style"),function(c){const p=et(c.content);c.attrs=c.attrs||{};const b=c.attrs["data-scoped-hash"]||"",S=c.attrs["data-resolve-id"]||"";let $=c.attrs["data-to"]||s.to||"head";if(f&&$!=="*"&&($=`#${h}`),(c.attrs["data-to"]==="file"||$==="file")&&l)p&&!j.has(S)&&(j.set(S,{}),!C.includes(S)&&C.push(S),j.set(S,{to:"file",css:p,scopedHash:b,resolveId:S}));else if(p&&!w.has(S)){if(w.set(S,{}),$==="*")return f||(delete c.attrs["data-to"],delete c.attrs["data-scoped-hash"],delete c.attrs["data-resolve-id"]),c;!E.includes(S)&&E.push(S),w.set(S,{to:$,css:p,scopedHash:b,resolveId:S})}return c.tag=!1,delete c.content,c}),t.match(k.default('script[type="module"]'),c=>{if(!g&&c.attrs&&c.attrs.src){if(/^(https?:)?\/\//.test(c.attrs.src))return c;c.attrs.src=c.attrs.src+"?__posthtml_view__=0",g=c.attrs.src}return c});function P(){return g||(g=e.slash(a,!0).replace(".html","."+o)+"?__posthtml_view__=1",Array.isArray(t)&&t.push({tag:"script",attrs:{type:"module",src:g}}),g)}const y=new Map,_=c=>{r&&typeof r.extract=="function"&&r.extract(c)};t.match(k.default("script[data-resolve-id]"),c=>{c.attrs=c.attrs||{};const p=c.attrs["data-resolve-id"]||"";if(p&&!y.has(p)){y.set(p,null);const b=c.attrs.src||"",S=c.attrs["data-scoped-hash"]||"",$=(b?"":et(c.content))||"";let v=b&&N.default.extname(b).replace(".","")||o;v=v==="ts"?"ts":"js",_({type:v,from:a,resolveId:p,scopedHash:S,source:$,mainjs:P(),src:b.replace(`.${v}`,"")})}return c.tag=!1,delete c.content,c});const A=new Set;Vt(),C.forEach(c=>{const p=j.get(c);if(!!p&&!!p.css){if(f){p.to=`#${h}`,A.add(p.to),t.match(k.default(p.to),b=>{A.delete(p.to);const S={tag:"style",attrs:{"data-to":"file","data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};return b.content?b.content=[S,...b.content]:b.content=[S],b});return}l&&x.push(J.process(p.css,{...V.options,from:a||void 0}).then(b=>{s.extract&&s.extract({type:"css",from:a,mainjs:P(),resolveId:p.resolveId,scopedHash:p.scopedHash,source:b.css})}))}}),E.forEach(c=>{const p=w.get(c);!p||!p.css||(A.add(p.to),t.match(k.default(p.to),b=>{switch(A.delete(p.to),b.tag){case"head":const S=b.content&&b.content.find(v=>!v||typeof v=="string"?!1:v.tag==="style"&&v.attrs&&v.attrs[h]===d);if(S)S.content=st(S.content,p.css);else{const v={tag:"style",attrs:{[h]:d},content:p.css};b.content?b.content=st(b.content,v):b.content=[v]}break;case"style":b.content=st(b.content,p.css);break;default:const $={tag:"style",attrs:{"data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};b.content?b.content=st(b.content,$):b.content=[$];break}return b}))});const n=typeof e.trimAttr=="function"?e.trimAttr:null,m=typeof e.cumbersomeTrim=="function"?e.cumbersomeTrim:null,I=(c,p)=>{if(typeof p=="string"&&p.trim()){if(n)return n(c,p,Rt);if(c==="application/ld+json"||St.test(c))if(p=Rt(p).trim(),p=p.replace(/^{\s+/g,"{").replace(/\s+}$/g,"}"),m)p=m(c,p);else{const b="[<?=@#$%!*&^@?>]";let S=[],$="";p.replace(/('|")(.*?)('|")/g,(v,D,M,_t)=>(S.push(`${D}${M}${_t}`),b)).replace(/\s+(&&|\|\||===?|!==?|<=|>=|\+=|-=)\s+/g,"$1").replace(/\s*\?\s*(.*?)\s*:\s*/g,"?$1:").replace(/(?<=[():\[\],\{\}"!'=])\s+/g,"").replace(/\s+(?=[():\[\],\{\}"!'=])/g,"").split(b).forEach((v,D)=>{$=$+v+(S[D]||"")}),p=$}return p}return null};return t.walk(c=>{if(c.tag&&c.attrs){if(Object.entries(c.attrs).forEach(([p,b])=>{if(["null","undefined"].includes(b)){delete c.attrs[p];return}const S=I(p,b||"");S&&(c.attrs[p]=S)}),c.tag==="script"&&c.attrs.type==="application/ld+json"&&c.content){const p=I(c.attrs.type,[].concat(c.content).join(""));p&&(c.content=[p])}c.attrs.class=(c.attrs.class||"").trim(),c.attrs.class||delete c.attrs.class}return c.tag&&(c.attrs=c.attrs||{},c.tag==="img"&&(c.attrs.alt=c.attrs.alt||""),c.tag==="button"&&(c.attrs.type=c.attrs.type||"button")),c}),t.match(k.default("style"),c=>{const p=et(c.content);return p&&x.push(J.process(p,{...V.options,from:a||void 0}).then(b=>{c.content=[b.css]})),c}),A.forEach(c=>{throw Error("Invalid selector: "+c)}),await Promise.all(x).then(()=>(f||t.match(k.default("head"),c=>{const p={tag:"meta",attrs:{property:"posthtml:view-head-placeholder",content:"*"}};return c.content?c.content.push(p):c.content=[p],c}),t))}function _s(t,e,s,r){return function(a){return typeof s.htmlProcessor=="function"&&(a=s.htmlProcessor(a)),Ht(s.parser,s.plugins,a,[Bt(t,e,s),rs(e,t.attrs,s)])}}function Bt(t,e,s){Vt();const{stylePreprocessor:r,styled:a,addClassIncludes:i,assets:u,noflip:f,cssjanus:d}=s,h=g=>Promise.resolve(r(g));return async function(g){const x=[];let w=!1,E="",j=null;if(g.match(k.default("style"),l=>{const o=l.attrs||{},P=vs(a,o),y=et(l.content);let _=o.src;const A=o.dynamic!=null||Ze(y);return(_||y)&&x.push(Promise.resolve(null).then(()=>_?(_=s.join(e.src,_),Z.default.readFile(_,s.encoding)):Promise.resolve(y)).then(n=>n?(n=f(n),h(n)):{code:""}).then(n=>{const m=n&&n.code;return{...n,code:d(m||""),to:A&&P.to==="file"?"head":P.to,type:P.type}})),w&&(l.tag=!1,delete l.content),w=!0,l}),x.length>0){const l=await Promise.all(x);x.length=0;const o=l[0].type;let P="",y="",_=a.to;const A=":__posthtml_view_to_file_start_mark__{}",n=":__posthtml_view_to_file_end_mark__{}";l.forEach($=>{$.to==="file"&&$.code&&($.code=`${A}${$.code}${n}`),$.type==="scoped"&&(P=P+($.code||"")),$.type==="global"&&(y=y+($.code||"")),$.to!=="file"&&$.to!==a.to&&(_=$.to)});const m=it(P,e.resolveId,s,e.src,A,n,!1),I=it(y,e.resolveId,s,e.src,A,n,!0);P=m.css,E=m.scopedHash,j=m.scopedClasses,y=I.css,I.scopedClasses.assetsCache.forEach($=>{j&&j.assetsCache.add($)}),I.scopedClasses.assetsCache.clear(),l.length=0;const c=$=>{let v="";return $=$.replace(/:__posthtml_view_to_file_start_mark__{}(.*?):__posthtml_view_to_file_end_mark__{}/gs,function(D,M){return v=v+M,""}),{css:$,fileCss:v}},p=c(P),b=c(y);P=p.css,y=b.css;let S="";o==="global"?S=b.fileCss+p.fileCss:S=p.fileCss+b.fileCss,g.match(k.default("style"),$=>(o==="global"?$.content=[y+P]:$.content=[P+y],P="",y="",$.attrs=$.attrs||{},$.attrs["data-to"]=_,$.attrs["data-scoped-hash"]=E,$.attrs["data-resolve-id"]=e.resolveId,delete $.attrs.scoped,delete $.attrs.global,delete $.attrs.src,delete $.attrs.to,delete $.attrs.dynamic,$)),S&&Array.isArray(g)&&g.push({tag:"style",attrs:{"data-to":"file","data-scoped-hash":E,"data-resolve-id":e.resolveId},content:S})}const C=s.prefix("js");if(g.match(k.default("script"),l=>{l.attrs=l.attrs||{};let o=l.attrs.src;return o&&/^(https?:)?\/\//.test(o)?l:l.attrs[C]==="null"||l.attrs[C]==="false"?(delete l.attrs[C],l):o&&l.attrs.type&&l.attrs.type==="module"?(l.attrs.src=s.join(e.src,o),l.attrs.src=s.slash(l.attrs.src,!0),l):(l.attrs.type&&l.attrs[C]==null||(o&&(o=s.join(e.src,o),l.attrs.src=s.slash(o,!0)),l.attrs["data-to"]=l.attrs.to,l.attrs["data-scoped-hash"]=E,l.attrs["data-resolve-id"]=e.resolveId,delete l.attrs.to),l)}),g.walk(l=>{if(typeof l=="string")return l;l.attrs=l.attrs||{};const o=j;if(o&&E&&l.tag){const _=l.attrs,A=_.class||"",n=m=>{i&&i.length&&(m={},i.forEach(I=>{m[I]=_[I]}));for(const I in m)if(Object.prototype.hasOwnProperty.call(m,I)){const c=m[I]||"";if(o.classNames.some(p=>c.includes(p)))return!0}return!1};(o.tags[l.tag]||n(_))&&!A.includes(E)&&(l.attrs.class=`${E} ${A}`.trim())}l.attrs.style&&x.push(J.process(l.attrs.style,{...V.options,from:e.src||void 0}).then(_=>{const A=".__posthtml_view_inline_css_123456_abcdef__{",n=it(`${A}${_.css}}`,e.resolveId,s,e.src,"","",!0);n.scopedClasses.assetsCache.forEach(I=>{j&&j.assetsCache.add(I)}),n.scopedClasses.assetsCache.clear();const m=n.css.replace(A,"").replace("}","");l.attrs&&(l.attrs.style=d(m))})),Object.keys(l.attrs).forEach(_=>{!u.attributes.includes(_)&&u.attrRegExp.test(_)&&u.attributes.push(_)});const P=typeof u._include=="function"&&u._include,y=_=>{if(!String(_).trim()||P&&!P(_)||jt(_)||Ct(_)||_.startsWith("#")||tt(_))return _;let A=s.join(e.src,_);return A=s.slash(A,!0),j&&j.assetsCache.add(A),A};return u.attributes.forEach(_=>{if(l.attrs[_]){const A=l.attrs[_];let n;const m=A.replace(/('|")(.*?)('|")/g,(I,c,p,b)=>(n=!0,`${c}${y(p)}${b}`));l.attrs[_]=n?m:y(A)}}),l}),x.length>0&&(await Promise.all(x),x.length=0),s.mode!=="development"&&j&&j.assetsCache.size){const l={tag:"div",attrs:{__posthtml_view_assets_div__:!0,style:"display:none;"},content:[]};j.assetsCache.forEach(o=>{Qe(o)?l.content.push({tag:"link",attrs:{rel:"preload",as:"font",href:o,"data-raw-url":o}}):l.content.push({tag:"img",attrs:{src:o,"data-raw-url":o}})}),l.content.length&&Array.isArray(g)&&g.push(l),j.assetsCache.clear()}return g}}function vs(t,e){t={...t},t.to=e.to||t.to||"head";let s=t.type;return e.scoped!=null?s="scoped":e.global!=null&&(s="global"),t.type=s||"scoped",t}function ws(t,e){return t.source!=null?Promise.resolve(t.source||""):Z.default.readFile(t.src,e)}function bs(t,e,s,r){const a=r.prefix("query");return(t[a]||"")==="global"?r.components[e]:s[e]||r.components[e]}function $s(t,{from:e,prefix:s,join:r,slash:a}){const i={};return t.match(k.default(s("components")),u=>(u.content&&u.content.forEach(f=>{if(typeof f=="string")return;let{src:d,...h}=f.attrs||{};f.tag&&d&&(d=r(e,d),i[f.tag]={tag:f.tag,src:d,resolveId:a(d),locals:h})}),u.tag=!1,delete u.content,u)),t.match(k.default(s("component")),u=>{const f=u.attrs||{};let d=!1;if(f.src){const h="view-src-"+Je(f.src),g=r(e,f.src);i[h]={tag:h,src:g,resolveId:a(g),locals:{}},u.tag=h,delete f.src}else d=!0;return d&&(u.tag=!1,delete u.content),u}),i}function et(t){return[].concat(t||"").join("").trim()}function st(...t){return[].concat(...t).filter(Boolean)}function Wt(t){const e={...t||{}};return e.root=e.root||process.cwd(),e.mode=e.mode||"development",e.encoding=e.encoding||"utf8",e.viewPrefix=e.viewPrefix||"view:",e.from=e.from||"",e.plugins=e.plugins||[],e.parser=e.parser||{},e.locals=e.locals||{},e.$attrs=e.$attrs||"$attrs",e.stylePreprocessor=e.stylePreprocessor||(s=>({code:s})),e.js={type:"ts",...e.js},e.assets={...e.assets},e.assets.attributes=e.assets.attributes||["data-src","data-img"],e.assets.attrRegExp=e.assets.attrRegExp||St,e.styled={type:"scoped",to:"head",prefix:"view-",...e.styled},typeof e.getOptions=="function"&&e.getOptions(e),e.join=(s,r)=>Oe(e.root,e.from,s,r),e.slash=(s,r)=>Fe(e.root,s,r),e.prefix=s=>`${e.viewPrefix}${s}`,e.rtl=e.rtl||!1,e.cssjanus=s=>e.rtl&&e.mode==="development"?nt(s,{transformEdgeInUrl:e.rtl.transformEdgeInUrl,transformDirInUrl:e.rtl.transformDirInUrl}):s,e.noflip=s=>e.rtl?kt(s):s,async function(r){e.components=await ns(e);const a=await gs(e)(r);return await Ht(e.parser,e.plugins,a)}}const Ut=/\.(css|scss|less|sass|styl|stylus|pcss|postcss)$/;function Gt(t){const e=Ut.test(t);return Ut.lastIndex=0,e}function xs(t,e){t.build=t.build||{},t.build.rollupOptions=t.build.rollupOptions||{},t.build.ssr=!1;const{input:s,pages:r}=Cs(t.root||process.cwd(),e);return t.build.rollupOptions.input=s,t.server=t.server||{},t.server.open===!0&&(t.server.open=r[0]&&`/${r[0].route||""}`||"/"),t}function js(t){const e=[];return Lt(t).forEach(r=>{const a=`./${r.path}`;r.pageName==="index"&&e.push({from:/^\/$/,to:a}),e.push({from:new RegExp(`^/${r.route}/*`),to:a}),e.push({from:new RegExp(`^/${r.route}$`),to:a})}),e}function Cs(t,e){const s=Lt(e),r={};return s.forEach(a=>{r[a.pageName]=N.default.resolve(t,a.path)}),{input:r,pages:s}}function Lt({pagesDirectory:t,includes:e,ignore:s}){return e=e.filter(Boolean).map(r=>r[0]==="/"?r:"/"+r),ke.default.sync(`${t}/**/*.html`.replace("//","/"),{objectMode:!0,ignore:s.map(r=>(r.includes(".")?r:`**/${r}/**`).replace("//","/"))}).filter(r=>e.some(a=>r.path.includes(a))?!0:!r.path.includes("/_")).map(({name:r,path:a})=>{const i={filename:r,path:a,route:"",pageName:""};return i.route=a.replace(`${t}/`,""),i.pageName=i.route.replace(/(\/index)?\.html/,"").replace("/","-"),i})}const Jt="0123456789abcdef",zt={"=":"\\:",php:"\\#","\\:":"=","\\#":"php"},Qt=/\\{\\%(\\:|\\#)(.*?)\\%\\}/gs,Es=/<\?(=|php)(.*?)\?>/gs,Ps=/(\\%\\})=""/g;function Yt(t){return t.replace(Qt,function(e,s,r){return`<?${zt[s]||s}${r}?>`})}function Zt(t){return t.replace(Es,function(e,s,r){return`\\{\\%${zt[s]||s}${Is(r,Jt)}\\%\\}`})}function Xt(t){return t.replace(Ps,"$1").replace(Qt,function(e,s,r){return`\\{\\%${s}${ks(r,Jt)}\\%\\}`})}function Is(t,e){const s=B.createCipheriv("aes128",e,e);let r=s.update(t,"utf8","hex");return r+=s.final("hex"),r}function ks(t,e){const s=B.createDecipheriv("aes128",e,e);let r=s.update(t,"hex","utf8");return r+=s.final("utf8"),r}async function Ss(t,e,s=!0){let r=null;if(t)try{let a=null;(u=>{s&&require&&require.cache&&!!require.cache[u]&&delete require.cache[u]})(t),a=require(t),a&&(a=a.__esModule?a.default:a,typeof a=="function"?r=a(e):r=a)}catch(a){console.error(a)}return r||{}}const Kt=new Map;async function As(t,e,s,r){const a=N.default.join(s,".php-dev",r);return Kt.get(r)!==t&&(Kt.set(r,t),await Z.default.outputFile(N.default.resolve(e,a),t,"utf8")),{tplFileName:a,__views:""}}async function Rs(t,e,s){const{__views:r,...a}=s,i=a;i._TEMPLATE=t,i._REGISTER_GLOBAL_MODEL=!0,i._VIEWS_PATH=r;const u=JSON.stringify(i,Se.default()),{stdout:f}=await Ae.default("php",e&&e.length?e:[N.default.join(__dirname,"/loader.php")],{input:u});return f}const ot={caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!0,collapseWhitespace:!0,conservativeCollapse:!1,html5:!0,minifyCSS:!0,minifyJS:!0,minifyURLs:!0,noNewlinesBeforeTagClose:!0,removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!1,useShortDoctype:!0};let ut;async function rt(t,e){return typeof e.minifyHtml=="function"&&(e.minifyHtml=e.minifyHtml(ot)),e.minifyHtml&&(ut=ut||(e.minifyHtml===!0?ot:{...ot,...e.minifyHtml,removeTagWhitespace:!1}),t=await $e.minify(t,ut),typeof e.minifyHtmlAfter=="function"?t=e.minifyHtmlAfter(t):t=t.replace(/>(\s+)</g,"><")),t}function ft(t){return t.split("?__posthtml_view__=")[0]}const Ds=(t,e,s,r,a)=>{function i(d){const h=N.default.resolve(t.root,e.pagesDirectory);return N.default.relative(h,d)}const u=t.command==="serve",f='<div style="text-align:center;"><h1>posthtml-view</h1><p>No content</p></div>';return async(d,h)=>{const g=i(h.filename);e.php&&(d=Zt(d));const x=L.default([Wt({...e,from:h.filename,htmlProcessor(w){return Zt(w)},styled:{...e.styled,extract:w=>{const E=ft(w.mainjs),j=`${s}/${w.resolveId.replace(".html",".css")}`,C=`import '${j}';`;a.set(j,w.source||"");const l=r.get(E)||"";l.includes(j)||r.set(E,l+C)}},js:{...e.js,extract:w=>{const E=ft(w.mainjs);if(w.src){const j=r.get(E)||"",C=`import '${w.src}';`;j.includes(w.src)||r.set(E,j+C)}else{const j=`${s}/${w.resolveId.replace(".html","")}`,C=`import '${j}';`;a.set(j,w.source||"");const l=r.get(E)||"";l.includes(j)||r.set(E,l+C)}}}}),...e.plugins||[]]);if(typeof e.usePlugins=="function"&&e.usePlugins(x),d=(await x.process(d,{directives:[{name:"!DOCTYPE",start:"<",end:">"},{name:"?php",start:"<",end:">"},{name:"?=",start:"<",end:">"}],...e.parser,sync:!1})).html.trim(),u)if(e.php){if(d=Xt(d),e.devMinifyHtml&&(d=await rt(d,e)),d=Yt(d),typeof e.php.devRender=="function")d=await e.php.devRender({html:d,options:e});else{const w=N.default.join(t.root,e.mocksDirectory,g.replace(".html",".js")),[E,{tplFileName:j,__views:C}]=await Promise.all([Ss(w,h.originalUrl||"",!0),As(d,t.root,e.cacheDirectory,g)]);d=await Rs(j,e.php.args,{__views:C,...E})}return d||f}else e.devMinifyHtml&&(d=await rt(d,e));return d}};let O,pt,ht,W;const H={classesKey:"_classes",idsKey:"_ids",_classes:{},_ids:{},classes:{},ids:{}},z={},Q={};function te(t,e){try{const s=W.getItem(t)||{};return Object.keys(s).forEach(r=>{const a=s[r];e[a]=null}),s}catch{return{}}}async function Hs(){W&&(W.setItem(H.classesKey,H.classes),W.setItem(H.idsKey,H.ids))}function Ts(t){O=O||t,O.__cache_file__&&!W&&(W=new je.JSONStorage(O.__cache_file__),H._classes=te(H.classesKey,z),H._ids=te(H.idsKey,Q)),pt=pt||at(O.generateNameFilters,O.upperCase,e=>z[e]!==null),ht=ht||at(O.generateNameFilters,O.upperCase,e=>Q[e]!==null)}function ee(t){const e=wt.default(t);function s(r){r.forEach(a=>{if(a.type==="atrule"&&(a.name==="media"||a.name==="supports"))s(a.nodes);else switch(a.type){case"rule":a.selector=Ns(a.selector);break}})}return s(e.nodes),e.toString()}function Ns(t){return bt.default(e=>{e.walkClasses(s=>{if(U(s.value,!1,!1))return;let r=s.value,a=!1;const i=r.replace(K,u=>(a=!0,` ${u} `));if(a){r=i.split(/\s+/).map(u=>{if(!u)return"";if(U(u,!1))return u;const f=mt(u);return G(f)||u}).filter(Boolean).join("").trim(),r=Et(r),s.setPropertyWithoutEscape("value",r);return}s.setPropertyWithoutEscape("value",G(mt(r))||r)}),e.walkIds(s=>{U(s.value,!0)||(s.value=G(dt(s.value))||s.value)})}).processSync(t)}function mt(t){const e=H._classes[t];if(e)return z[e]=null,H.classes[t]=e,delete H._classes[t],e;const s=H.classes[t];if(s)return z[s]=null,s;const r=pt.next().value;return z[r]=null,H.classes[t]=r,r}function dt(t){const e=H._ids[t];if(e)return Q[e]=null,H.ids[t]=e,delete H._ids[t],e;const s=H.ids[t];if(s)return Q[s]=null,s;const r=ht.next().value;return Q[r]=null,H.ids[t]=r,r}function U(t,e,s){return s!==!1&&At(t)?!0:(t=(e?"#":".")+t,O.filters.some(r=>typeof r=="string"?r===t:r.test(t)))}function G(t){return t&&O.prefix+t}function qs(t){if(U(t,!0))return;const e=dt(t);if(e)return G(e)}function se(t){if(t=t.slice(1),U(t,!0))return;const e=H.ids[t];if(e)return"#"+G(e)}const Ms=/\\?%\\?}(.*?)\\?{\\?%/gs,Os=/\s+(\\?{\\?%)/g;function Y(t,e,s){return t&&(e||(t=t.replace(K,r=>` ${r} `)),t=t.split(/\s+/).map(r=>{if(!r)return"";if(U(r,e)||typeof s=="function"&&s(r))return r;const a=e?dt(r):mt(r);return G(a)||r}).filter(Boolean).join(" ").trim(),e||(t=t.replace(Ms,(r,a)=>a?r.replace(a,` ${a.trim()} `):r).replace(Os,"$1")),t)}const re="[[rtl]]",ae="[[ltr]]",gt={type:"syntax",syntax:`<?php if($rtl): ?>${re}<?php else: ?>${ae}<?php endif; ?>`,devPreview:t=>!!(t&&(t.includes("rtl=1")||t.includes("lang=ar")))},ne={enableCache:!0,generateNameFilters:[],upperCase:!0,filters:[/^(\.|#)js-/],attributes:[],blurryAttrs:[],prefix:"",__cache_file__:""};let T;function Fs(t){return typeof t.rtl=="boolean"?t.rtl?gt:!1:{...gt,...t.rtl}}const Vs=/(.*)\[\[(rtl|ltr)\]\](.*)\[\[(rtl|ltr)\]\](.*)/si;function Bs(t,e){const s=xe.createFilter(["**/*.html"]);let r,a=t.preloadCss!==!1;const{type:i,syntax:u}=e||gt,f=C=>nt(C,{transformDirInUrl:e&&e.transformDirInUrl||!1,transformEdgeInUrl:e&&e.transformEdgeInUrl||!1}),d=()=>u&&(u.includes(re)||u.includes(ae));let h=null;if(e&&i==="syntax"&&d()){const C=u.match(Vs);C&&C.length>=6&&(h=C.slice(1).map(l=>l.trim()).filter(Boolean))}const g=["crossorigin","nomodule","defer","async","hidden","x-transition","x-ignore","x-cloak","x-collapse",...t.boolAttrs||[]],x=[],w=[];function E(C){C.walk(l=>(l.attrs&&Object.keys(l.attrs).forEach(P=>{l.attrs[P]===""&&g.some(y=>y.indexOf(P)===0)&&(l.attrs[P]=!0)}),l))}const j=async C=>(await L.default([]).use(l=>(l.match(k.default("head"),o=>{const P=[];l.match.call(o,k.default('link[rel="preload"][as="style"][href]'),n=>(n.tag=!1,n)),l.match.call(o,k.default('link[rel="stylesheet"][href]'),n=>{const m=n.attrs||{};return n.tag&&m.href&&x.some(I=>m.href&&m.href.includes(I))&&(a&&P.push({tag:"link",attrs:{...m,rel:"preload",as:"style",href:m.href}}),P.push({tag:"link",attrs:m}),n.tag=!1),n}),l.match.call(o,k.default('script[type="module"][src],link[rel="modulepreload"][href]'),n=>{const m=n.attrs||{},I=m.href||m.src;return n.tag&&I&&w.some(c=>I.includes(c))&&(P.push({tag:n.tag,attrs:m}),n.tag=!1),n});const y=[];l.match.call(o,k.default('link[rel="preload"][as="image"][href]'),n=>{const m=n.attrs||{};return n.tag&&m.href&&(y.push({tag:"link",attrs:m}),n.tag=!1),n});const _=[];l.match.call(o,k.default("style[__posthtml_view_css__]"),n=>{const m=le(n.content);return n.tag&&m&&!_.includes(m)&&_.push(m),n.tag=!1,delete n.content,n});const A=_.map(n=>({tag:"style",content:n}));return l.match.call(o,k.default('meta[property="posthtml:view-head-placeholder"]'),n=>(n.content=[...P,...y,...A],n.tag=!1,n)),o}),T&&l.match(k.default("style"),o=>{if(o.attrs&&o.attrs["data-min-class-ignore"]!=null)return delete o.attrs["data-min-class-ignore"],o;const P=le(o.content);return P&&(o.content=[ee(P)]),o}),l)).use(l=>{const o=new Map,P=n=>(n&&o.size&&o.forEach((m,I)=>{n=ce(n,I,m)}),n);l.match(k.default("div[__posthtml_view_assets_div__]"),n=>(l.match.call(n,k.default("[data-raw-url]"),m=>(m.attrs&&m.attrs["data-raw-url"]&&o.set(m.attrs["data-raw-url"],m.attrs.href||m.attrs.src||""),m.tag=!1,m)),n.tag=!1,delete n.content,n));const y=t.assets.attributes,_=t.assets.attrRegExp;l.walk(n=>{if(typeof n=="string")return n;if(n.attrs){const m=Object.keys(n.attrs);m.forEach(c=>{!y.includes(c)&&_.test(c)&&y.push(c)}),y&&y.forEach(c=>{n.attrs[c]&&(n.attrs[c]=P(n.attrs[c]))}),n.attrs.style&&(n.attrs.style=P(n.attrs.style));const I=(n.attrs["view-build-class"]||"").split(" ").filter(Boolean);if(delete n.attrs["view-build-class"],T){const c=[...T.attributes,/^[xv]-transition/],p=[...T.blurryAttrs,/^([xv]-bind)?:class/],b=(v,D)=>v.some(M=>typeof M=="string"?M===D:M.test&&M.test(D)),S=v=>r.assetsInclude(v)?!0:I.length?!I.includes(v):!1;if(m.forEach(v=>{if(!(v==="id"||v==="class")&&typeof n.attrs[v]=="string"&&!(typeof n.attrs[v]=="string"&&!n.attrs[v].trim()))if(b(c,v))n.attrs[v]=Y(n.attrs[v],!1,S);else if(b(p,v)){const D=n.attrs[v]||"";let M;const _t=D.replace(/('|")(.*?)('|")/g,(zs,Gs,Ls,Js)=>(M=!0,`${Gs}${Y(Ls,!1,S)}${Js}`));n.attrs[v]=M?_t:D}else I.length&&I.forEach(D=>{if(n.attrs[v].includes(D)){const M=Y(D);n.attrs[v]=ce(n.attrs[v],D,M)}})}),n.attrs.class&&(n.attrs.class=Y(n.attrs.class)),n.attrs.id&&(n.attrs.id=Y(n.attrs.id,!0)),n.attrs.for){const v=qs(n.attrs.for);v&&(n.attrs.for=v)}if(["mask","fill","filter"].forEach(v=>{if(n.attrs[v]){const D=se(n.attrs[v].replace(/url\((.*?)\)/g,"$1"));D&&(n.attrs[v]=`url(${D})`)}}),n.tag==="use"&&(n.attrs.href||n.attrs["xlink:href"])){const v=n.attrs.href?"href":"xlink:href",D=se(n.attrs[v]||"");D&&(n.attrs[v]=D)}}}return n});const A="posthtml-view-syntax-style-x";return l.match(k.default("style"),n=>{let m=P([].concat(n.content||"").join("").trim()),I=m&&ct(m,"");if(I&&h&&h.length){const c=f(m);if(c!==I)return n.content=h.map(p=>p==="rtl"?{tag:A,attrs:n.attrs,content:c}:p==="ltr"?{tag:A,attrs:n.attrs,content:I}:p),n.tag=!1,n.attrs=void 0,n}return I&&(n.content=[I]),n}),h&&h.length?(l.match(k.default("link[href]"),n=>{const m=n.attrs&&n.attrs.href;if(n.attrs&&m&&m.endsWith(".css")&&h){const I=m.replace(".css",".rtl.css");n.attrs.href=h.map(c=>c==="rtl"?I:c==="ltr"?m:c).join("")}return n}),l.match(k.default("html"),n=>(h&&(n.attrs=n.attrs||{},n.attrs.dir=h.map(m=>m==="rtl"?"rtl":m==="ltr"?"ltr":m).join("")),n))):l.match(k.default("html"),n=>(n.attrs=n.attrs||{},n.attrs.dir="ltr",n)),Promise.resolve().then(()=>(l.match(k.default(A),n=>(n.tag="style",n)),l))}).use(l=>Promise.resolve().then(()=>{let o;return typeof t.generateUsePlugins=="function"&&(o=t.generateUsePlugins(l)),E(o||l)})).process(C,{})).html;return{name:"view:posthtml-view-bundle",enforce:"post",apply:"build",configResolved(C){r=C},async generateBundle(C,l){const o=t.minifyClassnames;o&&!T&&(T=o===!0?ne:{...ne,...o},T.prefix=T.prefix&&X(T.prefix),T.filters=[...T.filters,"#vite-legacy-polyfill","#vite-legacy-entry"],T.enableCache?T.__cache_file__=N.default.join(r.root,N.default.join(t.cacheDirectory,"css")):T.__cache_file__="",Ts(T));const P=Object.values(l);for(const y of P)if(y.fileName.endsWith(".js")&&!w.includes(y.fileName)&&w.push(y.fileName),y.type==="asset"&&y.fileName.endsWith(".css")){!x.includes(y.fileName)&&x.push(y.fileName);let _=yt(y.source);T&&(_=ee(_)),y.source=ct(_,""),e&&this.emitFile({type:"asset",fileName:y.fileName.replace(".css",".rtl.css"),name:y.name?y.name.replace(".css",".rtl.css"):void 0,source:f(_)})}for(const y of P){if(y.type==="asset"&&s(y.fileName)){let _=yt(y.source);_=await j(_),t.php&&(_=Xt(_)),_=await rt(_,t),t.php&&(_=Yt(_)),y.source=_;const{fileName:A,name:n}=Ws(y.fileName,y.name,t);if(y.fileName=A,y.name=n,e&&i==="new-html"){let m=(await L.default([]).use(I=>(I.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir="rtl",c)),I.match(k.default("link[href]"),c=>(c.attrs&&c.attrs.href&&c.attrs.href.endsWith(".css")&&(c.attrs.href=c.attrs.href.replace(".css",".rtl.css")),c)),I.match(k.default("style"),c=>{const p=[].concat(c.content||"").join("").trim();return p&&(c.content=[f(p)]),c}),E(I))).process(_,{})).html;m&&(m=await rt(m,t),this.emitFile({type:"asset",fileName:A.replace(/\.(html?|php)/g,".rtl.$1"),name:n?n.replace(/\.(html?|php)/g,".rtl.$1"):void 0,source:m}))}}if(y.type==="chunk"&&y.fileName.includes("-legacy")&&typeof t.removeCssInJs=="function"){const _=t.removeCssInJs(yt(y.code));y.code=_||y.code}}await Hs()}}}function Ws(t,e,s){const{buildPagesDirectory:r,pagesDirectory:a,php:i}=s;if(r!==a){const u=t.indexOf(a);u>=0&&(t=r+t.slice(u+a.length))}return i&&i.rename&&(t=t.replace(/\.(html?)/g,".php"),e&&(e=e.replace(/\.(html?)/g,".php"))),{fileName:t,name:e}}function yt(t){return t instanceof Uint8Array?Buffer.from(t).toString("utf-8"):t}function ce(t,e,s){for(;t.includes(e);)t=t.replace(e,s);return t}function le(...t){return[].concat(...t).filter(Boolean).join("").trim()}function Us(t){const e=vt.merge({includes:[],ignore:[],pagesDirectory:"pages",mocksDirectory:"mocks",buildPagesDirectory:"pages",cacheDirectory:".posthtml-view-cache",usePlugins:null,rtl:!1,minifyHtml:!0,devMinifyHtml:!1,minifyClassnames:!1,preloadCss:!0},t||{});e.pagesDirectory=e.pagesDirectory||"pages",e.buildPagesDirectory=e.buildPagesDirectory||e.pagesDirectory,e.cacheDirectory=e.cacheDirectory||".posthtml-view-cache",e.getOptions=d=>{e.styled=d.styled,e.assets=d.assets};const s=new Map,r=new Map,a="virtual:posthtml-view",i=Fs(e),u=()=>{const d="view:posthtml-view-pages";let h;return{name:d,enforce:"pre",config(g,{mode:x}){xs(g,e)},configResolved(g){h=g,e.root=h.root,e.assets=e.assets||{},e.assets._include=h.assetsInclude,e.mode=h.command==="build"?"production":"development"},transformIndexHtml:{enforce:"pre",async transform(g,x){return h.command==="serve"?i&&typeof i.devPreview=="function"&&i.devPreview(x.originalUrl)?e.rtl=i:e.rtl=!1:e.rtl=i,await Ds(h,e,a,s,r)(g,x)}},async resolveId(g,x){return g===a||/\?__posthtml_view__=(0|1)/g.test(g)||g.startsWith(a)?g:null},async load(g){if(g===a)return"";if(/\?__posthtml_view__=(0|1)/g.test(g)){const x=ft(g),w=g.includes("__posthtml_view__=1");let E="";return w||(E=E+`import '${x.replace(/\.(t|j)s/g,"")}';`),E=E+(s.get(x)||""),E}return g.startsWith(a)?r.get(g)||"":null},async transform(g,x){return h.command==="build"&&i&&Gt(x)?kt(g):null}}};return[(()=>({name:"view:posthtml-view-dev",enforce:"pre",apply:"serve",configureServer(d){d.middlewares.use(Ie.default({verbose:Boolean({}.DEBUG)&&{}.DEBUG!=="false",disableDotRule:void 0,htmlAcceptHeaders:["text/html","application/xhtml+xml"],rewrites:js(e)}))},async transform(d,h){return i&&e.rtl&&Gt(h)?nt(d,{transformDirInUrl:i.transformDirInUrl||!1,transformEdgeInUrl:i.transformEdgeInUrl||!1}):null},async handleHotUpdate({file:d,server:h}){return(d.includes("/"+e.mocksDirectory)||d.includes(".html"))&&h.ws.send({type:"full-reload",path:"*"}),[]}}))(),u(),Bs(e,i)]}R.compilerViewPlugin=Wt,R.generateName=at,R.slugify=xt,R.toValidCSSIdentifier=X,R.vitePluginPosthtmlView=Us,Object.defineProperty(R,"__esModule",{value:!0}),R[Symbol.toStringTag]="Module"});

(function(R,B){typeof exports=="object"&&typeof module!="undefined"?B(exports,require("crypto"),require("path"),require("posthtml"),require("posthtml-expressions"),require("posthtml-match-helper"),require("posthtml-render"),require("lodash"),require("fs-extra"),require("postcss"),require("postcss-load-config"),require("postcss-safe-parser"),require("postcss-selector-parser"),require("connect-history-api-fallback"),require("fast-glob"),require("shelljs"),require("circular"),require("execa"),require("html-minifier-terser"),require("@rollup/pluginutils"),require("node-localstorage")):typeof define=="function"&&define.amd?define(["exports","crypto","path","posthtml","posthtml-expressions","posthtml-match-helper","posthtml-render","lodash","fs-extra","postcss","postcss-load-config","postcss-safe-parser","postcss-selector-parser","connect-history-api-fallback","fast-glob","shelljs","circular","execa","html-minifier-terser","@rollup/pluginutils","node-localstorage"],B):(R=typeof globalThis!="undefined"?globalThis:R||self,B(R.posthtmlView={},R.crypto,R.path,R.posthtml,R.expressions,R.match,R.posthtmlRender,R.lodash,R.fse,R.postcss,R.postcssrc,R.postcssSafeParser,R.postcssSelectorParser,R.history,R.fg,R.shell,R.circular,R.execa,R.htmlMinifierTerser,R.pluginutils,R.nodeLocalstorage))})(this,function(R,B,oe,ue,fe,pe,he,_t,me,de,ge,ye,_e,ve,we,be,$e,xe,je,Ce,Ee){"use strict";function q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var T=q(oe),G=q(ue),Pe=q(fe),S=q(pe),Z=q(me),Ie=q(de),ke=q(ge),vt=q(ye),wt=q(_e),Se=q(ve),Ae=q(we),bt=q(be),Re=q($e),De=q(xe);function He(t,e=0){const s=1540483477,r=24;let a=t.length,i=e^a,o=0;for(;a>=4;){let u=Te(t,o);u=O(u,s),u^=u>>>r,u=O(u,s),i=O(i,s),i^=u,o+=4,a-=4}switch(a){case 3:i^=$t(t,o),i^=t.charCodeAt(o+2)<<16,i=O(i,s);break;case 2:i^=$t(t,o),i=O(i,s);break;case 1:i^=t.charCodeAt(o),i=O(i,s);break}return i^=i>>>13,i=O(i,s),i^=i>>>15,i>>>0}function Te(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function $t(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function O(t,e){t|=0,e|=0;const s=t&65535,r=t>>>16;return s*e+((r*e&65535)<<16)|0}function xt(t){return He(t).toString(36)}const qe=/[^-_a-z0-9\u00A0-\uFFFF]/gi,Me=/^\d/;function X(t,e){return t&&t.replace(qe,e||"_").replace(Me,e||"_")}const Ne=/^(https?:)?\/\//,jt=t=>Ne.test(t),Oe=/^\s*data:/i,Ct=t=>Oe.test(t),Fe=/({|%|:|})/g;function Et(t){return t.replace(Fe,"\\$1")}function*at(t=[],e=!0,s){s=s||(y=>!0);let r="abcdefghijklmnopqrstuvwxyz";e&&(r=r+r.toUpperCase());const i=r+"0123456789",o=r.length,u=i.length;t=[...t||[],/ad/i];let g=0,d=0;for(;;){let y=o,E="";do E=E+i.charAt(d%y),d=~~(d/y),y=u;while(d>0);!t.some($=>$.test(E))&&s(E)&&(yield E),g++,d=g}}function Be(t,e,s,r){return T.default.join(T.default.isAbsolute(r)?t:T.default.dirname(s||e),r)}function Ve(t,e,s){return e=We(T.default.normalize(T.default.relative(t,e))),s?e[0]==="/"?e:`/${e}`:e}function We(t){const e=/^\\\\\?\\/.test(t),s=/[^\u0000-\u0080]+/.test(t);return e||s?t:t.replace(/\\/g,"/")}const Ue=require("cssjanus"),Pt=new Map,It=/\/\*(.*?)\*\//gs,Ge=/--noflip-rtl-placeholder-\d+:\s*1;?/g,Le=/{(.*?)}/gs;function nt(t,e){const s=Pt.get(t);if(s)return s;let r=ct(t);return r=Ue.transform(r,{transformDirInUrl:!1,transformEdgeInUrl:!1,...e}),r=r.replace(It,""),Pt.set(t,r),r}function kt(t){return t.replace(Le,e=>{let s=-1;return e.replace(It,r=>r.includes("@noflip")?(s=s+1,`--noflip-rtl-placeholder-${s}:1;`):r)})}function ct(t,e){return t.replace(Ge,e===""?e:"/* @noflip */")}const St=/^(?:x-|v-|:|@)/,Je=/\B([A-Z])/g;function ze(t){return(t||"").replace(Je,"-$1").toLowerCase()}function Qe(t){let e=t.replace(".html","-html").replace(/\.|_/g,"").split("/").map(s=>ze(s)).filter(Boolean);return X(e.join("-"),"-")}const K=/\\?{\\?%(\\?:|\\?#)(.*?)\\?%\\?}/gs;function tt(t){const e=!!(t&&K.test(t));return K.lastIndex=0,e}function At(t){return tt(t)}const Ye=/\.(ttf|eot|woff|woff2)$/;function Ze(t){return t=t.split("#")[0],t=t.split("?")[0],Ye.test(t)}const Xe=/\/\*(.*?)\*\//gs;function Ke(t){return t=t&&t.replace(Xe,e=>tt(e)?"":e),tt(t)}function ts(t){return t&&t.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function Rt(t,e=!0){return t=t.replace(/ ?[\n\r]+ ?/g,"").replace(/\s{2,}/g,e?" ":""),ts(t).replace(/\s*;\s*/g,";")}const es=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],ss=["a","animate","animateMotion","animateTransform","circle","clipPath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"];function rs(t,e,s){return function(r){const a=t.content||[],i={};a.length&&r.match.call(a,S.default("template"),u=>(!u.attrs||!u.attrs.slot||(i[u.attrs.slot]=u),u));const o=r.match(S.default("slot"),u=>{const g=u.attrs&&u.attrs.name||"";if(!g)return Dt(u.content,a.filter(y=>!(y.tag==="template"&&y.attrs&&y.attrs.slot)));const d=i[g];return d?Dt(u.content,d.content,as(d)):u.content||[]});return t.tag=!1,t.content=o,r}}function Dt(t,e,s){switch(t=Array.isArray(t)?t:[t||""],e=Array.isArray(e)?e:[e||""],s){case"replace":t=e;break;case"prepend":t=[...e,...t];break;case"append":t=[...t,...e];break;default:t=e.filter(Boolean).length===0?t:e;break}return t}function as(t){let e=t.attrs&&t.attrs.type||"";return["replace","prepend","append"].includes(e)||(e="replace"),e}function Ht(t,e,s,r){return G.default((r||[]).concat(e)).process(he.render(s),t).then(a=>a.tree)}function ns(t,e,s){const r={};Object.entries(e||{}).forEach(([i,o])=>{r[i]=cs(o)});const a={[s.$attrs]:_t.merge({},s.locals,t,r)};return Pe.default({locals:a})}function cs(t){try{return new Function(`return ${t}`)()}catch{return t}}let lt;async function ls({registerComponentsFile:t,root:e,mode:s,encoding:r,prefix:a,join:i,slash:o}){if(lt)return lt;if(!t)return{};const u={},g=i(e,t),d=await Z.default.readFile(g,r);function y(E){E.match(S.default(a("components")),$=>($.content&&$.content.forEach(P=>{if(typeof P=="string")return;let{src:w,..._}=P.attrs||{};P.tag&&w&&(w=i(g,w),u[P.tag]={tag:P.tag,src:w,resolveId:o(w),locals:_})}),$))}return await G.default([]).use(y).process(d,{}),s!=="development"&&(lt=u),u}const is=/^(-\w+-)?animation-name$/,os=/^(-\w+-)?animation$/,us=/-?keyframes$/,Tt=/(?<=^|[^\w\-\u0080-\uffff])url\(\s*('[^']+'|"[^"]+"|[^'")]+)\s*\)/,qt=/image-set\(([^)]+)\)/;function it(t,e,s,r,a,i,o){const u=vt.default(t,{from:r}),g={classNames:[],tags:{},assetsCache:new Set},d=Object.create(null);let y=!1,E="";if(!o){let $=function(l){l.forEach(p=>{if(p.type==="atrule"&&(p.name==="media"||p.name==="supports"))$(p.nodes);else switch(p.type){case"rule":if([a,i].includes(p.selector+"{}"))return;gs(p.nodes),p.selector=Ft(ds(p.selector,E,g));break;case"atrule":if(us.test(p.name))if(p.params.startsWith(":global"))p.params=Ft(p.params);else{const j=`_${_}`;p.params.endsWith(j)||(y=!0,d[p.params]=p.params=p.params+j)}break}})};const P=l=>l.replace(a,"").replace(i,""),w=s.mode==="production",_=xt(`scoped-${e}:`+(w?P(t||""):""));E=X((s.styled.prefix||"")+_),$(u.nodes)}return u.walkDecls($=>{y&&(is.test($.prop)&&($.value=$.value.split(",").map(_=>d[_.trim()]||_.trim()).join(",")),os.test($.prop)&&($.value=$.value.split(",").map(_=>{const l=_.trim().split(/\s+/),p=l.findIndex(v=>d[v]);return p!==-1?(l.splice(p,1,d[l[p]]),l.join(" ")):_}).join(",")));const P=Tt.test($.value),w=qt.test($.value);if(P||w){const _=p=>(p=s.join(r,p),p=s.slash(p,!0),g.assetsCache.add(p),p),l=P?fs:ps;$.value=l($.value,_)}}),{scopedHash:E,scopedClasses:g,css:u.toString()}}function fs(t,e){return Mt(t,Tt,s=>{const[r,a]=s;return Nt(a,r,e)})}function ps(t,e){return Mt(t,qt,s=>{const[r,a]=s;return`image-set(${ms(a,({url:o})=>Nt(o,r,e))})`})}function Mt(t,e,s){let r,a=t,i="";for(;r=e.exec(a);)i+=a.slice(0,r.index),i+=s(r),a=a.slice(r.index+r[0].length);return i+=a,i}function Nt(t,e,s){let r="";const a=t[0];return(a==='"'||a==="'")&&(r=a,t=t.slice(1,-1)),jt(t)||Ct(t)||t.startsWith("#")?e:`url(${r}${s(t)}${r})`}const hs=/( |\\t|\\n|\\f|\\r)+/g;function ms(t,e){const r=t.split(",").map(a=>{const[i,o]=a.replace(hs," ").trim().split(" ",2);return{url:i,descriptor:o}}).filter(({url:a})=>!!a).map(({url:a,descriptor:i})=>({url:e({url:a,descriptor:i}),descriptor:i}));return r.reduce((a,{url:i,descriptor:o},u)=>(o=o||"",a+=i+` ${o}${u===r.length-1?"":", "}`),"")}function ds(t,e,s){return wt.default(r=>{r.walk(a=>{if((a.type==="class"||a.type==="tag")&&!(Ot(a.parent)||Ot(a.parent&&a.parent.parent))){let o=a.value;a.type==="class"&&(At(o)&&(o=Et(o)),s.classNames.includes(o)||s.classNames.push(o)),a.type==="tag"&&(s.tags[o]=!0),a.setPropertyWithoutEscape("value",`${o}.${e}`)}})}).processSync(t)}function gs(t){t.forEach(e=>{e.type==="decl"&&["undefined","null"].includes(e.value)&&(e.remove(),e.cleanRaws())})}function Ot(t){return!!(t&&t.type==="pseudo"&&t.value===":global")}const ys=/:global\((.*?)\)/gs;function Ft(t){return t.replace(ys,"$1")}let F,L;const Bt=()=>{try{F=F||ke.default.sync()}catch{F={file:"",options:{},plugins:[]}}L=L||Ie.default(F.plugins)};function _s(t){function e(s,r){return async function(a){const i=[],o=js(a,s);if(a.walk(u=>{if(typeof u=="string"||!u.tag)return u;const g=u.attrs||{},d=xs(g,u.tag,o,s);if(d){if(es.includes(d.tag))throw new Error(`The component <${d.tag}> is the HTML tag. page file: ${s.from}`);if(ss.includes(d.tag))throw new Error(`The component <${d.tag}> is the SVG tag. page file: ${s.from}`);u.attrs&&delete u.attrs[s.prefix("query")],i.push($s(d,s.encoding).then(ws(u,d,s)).then(y=>{const E={...s,from:d.src};return e(E,!1)(y)}).then(rs(u)))}return u}),r){const u=s.slash(s.from);i.push(Vt(null,{tag:u.replace(/\/|\./g,"-"),src:s.from,resolveId:u,locals:{}},s)(a))}return i.length>0&&(await Promise.all(i),i.length=0),r?await vs(a,s):a}}return e(t,!0)}async function vs(t,e){const{styled:s,js:r,from:a,mode:i,rtl:o}=e,u=i==="development",g="@",d="__posthtml_view_css__";let y="";const E=[];u&&(t.match(S.default("body"),c=>{const h={tag:"div",attrs:{id:d,"data-id":"development_css_container",style:"display: none !important;"}};return c.content=[h,...c.content||[]],c}),t.match(S.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir=o?"rtl":"ltr",c)));const $=new Map,P=[],w=new Map,_=[],l=typeof s.extract=="function",p=r.type==="ts"?"ts":"js";t.match(S.default("style"),function(c){const h=et(c.content);c.attrs=c.attrs||{};const x=c.attrs["data-scoped-hash"]||"",A=c.attrs["data-resolve-id"]||"";let f=c.attrs["data-to"]||s.to||"head";if(u&&f!=="*"&&(f=`#${d}`),(c.attrs["data-to"]==="file"||f==="file")&&l)h&&!w.has(A)&&(w.set(A,{}),!_.includes(A)&&_.push(A),w.set(A,{to:"file",css:h,scopedHash:x,resolveId:A}));else if(h&&!$.has(A)){if($.set(A,{}),f==="*")return u||(delete c.attrs["data-to"],delete c.attrs["data-scoped-hash"],delete c.attrs["data-resolve-id"]),c;!P.includes(A)&&P.push(A),$.set(A,{to:f,css:h,scopedHash:x,resolveId:A})}return c.tag=!1,delete c.content,c}),t.match(S.default('script[type="module"]'),c=>{if(!y&&c.attrs&&c.attrs.src){if(/^(https?:)?\/\//.test(c.attrs.src))return c;c.attrs.src=c.attrs.src+"?__posthtml_view__=0",y=c.attrs.src}return c});function v(){return y||(y=e.slash(a,!0).replace(".html","."+p)+"?__posthtml_view__=1",Array.isArray(t)&&t.push({tag:"script",attrs:{type:"module",src:y}}),y)}const j=new Map,C=c=>{r&&typeof r.extract=="function"&&r.extract(c)};t.match(S.default("script[data-resolve-id]"),c=>{c.attrs=c.attrs||{};const h=c.attrs["data-resolve-id"]||"";if(h&&!j.has(h)){j.set(h,null);const x=c.attrs.src||"",A=c.attrs["data-scoped-hash"]||"",f=(x?"":et(c.content))||"";let k=x&&T.default.extname(x).replace(".","")||p;k=k==="ts"?"ts":"js",C({type:k,from:a,resolveId:h,scopedHash:A,source:f,mainjs:v(),src:x.replace(`.${k}`,"")})}return c.tag=!1,delete c.content,c});const n=new Set;Bt(),_.forEach(c=>{const h=w.get(c);if(!!h&&!!h.css){if(u){h.to=`#${d}`,n.add(h.to),t.match(S.default(h.to),x=>{n.delete(h.to);const A={tag:"style",attrs:{"data-to":"file","data-scoped-hash":h.scopedHash,"data-resolve-id":h.resolveId},content:h.css};return x.content?x.content=[A,...x.content]:x.content=[A],x});return}l&&E.push(L.process(h.css,{...F.options,from:a||void 0}).then(x=>{s.extract&&s.extract({type:"css",from:a,mainjs:v(),resolveId:h.resolveId,scopedHash:h.scopedHash,source:x.css})}))}}),P.forEach(c=>{const h=$.get(c);!h||!h.css||(n.add(h.to),t.match(S.default(h.to),x=>{switch(n.delete(h.to),x.tag){case"head":const A=x.content&&x.content.find(k=>!k||typeof k=="string"?!1:k.tag==="style"&&k.attrs&&k.attrs[d]===g);if(A)A.content=st(A.content,h.css);else{const k={tag:"style",attrs:{[d]:g},content:h.css};x.content?x.content=st(x.content,k):x.content=[k]}break;case"style":x.content=st(x.content,h.css);break;default:const f={tag:"style",attrs:{"data-scoped-hash":h.scopedHash,"data-resolve-id":h.resolveId},content:h.css};x.content?x.content=st(x.content,f):x.content=[f];break}return x}))});const m=typeof e.trimAttr=="function"?e.trimAttr:null,I=typeof e.cumbersomeTrim=="function"?e.cumbersomeTrim:null,b=(c,h)=>{if(typeof h=="string"&&h.trim()){if(m)return m(c,h,Rt);if(c==="application/ld+json"||St.test(c))if(h=Rt(h).trim(),h=h.replace(/^{\s+/g,"{").replace(/\s+}$/g,"}"),I)h=I(c,h);else{const x="[<?=@#$%!*&^@?>]";let A=[],f="";h.replace(/('|")(.*?)('|")/g,(k,M,Y,ie)=>(A.push(`${M}${Y}${ie}`),x)).replace(/\s+(&&|\|\||===?|!==?|<=|>=|\+=|-=)\s+/g,"$1").replace(/\s*\?\s*(.*?)\s*:\s*/g,"?$1:").replace(/(?<=[():\[\],\{\}"!'=])\s+/g,"").replace(/\s+(?=[():\[\],\{\}"!'=])/g,"").split(x).forEach((k,M)=>{f=f+k+(A[M]||"")}),h=f}return h}return null};return t.walk(c=>{if(c.tag&&c.attrs){if(Object.entries(c.attrs).forEach(([h,x])=>{if(["null","undefined"].includes(x)){delete c.attrs[h];return}const A=b(h,x||"");A&&(c.attrs[h]=A)}),c.tag==="script"&&c.attrs.type==="application/ld+json"&&c.content){const h=b(c.attrs.type,[].concat(c.content).join(""));h&&(c.content=[h])}c.attrs.class=(c.attrs.class||"").trim(),c.attrs.class||delete c.attrs.class}return c.tag&&(c.attrs=c.attrs||{},c.tag==="img"&&(c.attrs.alt=c.attrs.alt||""),c.tag==="button"&&(c.attrs.type=c.attrs.type||"button")),c}),t.match(S.default("style"),c=>{const h=et(c.content);return h&&E.push(L.process(h,{...F.options,from:a||void 0}).then(x=>{c.content=[x.css]})),c}),n.forEach(c=>{throw Error("Invalid selector: "+c)}),await Promise.all(E).then(()=>(u||t.match(S.default("head"),c=>{const h={tag:"meta",attrs:{property:"posthtml:view-head-placeholder",content:"*"}};return c.content?c.content.push(h):c.content=[h],c}),t))}function ws(t,e,s){return function(r){return typeof s.htmlProcessor=="function"&&(r=s.htmlProcessor(r)),Ht(s.parser,s.plugins,r,[Vt(t,e,s),ns(e.locals,t.attrs,s)])}}function Vt(t,e,s){Bt();const{stylePreprocessor:r,styled:a,addClassIncludes:i,assets:o,noflip:u,cssjanus:g}=s,d=y=>Promise.resolve(r(y));return async function(y){const E=[];let $=!1,P="",w=null;if(y.match(S.default("style"),l=>{const p=l.attrs||{},v=bs(a,p),j=et(l.content);let C=p.src;const n=p.dynamic!=null||Ke(j);return(C||j)&&E.push(Promise.resolve(null).then(()=>C?(C=s.join(e.src,C),Z.default.readFile(C,s.encoding)):Promise.resolve(j)).then(m=>m?(m=u(m),d(m)):{code:""}).then(m=>{const I=m&&m.code;return{...m,code:g(I||""),to:n&&v.to==="file"?"head":v.to,type:v.type}})),$&&(l.tag=!1,delete l.content),$=!0,l}),E.length>0){const l=await Promise.all(E);E.length=0;const p=l[0].type;let v="",j="",C=a.to;const n=":__posthtml_view_to_file_start_mark__{}",m=":__posthtml_view_to_file_end_mark__{}";l.forEach(f=>{f.to==="file"&&f.code&&(f.code=`${n}${f.code}${m}`),f.type==="scoped"&&(v=v+(f.code||"")),f.type==="global"&&(j=j+(f.code||"")),f.to!=="file"&&f.to!==a.to&&(C=f.to)});const I=it(v,e.resolveId,s,e.src,n,m,!1),b=it(j,e.resolveId,s,e.src,n,m,!0);v=I.css,P=I.scopedHash,w=I.scopedClasses,j=b.css,b.scopedClasses.assetsCache.forEach(f=>{w&&w.assetsCache.add(f)}),b.scopedClasses.assetsCache.clear(),l.length=0;const c=f=>{let k="";return f=f.replace(/:__posthtml_view_to_file_start_mark__{}(.*?):__posthtml_view_to_file_end_mark__{}/gs,function(M,Y){return k=k+Y,""}),{css:f,fileCss:k}},h=c(v),x=c(j);v=h.css,j=x.css;let A="";p==="global"?A=x.fileCss+h.fileCss:A=h.fileCss+x.fileCss,y.match(S.default("style"),f=>(p==="global"?f.content=[j+v]:f.content=[v+j],v="",j="",f.attrs=f.attrs||{},f.attrs["data-to"]=C,f.attrs["data-scoped-hash"]=P,f.attrs["data-resolve-id"]=e.resolveId,delete f.attrs.scoped,delete f.attrs.global,delete f.attrs.src,delete f.attrs.to,delete f.attrs.dynamic,f)),A&&Array.isArray(y)&&y.push({tag:"style",attrs:{"data-to":"file","data-scoped-hash":P,"data-resolve-id":e.resolveId},content:A})}const _=s.prefix("js");if(y.match(S.default("script"),l=>{l.attrs=l.attrs||{};let p=l.attrs.src;return p&&/^(https?:)?\/\//.test(p)?l:l.attrs[_]==="null"||l.attrs[_]==="false"?(delete l.attrs[_],l):p&&l.attrs.type&&l.attrs.type==="module"?(l.attrs.src=s.join(e.src,p),l.attrs.src=s.slash(l.attrs.src,!0),l):(l.attrs.type&&l.attrs[_]==null||(p&&(p=s.join(e.src,p),l.attrs.src=s.slash(p,!0)),l.attrs["data-to"]=l.attrs.to,l.attrs["data-scoped-hash"]=P,l.attrs["data-resolve-id"]=e.resolveId,delete l.attrs.to),l)}),y.walk(l=>{if(typeof l=="string")return l;l.attrs=l.attrs||{};const p=w;if(p&&P&&l.tag){const C=l.attrs,n=C.class||"",m=I=>{i&&i.length&&(I={},i.forEach(b=>{I[b]=C[b]}));for(const b in I)if(Object.prototype.hasOwnProperty.call(I,b)){const c=I[b]||"";if(p.classNames.some(h=>c.includes(h)))return!0}return!1};(p.tags[l.tag]||m(C))&&!n.includes(P)&&(l.attrs.class=`${P} ${n}`.trim())}l.attrs.style&&E.push(L.process(l.attrs.style,{...F.options,from:e.src||void 0}).then(C=>{const n=".__posthtml_view_inline_css_123456_abcdef__{",m=it(`${n}${C.css}}`,e.resolveId,s,e.src,"","",!0);m.scopedClasses.assetsCache.forEach(b=>{w&&w.assetsCache.add(b)}),m.scopedClasses.assetsCache.clear();const I=m.css.replace(n,"").replace("}","");l.attrs&&(l.attrs.style=g(I))})),Object.keys(l.attrs).forEach(C=>{!o.attributes.includes(C)&&o.attrRegExp.test(C)&&o.attributes.push(C)});const v=typeof o._include=="function"&&o._include,j=C=>{if(!String(C).trim()||v&&!v(C)||jt(C)||Ct(C)||C.startsWith("#")||tt(C))return C;let n=s.join(e.src,C);return n=s.slash(n,!0),w&&w.assetsCache.add(n),n};return o.attributes.forEach(C=>{if(l.attrs[C]){const n=l.attrs[C];let m;const I=n.replace(/('|")(.*?)('|")/g,(b,c,h,x)=>(m=!0,`${c}${j(h)}${x}`));l.attrs[C]=m?I:j(n)}}),l}),E.length>0&&(await Promise.all(E),E.length=0),s.mode!=="development"&&w&&w.assetsCache.size){const l={tag:"div",attrs:{__posthtml_view_assets_div__:!0,style:"display:none;"},content:[]};w.assetsCache.forEach(p=>{Ze(p)?l.content.push({tag:"link",attrs:{rel:"preload",as:"font",href:p,"data-raw-url":p}}):l.content.push({tag:"img",attrs:{src:p,"data-raw-url":p}})}),l.content.length&&Array.isArray(y)&&y.push(l),w.assetsCache.clear()}return y}}function bs(t,e){t={...t},t.to=e.to||t.to||"head";let s=t.type;return e.scoped!=null?s="scoped":e.global!=null&&(s="global"),t.type=s||"scoped",t}function $s(t,e){return t.source!=null?Promise.resolve(t.source||""):Z.default.readFile(t.src,e)}function xs(t,e,s,r){const a=r.prefix("query");return(t[a]||"")==="global"?r.components[e]:s[e]||r.components[e]}function js(t,{from:e,prefix:s,join:r,slash:a}){const i={};return t.match(S.default(s("components")),o=>(o.content&&o.content.forEach(u=>{if(typeof u=="string")return;let{src:g,...d}=u.attrs||{};u.tag&&g&&(g=r(e,g),i[u.tag]={tag:u.tag,src:g,resolveId:a(g),locals:d})}),o.tag=!1,delete o.content,o)),t.match(S.default(s("component")),o=>{const u=o.attrs||{};let g=!1;if(u.src){const d="view-src-"+Qe(u.src),y=r(e,u.src);i[d]={tag:d,src:y,resolveId:a(y),locals:{}},o.tag=d,delete u.src}else g=!0;return g&&(o.tag=!1,delete o.content),o}),i}function et(t){return[].concat(t||"").join("").trim()}function st(...t){return[].concat(...t).filter(Boolean)}function Wt(t){const e={...t||{}};return e.root=e.root||process.cwd(),e.mode=e.mode||"development",e.encoding=e.encoding||"utf8",e.viewPrefix=e.viewPrefix||"view:",e.from=e.from||"",e.plugins=e.plugins||[],e.parser=e.parser||{},e.locals=e.locals||{},e.$attrs=e.$attrs||"$attrs",e.stylePreprocessor=e.stylePreprocessor||(s=>({code:s})),e.js={type:"ts",...e.js},e.assets={...e.assets},e.assets.attributes=e.assets.attributes||["data-src","data-img"],e.assets.attrRegExp=e.assets.attrRegExp||St,e.styled={type:"scoped",to:"head",prefix:"view-",...e.styled},typeof e.getOptions=="function"&&e.getOptions(e),e.join=(s,r)=>Be(e.root,e.from,s,r),e.slash=(s,r)=>Ve(e.root,s,r),e.prefix=s=>`${e.viewPrefix}${s}`,e.rtl=e.rtl||!1,e.cssjanus=s=>e.rtl&&e.mode==="development"?nt(s,{transformEdgeInUrl:e.rtl.transformEdgeInUrl,transformDirInUrl:e.rtl.transformDirInUrl}):s,e.noflip=s=>e.rtl?kt(s):s,async function(r){e.components=await ls(e);const a=await _s(e)(r);return await Ht(e.parser,e.plugins,a)}}const Ut=/\.(css|scss|less|sass|styl|stylus|pcss|postcss)$/;function Gt(t){const e=Ut.test(t);return Ut.lastIndex=0,e}function Cs(t,e){t.build=t.build||{},t.build.rollupOptions=t.build.rollupOptions||{},t.build.ssr=!1;const{input:s,pages:r}=Ps(t.root||process.cwd(),e);return t.build.rollupOptions.input=s,t.server=t.server||{},t.server.open===!0&&(t.server.open=r[0]&&`/${r[0].route||""}`||"/"),t}function Es(t){const e=[];return Lt(t).forEach(r=>{const a=`./${r.path}`;r.pageName==="index"&&e.push({from:/^\/$/,to:a}),e.push({from:new RegExp(`^/${r.route}/*`),to:a}),e.push({from:new RegExp(`^/${r.route}$`),to:a})}),e}function Ps(t,e){const s=Lt(e),r={};return s.forEach(a=>{r[a.pageName]=T.default.resolve(t,a.path)}),{input:r,pages:s}}function Lt({pagesDirectory:t,includes:e,ignore:s}){return e=e.filter(Boolean).map(r=>r[0]==="/"?r:"/"+r),Ae.default.sync(`${t}/**/*.html`.replace("//","/"),{objectMode:!0,ignore:s.map(r=>(r.includes(".")?r:`**/${r}/**`).replace("//","/"))}).filter(r=>e.some(a=>r.path.includes(a))?!0:!r.path.includes("/_")).map(({name:r,path:a})=>{const i={filename:r,path:a,route:"",pageName:""};return i.route=a.replace(`${t}/`,""),i.pageName=i.route.replace(/(\/index)?\.html/,"").replace("/","-"),i})}const Jt="0123456789abcdef",zt={"=":"\\:",php:"\\#","\\:":"=","\\#":"php"},Qt=/\\{\\%(\\:|\\#)(.*?)\\%\\}/gs,Is=/<\?(=|php)(.*?)\?>/gs,ks=/(\\%\\})=""/g;function Yt(t){return t.replace(Qt,function(e,s,r){return`<?${zt[s]||s}${r}?>`})}function Zt(t){return t.replace(Is,function(e,s,r){return`\\{\\%${zt[s]||s}${Ss(r,Jt)}\\%\\}`})}function Xt(t){return t.replace(ks,"$1").replace(Qt,function(e,s,r){return`\\{\\%${s}${As(r,Jt)}\\%\\}`})}function Ss(t,e){const s=B.createCipheriv("aes128",e,e);let r=s.update(t,"utf8","hex");return r+=s.final("hex"),r}function As(t,e){const s=B.createDecipheriv("aes128",e,e);let r=s.update(t,"hex","utf8");return r+=s.final("utf8"),r}async function Rs(t,e=!0){let s=null;if(t){const r=bt.default.test("-f",t),a=t.replace(".ts",".js"),i=r||bt.default.test("-f",a);try{let o=null;const u=g=>{e&&require&&require.cache&&!!require.cache[g]&&delete require.cache[g]};r?(u(t),o=require(t)):i&&(u(a),o=require(a)),o&&(s=o.__esModule?o.default:o)}catch(o){console.error(o)}}return s||{}}const Kt=new Map;async function Ds(t,e,s,r){const a=T.default.join(s,".php-dev",r);return Kt.get(r)!==t&&(Kt.set(r,t),await Z.default.outputFile(T.default.resolve(e,a),t,"utf8")),{tplFileName:a,__views:""}}async function Hs(t,e){const{__views:s,...r}=e,a=r;a._TEMPLATE=t,a._REGISTER_GLOBAL_MODEL=!0,a._VIEWS_PATH=s;const i=JSON.stringify(a,Re.default()),{stdout:o}=await De.default("php",[T.default.join(__dirname,"/loader.php")],{input:i});return o}const ot={caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!0,collapseWhitespace:!0,conservativeCollapse:!1,html5:!0,minifyCSS:!0,minifyJS:!0,minifyURLs:!0,noNewlinesBeforeTagClose:!0,removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!1,removeRedundantAttributes:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!1,useShortDoctype:!0};let ut;async function rt(t,e){return typeof e.minifyHtml=="function"&&(e.minifyHtml=e.minifyHtml(ot)),e.minifyHtml&&(ut=ut||(e.minifyHtml===!0?ot:{...ot,...e.minifyHtml,removeTagWhitespace:!1}),t=await je.minify(t,ut),typeof e.minifyHtmlAfter=="function"?t=e.minifyHtmlAfter(t):t=t.replace(/>(\s+)</g,"><")),t}function ft(t){return t.split("?__posthtml_view__=")[0]}const Ts=(t,e,s,r,a)=>{function i(g){const d=T.default.resolve(t.root,e.pagesDirectory);return T.default.relative(d,g)}const o=t.command==="serve",u='<div style="text-align:center;"><h1>posthtml-view</h1><p>No content</p></div>';return async(g,d)=>{const y=i(d.filename);e.php&&(g=Zt(g));const E=G.default([Wt({...e,from:d.filename,htmlProcessor($){return Zt($)},styled:{...e.styled,extract:$=>{const P=ft($.mainjs),w=`${s}/${$.resolveId.replace(".html",".css")}`,_=`import '${w}';`;a.set(w,$.source||"");const l=r.get(P)||"";l.includes(w)||r.set(P,l+_)}},js:{...e.js,extract:$=>{const P=ft($.mainjs);if($.src){const w=r.get(P)||"",_=`import '${$.src}';`;w.includes($.src)||r.set(P,w+_)}else{const w=`${s}/${$.resolveId.replace(".html","")}`,_=`import '${w}';`;a.set(w,$.source||"");const l=r.get(P)||"";l.includes(w)||r.set(P,l+_)}}}}),...e.plugins||[]]);if(typeof e.usePlugins=="function"&&e.usePlugins(E),g=(await E.process(g,{directives:[{name:"!DOCTYPE",start:"<",end:">"},{name:"?php",start:"<",end:">"},{name:"?=",start:"<",end:">"}],...e.parser,sync:!1})).html.trim(),o)if(e.php){if(g=Xt(g),e.devMinifyHtml&&(g=await rt(g,e)),g=Yt(g),typeof e.php.devRender=="function")g=await e.php.devRender({html:g,options:e});else{const $=T.default.join(t.root,e.mocksDirectory,y.replace(".html",".ts")),[P,{tplFileName:w,__views:_}]=await Promise.all([Rs($,!0),Ds(g,t.root,e.cacheDirectory,y)]);g=await Hs(w,{__views:_,...P})}return g||u}else e.devMinifyHtml&&(g=await rt(g,e));return g}};let N,pt,ht,V;const D={classesKey:"_classes",idsKey:"_ids",_classes:{},_ids:{},classes:{},ids:{}},J={},z={};function te(t,e){try{const s=V.getItem(t)||{};return Object.keys(s).forEach(r=>{const a=s[r];e[a]=null}),s}catch{return{}}}async function qs(){V&&(V.setItem(D.classesKey,D.classes),V.setItem(D.idsKey,D.ids))}function Ms(t){N=N||t,N.__cache_file__&&!V&&(V=new Ee.JSONStorage(N.__cache_file__),D._classes=te(D.classesKey,J),D._ids=te(D.idsKey,z)),pt=pt||at(N.generateNameFilters,N.upperCase,e=>J[e]!==null),ht=ht||at(N.generateNameFilters,N.upperCase,e=>z[e]!==null)}function ee(t){const e=vt.default(t);function s(r){r.forEach(a=>{if(a.type==="atrule"&&(a.name==="media"||a.name==="supports"))s(a.nodes);else switch(a.type){case"rule":a.selector=Ns(a.selector);break}})}return s(e.nodes),e.toString()}function Ns(t){return wt.default(e=>{e.walkClasses(s=>{if(W(s.value,!1,!1))return;let r=s.value,a=!1;const i=r.replace(K,o=>(a=!0,` ${o} `));if(a){r=i.split(/\s+/).map(o=>{if(!o)return"";if(W(o,!1))return o;const u=mt(o);return U(u)||o}).filter(Boolean).join("").trim(),r=Et(r),s.setPropertyWithoutEscape("value",r);return}s.setPropertyWithoutEscape("value",U(mt(r))||r)}),e.walkIds(s=>{W(s.value,!0)||(s.value=U(dt(s.value))||s.value)})}).processSync(t)}function mt(t){const e=D._classes[t];if(e)return J[e]=null,D.classes[t]=e,delete D._classes[t],e;const s=D.classes[t];if(s)return J[s]=null,s;const r=pt.next().value;return J[r]=null,D.classes[t]=r,r}function dt(t){const e=D._ids[t];if(e)return z[e]=null,D.ids[t]=e,delete D._ids[t],e;const s=D.ids[t];if(s)return z[s]=null,s;const r=ht.next().value;return z[r]=null,D.ids[t]=r,r}function W(t,e,s){return s!==!1&&At(t)?!0:(t=(e?"#":".")+t,N.filters.some(r=>typeof r=="string"?r===t:r.test(t)))}function U(t){return t&&N.prefix+t}function Os(t){if(W(t,!0))return;const e=dt(t);if(e)return U(e)}function se(t){if(t=t.slice(1),W(t,!0))return;const e=D.ids[t];if(e)return"#"+U(e)}const Fs=/\\?%\\?}(.*?)\\?{\\?%/gs,Bs=/\s+(\\?{\\?%)/g;function Q(t,e,s){return t&&(e||(t=t.replace(K,r=>` ${r} `)),t=t.split(/\s+/).map(r=>{if(!r)return"";if(W(r,e)||typeof s=="function"&&s(r))return r;const a=e?dt(r):mt(r);return U(a)||r}).filter(Boolean).join(" ").trim(),e||(t=t.replace(Fs,(r,a)=>a?r.replace(a,` ${a.trim()} `):r).replace(Bs,"$1")),t)}const re="[[rtl]]",ae="[[ltr]]",gt={type:"syntax",syntax:`<?php if($rtl): ?>${re}<?php else: ?>${ae}<?php endif; ?>`,devPreview:t=>!!(t&&(t.includes("rtl=1")||t.includes("lang=ar")))},ne={enableCache:!0,generateNameFilters:[],upperCase:!0,filters:[/^(\.|#)js-/],attributes:[],blurryAttrs:[],prefix:"",__cache_file__:""};let H;function Vs(t){return typeof t.rtl=="boolean"?t.rtl?gt:!1:{...gt,...t.rtl}}const Ws=/(.*)\[\[(rtl|ltr)\]\](.*)\[\[(rtl|ltr)\]\](.*)/si;function Us(t,e){const s=Ce.createFilter(["**/*.html"]);let r,a=t.preloadCss!==!1;const{type:i,syntax:o}=e||gt,u=w=>nt(w,{transformDirInUrl:e&&e.transformDirInUrl||!1,transformEdgeInUrl:e&&e.transformEdgeInUrl||!1}),g=()=>o&&(o.includes(re)||o.includes(ae));let d=null;if(e&&i==="syntax"&&g()){const w=o.match(Ws);w&&w.length>=6&&(d=w.slice(1).map(_=>_.trim()).filter(Boolean))}const y=["crossorigin","nomodule","defer","async","hidden","x-transition","x-ignore","x-cloak","x-collapse",...t.boolAttrs||[]],E=[];function $(w){w.walk(_=>(_.attrs&&Object.keys(_.attrs).forEach(p=>{_.attrs[p]===""&&y.some(v=>v.indexOf(p)===0)&&(_.attrs[p]=!0)}),_))}const P=async w=>(await G.default([]).use(_=>(_.match(S.default("head"),l=>{const p=[];_.match.call(l,S.default('link[rel="stylesheet"][href]'),n=>{const m=n.attrs||{};return n.tag&&m.href&&E.some(I=>m.href&&m.href.includes(I))&&(a&&p.push({tag:"link",attrs:{...m,rel:"preload",as:"style",href:m.href}}),p.push({tag:"link",attrs:m}),n.tag=!1),n});const v=[];_.match.call(l,S.default('link[rel="preload"][as="image"][href]'),n=>{const m=n.attrs||{};return n.tag&&m.href&&(v.push({tag:"link",attrs:m}),n.tag=!1),n});const j=[];_.match.call(l,S.default("style[__posthtml_view_css__]"),n=>{const m=le(n.content);return n.tag&&m&&!j.includes(m)&&j.push(m),n.tag=!1,delete n.content,n});const C=j.map(n=>({tag:"style",content:n}));return _.match.call(l,S.default('meta[property="posthtml:view-head-placeholder"]'),n=>(n.content=[...p,...v,...C],n.tag=!1,n)),l}),H&&_.match(S.default("style"),l=>{if(l.attrs&&l.attrs["data-min-class-ignore"]!=null)return delete l.attrs["data-min-class-ignore"],l;const p=le(l.content);return p&&(l.content=[ee(p)]),l}),_)).use(_=>{const l=new Map,p=n=>(n&&l.size&&l.forEach((m,I)=>{n=ce(n,I,m)}),n);_.match(S.default("div[__posthtml_view_assets_div__]"),n=>(_.match.call(n,S.default("[data-raw-url]"),m=>(m.attrs&&m.attrs["data-raw-url"]&&l.set(m.attrs["data-raw-url"],m.attrs.href||m.attrs.src||""),m.tag=!1,m)),n.tag=!1,delete n.content,n));const v=t.assets.attributes,j=t.assets.attrRegExp;_.walk(n=>{if(typeof n=="string")return n;if(n.attrs){const m=Object.keys(n.attrs);m.forEach(b=>{!v.includes(b)&&j.test(b)&&v.push(b)}),v&&v.forEach(b=>{n.attrs[b]&&(n.attrs[b]=p(n.attrs[b]))}),n.attrs.style&&(n.attrs.style=p(n.attrs.style));const I=(n.attrs["view-build-class"]||"").split(" ").filter(Boolean);if(delete n.attrs["view-build-class"],H){const b=[...H.attributes,/^[xv]-transition/],c=[...H.blurryAttrs,/^([xv]-bind)?:class/],h=(f,k)=>f.some(M=>typeof M=="string"?M===k:M.test&&M.test(k)),x=f=>r.assetsInclude(f)?!0:I.length?!I.includes(f):!1;if(m.forEach(f=>{if(!(f==="id"||f==="class")&&typeof n.attrs[f]=="string"&&!(typeof n.attrs[f]=="string"&&!n.attrs[f].trim()))if(h(b,f))n.attrs[f]=Q(n.attrs[f],!1,x);else if(h(c,f)){const k=n.attrs[f]||"";let M;const Y=k.replace(/('|")(.*?)('|")/g,(ie,Js,zs,Qs)=>(M=!0,`${Js}${Q(zs,!1,x)}${Qs}`));n.attrs[f]=M?Y:k}else I.length&&I.forEach(k=>{if(n.attrs[f].includes(k)){const M=Q(k);n.attrs[f]=ce(n.attrs[f],k,M)}})}),n.attrs.class&&(n.attrs.class=Q(n.attrs.class)),n.attrs.id&&(n.attrs.id=Q(n.attrs.id,!0)),n.attrs.for){const f=Os(n.attrs.for);f&&(n.attrs.for=f)}if(["mask","fill","filter"].forEach(f=>{if(n.attrs[f]){const k=se(n.attrs[f].replace(/url\((.*?)\)/g,"$1"));k&&(n.attrs[f]=`url(${k})`)}}),n.tag==="use"&&(n.attrs.href||n.attrs["xlink:href"])){const f=n.attrs.href?"href":"xlink:href",k=se(n.attrs[f]||"");k&&(n.attrs[f]=k)}}}return n});const C="posthtml-view-syntax-style-x";return _.match(S.default("style"),n=>{let m=p([].concat(n.content||"").join("").trim()),I=m&&ct(m,"");if(I&&d&&d.length){const b=u(m);if(b!==I)return n.content=d.map(c=>c==="rtl"?{tag:C,attrs:n.attrs,content:b}:c==="ltr"?{tag:C,attrs:n.attrs,content:I}:c),n.tag=!1,n.attrs=void 0,n}return I&&(n.content=[I]),n}),d&&d.length?(_.match(S.default("link[href]"),n=>{const m=n.attrs&&n.attrs.href;if(n.attrs&&m&&m.endsWith(".css")&&d){const I=m.replace(".css",".rtl.css");n.attrs.href=d.map(b=>b==="rtl"?I:b==="ltr"?m:b).join("")}return n}),_.match(S.default("html"),n=>(d&&(n.attrs=n.attrs||{},n.attrs.dir=d.map(m=>m==="rtl"?"rtl":m==="ltr"?"ltr":m).join("")),n))):_.match(S.default("html"),n=>(n.attrs=n.attrs||{},n.attrs.dir="ltr",n)),Promise.resolve().then(()=>(_.match(S.default(C),n=>(n.tag="style",n)),_))}).use(_=>Promise.resolve().then(()=>{let l;return typeof t.generateUsePlugins=="function"&&(l=t.generateUsePlugins(_)),$(l||_)})).process(w,{})).html;return{name:"view:posthtml-view-bundle",enforce:"post",apply:"build",configResolved(w){r=w},async generateBundle(w,_){const l=t.minifyClassnames;l&&!H&&(H=l===!0?ne:{...ne,...l},H.prefix=H.prefix&&X(H.prefix),H.filters=[...H.filters,"#vite-legacy-polyfill","#vite-legacy-entry"],H.enableCache?H.__cache_file__=T.default.join(r.root,T.default.join(t.cacheDirectory,"css")):H.__cache_file__="",Ms(H));const p=Object.values(_);for(const v of p)if(v.type==="asset"&&v.fileName.endsWith(".css")){!E.includes(v.fileName)&&E.push(v.fileName);let j=yt(v.source);H&&(j=ee(j)),v.source=ct(j,""),e&&this.emitFile({type:"asset",fileName:v.fileName.replace(".css",".rtl.css"),name:v.name?v.name.replace(".css",".rtl.css"):void 0,source:u(j)})}for(const v of p){if(v.type==="asset"&&s(v.fileName)){let j=yt(v.source);j=await P(j),t.php&&(j=Xt(j)),j=await rt(j,t),t.php&&(j=Yt(j)),v.source=j;const{fileName:C,name:n}=Gs(v.fileName,v.name,t);if(v.fileName=C,v.name=n,e&&i==="new-html"){let m=(await G.default([]).use(I=>(I.match(S.default("html"),b=>(b.attrs=b.attrs||{},b.attrs.dir="rtl",b)),I.match(S.default("link[href]"),b=>(b.attrs&&b.attrs.href&&b.attrs.href.endsWith(".css")&&(b.attrs.href=b.attrs.href.replace(".css",".rtl.css")),b)),I.match(S.default("style"),b=>{const c=[].concat(b.content||"").join("").trim();return c&&(b.content=[u(c)]),b}),$(I))).process(j,{})).html;m&&(m=await rt(m,t),this.emitFile({type:"asset",fileName:C.replace(/\.(html?|php)/g,".rtl.$1"),name:n?n.replace(/\.(html?|php)/g,".rtl.$1"):void 0,source:m}))}}if(v.type==="chunk"&&v.fileName.includes("-legacy")&&typeof t.removeCssInJs=="function"){const j=t.removeCssInJs(yt(v.code));v.code=j||v.code}}await qs()}}}function Gs(t,e,s){const{buildPagesDirectory:r,pagesDirectory:a,php:i}=s;if(r!==a){const o=t.indexOf(a);o>=0&&(t=r+t.slice(o+a.length))}return i&&i.rename&&(t=t.replace(/\.(html?)/g,".php"),e&&(e=e.replace(/\.(html?)/g,".php"))),{fileName:t,name:e}}function yt(t){return t instanceof Uint8Array?Buffer.from(t).toString("utf-8"):t}function ce(t,e,s){for(;t.includes(e);)t=t.replace(e,s);return t}function le(...t){return[].concat(...t).filter(Boolean).join("").trim()}function Ls(t){const e=_t.merge({includes:[],ignore:[],pagesDirectory:"pages",mocksDirectory:"mocks",buildPagesDirectory:"pages",cacheDirectory:".posthtml-view-cache",usePlugins:null,rtl:!1,minifyHtml:!0,devMinifyHtml:!1,minifyClassnames:!1,preloadCss:!0},t||{});e.pagesDirectory=e.pagesDirectory||"pages",e.buildPagesDirectory=e.buildPagesDirectory||e.pagesDirectory,e.cacheDirectory=e.cacheDirectory||".posthtml-view-cache",e.getOptions=g=>{e.styled=g.styled,e.assets=g.assets};const s=new Map,r=new Map,a="virtual:posthtml-view",i=Vs(e),o=()=>{const g="view:posthtml-view-pages";let d;return{name:g,enforce:"pre",config(y,{mode:E}){Cs(y,e)},configResolved(y){d=y,e.root=d.root,e.assets=e.assets||{},e.assets._include=d.assetsInclude,e.mode=d.command==="build"?"production":"development"},transformIndexHtml:{enforce:"pre",async transform(y,E){return d.command==="serve"?i&&typeof i.devPreview=="function"&&i.devPreview(E.originalUrl)?e.rtl=i:e.rtl=!1:e.rtl=i,await Ts(d,e,a,s,r)(y,E)}},async resolveId(y,E){return y===a||/\?__posthtml_view__=(0|1)/g.test(y)||y.startsWith(a)?y:null},async load(y){if(y===a)return"";if(/\?__posthtml_view__=(0|1)/g.test(y)){const E=ft(y),$=y.includes("__posthtml_view__=1");let P="";return $||(P=P+`import '${E.replace(/\.(t|j)s/g,"")}';`),P=P+(s.get(E)||""),P}return y.startsWith(a)?r.get(y)||"":null},async transform(y,E){return d.command==="build"&&i&&Gt(E)?kt(y):null}}};return[(()=>({name:"view:posthtml-view-dev",enforce:"pre",apply:"serve",configureServer(g){g.middlewares.use(Se.default({verbose:Boolean({}.DEBUG)&&{}.DEBUG!=="false",disableDotRule:void 0,htmlAcceptHeaders:["text/html","application/xhtml+xml"],rewrites:Es(e)}))},async transform(g,d){return i&&e.rtl&&Gt(d)?nt(g,{transformDirInUrl:i.transformDirInUrl||!1,transformEdgeInUrl:i.transformEdgeInUrl||!1}):null},async handleHotUpdate({file:g,server:d}){return(g.includes("/"+e.mocksDirectory)||g.includes(".html"))&&d.ws.send({type:"full-reload",path:"*"}),[]}}))(),o(),Us(e,i)]}R.compilerViewPlugin=Wt,R.generateName=at,R.slugify=xt,R.toValidCSSIdentifier=X,R.vitePluginPosthtmlView=Ls,Object.defineProperty(R,"__esModule",{value:!0}),R[Symbol.toStringTag]="Module"});

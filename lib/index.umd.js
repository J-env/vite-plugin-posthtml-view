(function(R,F){typeof exports=="object"&&typeof module!="undefined"?F(exports,require("crypto"),require("path"),require("posthtml"),require("posthtml-expressions"),require("posthtml-match-helper"),require("posthtml-render"),require("lodash"),require("fs-extra"),require("postcss"),require("postcss-load-config"),require("postcss-safe-parser"),require("postcss-selector-parser"),require("connect-history-api-fallback"),require("fast-glob"),require("shelljs"),require("circular"),require("execa"),require("html-minifier-terser"),require("@rollup/pluginutils"),require("node-localstorage")):typeof define=="function"&&define.amd?define(["exports","crypto","path","posthtml","posthtml-expressions","posthtml-match-helper","posthtml-render","lodash","fs-extra","postcss","postcss-load-config","postcss-safe-parser","postcss-selector-parser","connect-history-api-fallback","fast-glob","shelljs","circular","execa","html-minifier-terser","@rollup/pluginutils","node-localstorage"],F):(R=typeof globalThis!="undefined"?globalThis:R||self,F(R.posthtmlView={},R.crypto,R.path,R.posthtml,R.expressions,R.match,R.posthtmlRender,R.lodash,R.fse,R.postcss,R.postcssrc,R.postcssSafeParser,R.postcssSelectorParser,R.history,R.fg,R.shell,R.circular,R.execa,R.htmlMinifierTerser,R.pluginutils,R.nodeLocalstorage))})(this,function(R,F,oe,ue,fe,pe,he,vt,me,de,ge,ye,_e,ve,we,be,xe,$e,je,Ee,Pe){"use strict";function q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var N=q(oe),L=q(ue),Ce=q(fe),S=q(pe),Y=q(me),Ie=q(de),ke=q(ge),wt=q(ye),bt=q(_e),Se=q(ve),Ae=q(we),Re=q(be),De=q(xe),Te=q($e);function He(t,e=0){const s=1540483477,r=24;let a=t.length,i=e^a,o=0;for(;a>=4;){let u=Ne(t,o);u=B(u,s),u^=u>>>r,u=B(u,s),i=B(i,s),i^=u,o+=4,a-=4}switch(a){case 3:i^=xt(t,o),i^=t.charCodeAt(o+2)<<16,i=B(i,s);break;case 2:i^=xt(t,o),i=B(i,s);break;case 1:i^=t.charCodeAt(o),i=B(i,s);break}return i^=i>>>13,i=B(i,s),i^=i>>>15,i>>>0}function Ne(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function xt(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function B(t,e){t|=0,e|=0;const s=t&65535,r=t>>>16;return s*e+((r*e&65535)<<16)|0}function $t(t){return He(t).toString(36)}const Oe=/[^-_a-z0-9\u00A0-\uFFFF]/gi,qe=/^\d/;function Z(t,e){return t&&t.replace(Oe,e||"_").replace(qe,e||"_")}const Me=/^(https?:)?\/\//,jt=t=>Me.test(t),Be=/^\s*data:/i,Et=t=>Be.test(t),Fe=/({|@|:|})/g;function Pt(t){return t.replace(Fe,"\\$1")}function*nt(t=[],e=!0,s){s=s||(g=>!0);let r="abcdefghijklmnopqrstuvwxyz";e&&(r=r+r.toUpperCase());const i=r+"0123456789",o=r.length,u=i.length;t=[...t||[],/ad/i];let d=0,m=0;for(;;){let g=o,E="";do E=E+i.charAt(m%g),m=~~(m/g),g=u;while(m>0);!t.some($=>$.test(E))&&s(E)&&(yield E),d++,m=d}}function Ve(t,e,s,r){return N.default.join(N.default.isAbsolute(r)?t:N.default.dirname(s||e),r)}function We(t,e,s){return e=Ue(N.default.normalize(N.default.relative(t,e))),s?e[0]==="/"?e:`/${e}`:e}function Ue(t){const e=/^\\\\\?\\/.test(t),s=/[^\u0000-\u0080]+/.test(t);return e||s?t:t.replace(/\\/g,"/")}const Ge=require("cssjanus"),Ct=new Map,It=/\/\*(.*?)\*\//gs,Le=/--noflip-rtl-placeholder-\d+:\s*1;?/g,Je=/{(.*?)}/gs;function ct(t,e){const s=Ct.get(t);if(s)return s;let r=lt(t);return r=Ge.transform(r,{transformDirInUrl:!1,transformEdgeInUrl:!1,...e}),r=r.replace(It,""),Ct.set(t,r),r}function kt(t){return t.replace(Je,e=>{let s=-1;return e.replace(It,r=>r.includes("@noflip")?(s=s+1,`--noflip-rtl-placeholder-${s}:1;`):r)})}function lt(t,e){return t.replace(Le,e===""?e:"/* @noflip */")}const St=/^(?:x-|v-|:|@)/,ze=/\B([A-Z])/g;function Qe(t){return(t||"").replace(ze,"-$1").toLowerCase()}function Ye(t){let e=t.replace(".html","-html").replace(/\.|_/g,"").split("/").map(s=>Qe(s)).filter(Boolean);return Z(e.join("-"),"-")}const X=/\\?{\\?@(\\?:|\\?#)(.*?)\\?@\\?}/gs;function K(t){const e=!!(t&&X.test(t));return X.lastIndex=0,e}function At(t){return K(t)}const Ze=/\.(ttf|eot|woff|woff2)$/;function Xe(t){return t=t.split("#")[0],t=t.split("?")[0],Ze.test(t)}const Ke=/\/\*(.*?)\*\//gs;function ts(t){return t=t&&t.replace(Ke,e=>K(e)?"":e),K(t)}function es(t){return t&&t.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function Rt(t,e=!0){return t=t.replace(/ ?[\n\r]+ ?/g,"").replace(/\s{2,}/g,e?" ":""),es(t).replace(/\s*;\s*/g,";")}const ss=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],rs=["a","animate","animateMotion","animateTransform","circle","clipPath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"];function as(t,e,s){return function(r){const a=t.content||[],i={};a.length&&r.match.call(a,S.default("template"),u=>(!u.attrs||!u.attrs.slot||(i[u.attrs.slot]=u),u));const o=r.match(S.default("slot"),u=>{const d=u.attrs&&u.attrs.name||"";if(!d)return Dt(u.content,a.filter(g=>!(g.tag==="template"&&g.attrs&&g.attrs.slot)));const m=i[d];return m?Dt(u.content,m.content,ns(m)):u.content||[]});return t.tag=!1,t.content=o,r}}function Dt(t,e,s){switch(t=Array.isArray(t)?t:[t||""],e=Array.isArray(e)?e:[e||""],s){case"replace":t=e;break;case"prepend":t=[...e,...t];break;case"append":t=[...t,...e];break;default:t=e.filter(Boolean).length===0?t:e;break}return t}function ns(t){let e=t.attrs&&t.attrs.type||"";return["replace","prepend","append"].includes(e)||(e="replace"),e}function Tt(t,e,s,r){return L.default((r||[]).concat(e)).process(he.render(s),t).then(a=>a.tree)}function cs(t,e,s,r){const a={};Object.entries(e||{}).forEach(([u,d])=>{a[u]=ls(d)});const i={MODE:s.mode,DEV:s.mode==="development",PROD:s.mode==="production",PAGE:s.slash(s.from,!0)},o={[s.$attrs]:vt.merge({},s.locals,t.locals,a,{env:i})};return Ce.default({locals:o})}function ls(t){try{return new Function(`return ${t}`)()}catch{return t}}let it;async function is({registerComponentsFile:t,root:e,mode:s,encoding:r,prefix:a,join:i,slash:o}){if(it)return it;if(!t)return{};const u={},d=i(e,t),m=await Y.default.readFile(d,r);function g(E){E.match(S.default(a("components")),$=>($.content&&$.content.forEach(I=>{if(typeof I=="string")return;let{src:k,...C}=I.attrs||{};I.tag&&k&&(k=i(d,k),u[I.tag]={tag:I.tag,src:k,resolveId:o(k),locals:C})}),$))}return await L.default([]).use(g).process(m,{}),s!=="development"&&(it=u),u}const os=/^(-\w+-)?animation-name$/,us=/^(-\w+-)?animation$/,fs=/-?keyframes$/,Ht=/(?<=^|[^\w\-\u0080-\uffff])url\(\s*('[^']+'|"[^"]+"|[^'")]+)\s*\)/,Nt=/image-set\(([^)]+)\)/;function Ot(t,e,s,r,a,i,o){const u=wt.default(t,{from:r}),d={classNames:[],tags:{},assetsCache:new Set},m=Object.create(null);let g=!1,E="";if(!o){let $=function(l){l.forEach(p=>{if(p.type==="atrule"&&(p.name==="media"||p.name==="supports"))$(p.nodes);else switch(p.type){case"rule":if([a,i].includes(p.selector+"{}"))return;ys(p.nodes),p.selector=Ft(gs(p.selector,E,d));break;case"atrule":if(fs.test(p.name))if(p.params.startsWith(":global"))p.params=Ft(p.params);else{const y=`_${C}`;p.params.endsWith(y)||(g=!0,m[p.params]=p.params=p.params+y)}break}})};const I=l=>l.replace(a,"").replace(i,""),k=s.mode==="production",C=$t(`scoped-${e}:`+(k?I(t||""):""));E=Z((s.styled.prefix||"")+C),$(u.nodes)}return u.walkDecls($=>{g&&(os.test($.prop)&&($.value=$.value.split(",").map(C=>m[C.trim()]||C.trim()).join(",")),us.test($.prop)&&($.value=$.value.split(",").map(C=>{const l=C.trim().split(/\s+/),p=l.findIndex(w=>m[w]);return p!==-1?(l.splice(p,1,m[l[p]]),l.join(" ")):C}).join(",")));const I=Ht.test($.value),k=Nt.test($.value);if(I||k){const C=p=>(p=s.join(r,p),p=s.slash(p,!0),d.assetsCache.add(p),p),l=I?ps:hs;$.value=l($.value,C)}}),{scopedHash:E,scopedClasses:d,css:u.toString()}}function ps(t,e){return qt(t,Ht,s=>{const[r,a]=s;return Mt(a,r,e)})}function hs(t,e){return qt(t,Nt,s=>{const[r,a]=s;return`image-set(${ds(a,({url:o})=>Mt(o,r,e))})`})}function qt(t,e,s){let r,a=t,i="";for(;r=e.exec(a);)i+=a.slice(0,r.index),i+=s(r),a=a.slice(r.index+r[0].length);return i+=a,i}function Mt(t,e,s){let r="";const a=t[0];return(a==='"'||a==="'")&&(r=a,t=t.slice(1,-1)),jt(t)||Et(t)||t.startsWith("#")?e:`url(${r}${s(t)}${r})`}const ms=/( |\\t|\\n|\\f|\\r)+/g;function ds(t,e){const r=t.split(",").map(a=>{const[i,o]=a.replace(ms," ").trim().split(" ",2);return{url:i,descriptor:o}}).filter(({url:a})=>!!a).map(({url:a,descriptor:i})=>({url:e({url:a,descriptor:i}),descriptor:i}));return r.reduce((a,{url:i,descriptor:o},u)=>(o=o||"",a+=i+` ${o}${u===r.length-1?"":", "}`),"")}function gs(t,e,s){return bt.default(r=>{r.walk(a=>{if((a.type==="class"||a.type==="tag")&&!(Bt(a.parent)||Bt(a.parent&&a.parent.parent))){let o=a.value;a.type==="class"&&(At(o)&&(o=Pt(o)),s.classNames.includes(o)||s.classNames.push(o)),a.type==="tag"&&(s.tags[o]=!0),a.setPropertyWithoutEscape("value",`${o}.${e}`)}})}).processSync(t)}function ys(t){t.forEach(e=>{e.type==="decl"&&["undefined","null"].includes(e.value)&&(e.remove(),e.cleanRaws())})}function Bt(t){return!!(t&&t.type==="pseudo"&&t.value===":global")}const _s=/:global\((.*?)\)/gs;function Ft(t){return t.replace(_s,"$1")}let V,tt;const Vt=()=>{try{V=V||ke.default.sync()}catch{V={file:"",options:{},plugins:[]}}tt=tt||Ie.default(V.plugins)};function vs(t){function e(s,r){return async function(a){const i=[],o=Es(a,s);if(a.walk(u=>{if(typeof u=="string"||!u.tag)return u;const d=u.attrs||{},m=js(d,u.tag,o,s);if(m){if(ss.includes(m.tag))throw new Error(`The component <${m.tag}> is the HTML tag. page file: ${s.from}`);if(rs.includes(m.tag))throw new Error(`The component <${m.tag}> is the SVG tag. page file: ${s.from}`);u.attrs&&delete u.attrs[s.prefix("query")],i.push($s(m,s.encoding).then(bs(u,m,s)).then(g=>{const E={...s,from:m.src};return e(E,!1)(g)}).then(as(u)))}return u}),r){const u=s.slash(s.from);i.push(Wt(null,{tag:u.replace(/\/|\./g,"-"),src:s.from,resolveId:u,locals:{}},s)(a))}return i.length>0&&(await Promise.all(i),i.length=0),r?await ws(a,s):a}}return e(t,!0)}async function ws(t,e){const{styled:s,js:r,from:a,mode:i,rtl:o}=e,u=i==="development",d="@",m="__posthtml_view_css__";let g="",E=!1;t.match(S.default("body"),n=>(E=!0,n));const $=[];u&&E&&(t.match(S.default("body"),n=>{const h={tag:"div",attrs:{id:m,"data-id":"development_css_container",style:"display: none !important;"}};return n.content=[h,...n.content||[]],n}),t.match(S.default("html"),n=>(n.attrs=n.attrs||{},n.attrs.dir=o?"rtl":"ltr",n)));const I=new Map,k=[],C=new Map,l=[],p=E&&typeof s.extract=="function",w=r.type==="ts"?"ts":"js";t.match(S.default("style"),function(n){const h=et(n.content);n.attrs=n.attrs||{};const P=n.attrs["data-scoped-hash"]||"",_=n.attrs["data-resolve-id"]||"";let x=E?n.attrs["data-to"]||s.to||"head":"*";if(u&&x!=="*"&&(x=`#${m}`),(n.attrs["data-to"]==="file"||x==="file")&&p)h&&!C.has(_)&&(C.set(_,{}),!l.includes(_)&&l.push(_),C.set(_,{to:"file",css:h,scopedHash:P,resolveId:_}));else if(h&&!I.has(_)){if(I.set(_,{}),x==="*")return u||(delete n.attrs["data-to"],delete n.attrs["data-scoped-hash"],delete n.attrs["data-resolve-id"]),n;!k.includes(_)&&k.push(_),I.set(_,{to:x,css:h,scopedHash:P,resolveId:_})}return n.tag=!1,delete n.content,n}),t.match(S.default('script[type="module"]'),n=>{if(!g&&n.attrs&&n.attrs.src){if(/^(https?:)?\/\//.test(n.attrs.src))return n;n.attrs.src=n.attrs.src+"?__posthtml_view__=0",g=n.attrs.src}return n});function y(){return g||(g=E?e.slash(a,!0).replace(".html","."+w)+"?__posthtml_view__=1":"",E&&Array.isArray(t)&&t.push({tag:"script",attrs:{type:"module",src:g}}),g)}const v=new Map,D=n=>{r&&typeof r.extract=="function"&&r.extract(n)};t.match(S.default("script[data-resolve-id]"),n=>{n.attrs=n.attrs||{};const h=n.attrs["data-resolve-id"]||"";if(h&&!v.has(h)&&E){v.set(h,null);const P=n.attrs.src||"",_=n.attrs["data-scoped-hash"]||"",x=(P?"":et(n.content))||"";let A=P&&N.default.extname(P).replace(".","")||w;A=A==="ts"?"ts":"js",D({type:A,from:a,resolveId:h,scopedHash:_,source:x,mainjs:y(),src:P.replace(`.${A}`,"")})}return n.tag=!1,delete n.content,n});const c=new Set;Vt(),l.forEach(n=>{const h=C.get(n);if(!!h&&!!h.css){if(u){h.to=`#${m}`,c.add(h.to),t.match(S.default(h.to),P=>{c.delete(h.to);const _={tag:"style",attrs:{"data-to":"file","data-scoped-hash":h.scopedHash,"data-resolve-id":h.resolveId},content:h.css};return P.content?P.content=[_,...P.content]:P.content=[_],P});return}p&&$.push(tt.process(h.css,{...V.options,from:a||void 0}).then(P=>{s.extract&&s.extract({type:"css",from:a,mainjs:y(),resolveId:h.resolveId,scopedHash:h.scopedHash,source:P.css})}))}}),k.forEach(n=>{const h=I.get(n);!h||!h.css||(c.add(h.to),t.match(S.default(h.to),P=>{switch(c.delete(h.to),P.tag){case"head":const _=P.content&&P.content.find(A=>!A||typeof A=="string"?!1:A.tag==="style"&&A.attrs&&A.attrs[m]===d);if(_)_.content=st(_.content,h.css);else{const A={tag:"style",attrs:{[m]:d},content:h.css};P.content?P.content=st(P.content,A):P.content=[A]}break;case"style":P.content=st(P.content,h.css);break;default:const x={tag:"style",attrs:{"data-scoped-hash":h.scopedHash,"data-resolve-id":h.resolveId},content:h.css};P.content?P.content=st(P.content,x):P.content=[x];break}return P}))});const f=typeof e.trimAttr=="function"?e.trimAttr:null,b=typeof e.cumbersomeTrim=="function"?e.cumbersomeTrim:null,j=(n,h)=>{if(typeof h=="string"&&h.trim()){if(f)return f(n,h,Rt);if(n==="application/ld+json"||St.test(n))if(h=Rt(h).trim(),h=h.replace(/^{\s+/g,"{").replace(/\s+}$/g,"}"),b)h=b(n,h);else{const P="[<?=@#$%!*&^@?>]";let _=[],x="";h.replace(/('|")(.*?)('|")/g,(A,O,_t,ie)=>(_.push(`${O}${_t}${ie}`),P)).replace(/\s+(&&|\|\||===?|!==?|<=|>=|\+=|-=)\s+/g,"$1").replace(/\s*\?\s*(.*?)\s*:\s*/g,"?$1:").replace(/(?<=[():\[\],\{\}"!'=])\s+/g,"").replace(/\s+(?=[():\[\],\{\}"!'=])/g,"").split(P).forEach((A,O)=>{x=x+A+(_[O]||"")}),h=x}return h}return null};return t.walk(n=>{if(n.tag&&n.attrs){if(Object.entries(n.attrs).forEach(([h,P])=>{if(["null","undefined"].includes(P)){delete n.attrs[h];return}const _=j(h,P||"");_&&(n.attrs[h]=_)}),n.tag==="script"&&n.attrs.type==="application/ld+json"&&n.content){const h=j(n.attrs.type,[].concat(n.content).join(""));h&&(n.content=[h])}n.attrs.class=(n.attrs.class||"").trim(),n.attrs.class||delete n.attrs.class}return n.tag&&(n.attrs=n.attrs||{},n.tag==="img"&&(n.attrs.alt=n.attrs.alt||""),n.tag==="button"&&(n.attrs.type=n.attrs.type||"button")),n}),t.match(S.default("style"),n=>{const h=et(n.content);return h&&$.push(tt.process(h,{...V.options,from:a||void 0}).then(P=>{n.content=[P.css]})),n}),c.forEach(n=>{throw Error("Invalid selector: "+n)}),await Promise.all($).then(()=>(u||t.match(S.default("head"),n=>{const h={tag:"meta",attrs:{property:"posthtml:view-head-placeholder",content:"*"}};return n.content?n.content.push(h):n.content=[h],n}),t))}function bs(t,e,s,r){return function(a){return typeof s.htmlProcessor=="function"&&(a=s.htmlProcessor(a)),Tt(s.parser,s.plugins,a,[Wt(t,e,s),cs(e,t.attrs,s)])}}function Wt(t,e,s){Vt();const{stylePreprocessor:r,styled:a,addClassIncludes:i,assets:o,noflip:u,cssjanus:d}=s,m=g=>Promise.resolve(r(g));return async function(g){const E=[];let $=!1,I="",k=null;if(g.match(S.default("style"),l=>{const p=l.attrs||{},w=xs(a,p),y=et(l.content);let v=p.src;const D=p.dynamic!=null||ts(y);return(v||y)&&E.push(Promise.resolve(null).then(()=>v?(v=s.join(e.src,v),Y.default.readFile(v,s.encoding)):Promise.resolve(y)).then(c=>c?(c=u(c),m(c)):{code:""}).then(c=>{const f=c&&c.code;return{...c,code:d(f||""),to:D&&w.to==="file"?"head":w.to,type:w.type}})),$&&(l.tag=!1,delete l.content),$=!0,l}),E.length>0){const l=await Promise.all(E);E.length=0;const p=l[0].type;let w="",y="",v=a.to;const D=":__posthtml_view_to_file_start_mark__{}",c=":__posthtml_view_to_file_end_mark__{}";l.forEach(_=>{_.to==="file"&&_.code&&(_.code=`${D}${_.code}${c}`),_.type==="scoped"&&(w=w+(_.code||"")),_.type==="global"&&(y=y+(_.code||"")),_.to!=="file"&&_.to!==a.to&&(v=_.to)});const f=Ot(w,e.resolveId,s,e.src,D,c,!1),b=Ot(y,e.resolveId,s,e.src,D,c,!0);w=f.css,I=f.scopedHash,k=f.scopedClasses,y=b.css,b.scopedClasses.assetsCache.forEach(_=>{k&&k.assetsCache.add(_)}),b.scopedClasses.assetsCache.clear(),l.length=0;const j=_=>{let x="";return _=_.replace(/:__posthtml_view_to_file_start_mark__{}(.*?):__posthtml_view_to_file_end_mark__{}/gs,function(A,O){return x=x+O,""}),{css:_,fileCss:x}},n=j(w),h=j(y);w=n.css,y=h.css;let P="";p==="global"?P=h.fileCss+n.fileCss:P=n.fileCss+h.fileCss,g.match(S.default("style"),_=>(p==="global"?_.content=[y+w]:_.content=[w+y],w="",y="",_.attrs=_.attrs||{},_.attrs["data-to"]=v,_.attrs["data-scoped-hash"]=I,_.attrs["data-resolve-id"]=e.resolveId,delete _.attrs.scoped,delete _.attrs.global,delete _.attrs.src,delete _.attrs.to,delete _.attrs.dynamic,_)),P&&Array.isArray(g)&&g.push({tag:"style",attrs:{"data-to":"file","data-scoped-hash":I,"data-resolve-id":e.resolveId},content:P})}else k={classNames:[],tags:{},assetsCache:new Set};const C=s.prefix("js");if(g.match(S.default("script"),l=>{l.attrs=l.attrs||{};let p=l.attrs.src;return p&&/^(https?:)?\/\//.test(p)?l:l.attrs[C]==="null"||l.attrs[C]==="false"?(delete l.attrs[C],l):p&&l.attrs.type&&l.attrs.type==="module"?(l.attrs.src=s.join(e.src,p),l.attrs.src=s.slash(l.attrs.src,!0),l):(l.attrs.type&&l.attrs[C]==null||(p&&(p=s.join(e.src,p),l.attrs.src=s.slash(p,!0)),l.attrs["data-to"]=l.attrs.to,l.attrs["data-scoped-hash"]=I,l.attrs["data-resolve-id"]=e.resolveId,delete l.attrs.to),l)}),g.walk(l=>{if(typeof l=="string")return l;l.attrs=l.attrs||{};const p=k;if(p&&I&&l.tag){const v=l.attrs,D=v.class||"",c=f=>{i&&i.length&&(f={},i.forEach(b=>{f[b]=v[b]}));for(const b in f)if(Object.prototype.hasOwnProperty.call(f,b)){const j=f[b]||"";if(p.classNames.some(n=>j.includes(n)))return!0}return!1};(p.tags[l.tag]||c(v))&&!D.includes(I)&&(l.attrs.class=`${I} ${D}`.trim())}Object.keys(l.attrs).forEach(v=>{!o.attributes.includes(v)&&o.attrRegExp.test(v)&&o.attributes.push(v)});const w=typeof o._include=="function"&&o._include,y=v=>{if(!String(v).trim()||w&&!w(v)||jt(v)||Et(v)||v.startsWith("#")||K(v))return v;let D=s.join(e.src,v);return D=s.slash(D,!0),k&&k.assetsCache.add(D),D};return o.attributes.forEach(v=>{if(l.attrs[v]){const D=l.attrs[v];let c;const f=D.replace(/('|")(.*?)('|")/g,(b,j,n,h)=>(c=!0,`${j}${y(n)}${h}`));l.attrs[v]=c?f:y(D)}}),l}),E.length>0&&(await Promise.all(E),E.length=0),s.mode!=="development"&&k&&k.assetsCache.size){const l={tag:"div",attrs:{__posthtml_view_assets_div__:!0,style:"display:none;"},content:[]};k.assetsCache.forEach(p=>{Xe(p)?l.content.push({tag:"link",attrs:{rel:"preload",as:"font",href:p,"data-raw-url":p}}):l.content.push({tag:"img",attrs:{src:p,"data-raw-url":p}})}),l.content.length&&Array.isArray(g)&&g.push(l),k.assetsCache.clear()}return g}}function xs(t,e){t={...t},t.to=e.to||t.to||"head";let s=t.type;return e.scoped!=null?s="scoped":e.global!=null&&(s="global"),t.type=s||"scoped",t}function $s(t,e){return t.source!=null?Promise.resolve(t.source||""):Y.default.readFile(t.src,e)}function js(t,e,s,r){const a=r.prefix("query");return(t[a]||"")==="global"?r.components[e]:s[e]||r.components[e]}function Es(t,{from:e,prefix:s,join:r,slash:a}){const i={};return t.match(S.default(s("components")),o=>(o.content&&o.content.forEach(u=>{if(typeof u=="string")return;let{src:d,...m}=u.attrs||{};u.tag&&d&&(d=r(e,d),i[u.tag]={tag:u.tag,src:d,resolveId:a(d),locals:m})}),o.tag=!1,delete o.content,o)),t.match(S.default(s("component")),o=>{const u=o.attrs||{};let d=!1;if(u.src){const m="view-src-"+Ye(u.src),g=r(e,u.src);i[m]={tag:m,src:g,resolveId:a(g),locals:{}},o.tag=m,delete u.src}else d=!0;return d&&(o.tag=!1,delete o.content),o}),i}function et(t){return[].concat(t||"").join("").trim()}function st(...t){return[].concat(...t).filter(Boolean)}function Ut(t){const e={...t||{}};return e.root=e.root||process.cwd(),e.mode=e.mode||"development",e.encoding=e.encoding||"utf8",e.viewPrefix=e.viewPrefix||"view:",e.from=e.from||"",e.plugins=e.plugins||[],e.parser=e.parser||{},e.locals=e.locals||{},e.$attrs=e.$attrs||"$attrs",e.stylePreprocessor=e.stylePreprocessor||(s=>({code:s})),e.js={type:"ts",...e.js},e.assets={...e.assets},e.assets.attributes=e.assets.attributes||["data-src","data-img"],e.assets.attrRegExp=e.assets.attrRegExp||St,e.styled={type:"scoped",to:"head",prefix:"view-",...e.styled},typeof e.getOptions=="function"&&e.getOptions(e),e.join=(s,r)=>Ve(e.root,e.from,s,r),e.slash=(s,r)=>We(e.root,s,r),e.prefix=s=>`${e.viewPrefix}${s}`,e.rtl=e.rtl||!1,e.cssjanus=s=>e.rtl&&e.mode==="development"?ct(s,{transformEdgeInUrl:e.rtl.transformEdgeInUrl,transformDirInUrl:e.rtl.transformDirInUrl}):s,e.noflip=s=>e.rtl?kt(s):s,async function(r){e.components=await is(e);const a=await vs(e)(r);return await Tt(e.parser,e.plugins,a)}}const Gt=/\.(css|scss|less|sass|styl|stylus|pcss|postcss)$/;function Lt(t){const e=Gt.test(t);return Gt.lastIndex=0,e}function Ps(t,e){t.build=t.build||{},t.build.rollupOptions=t.build.rollupOptions||{},t.build.ssr=!1;const{input:s,pages:r}=Is(t.root||process.cwd(),e);return t.build.rollupOptions.input=s,t.server=t.server||{},t.server.open===!0&&(t.server.open=r[0]&&`/${r[0].route||""}`||"/"),t}function Cs(t){const e=[];return Jt(t).forEach(r=>{const a=`./${r.path}`;r.pageName==="index"&&e.push({from:/^\/$/,to:a}),e.push({from:new RegExp(`^/${r.route}/*`),to:a}),e.push({from:new RegExp(`^/${r.route}$`),to:a})}),e}function Is(t,e){const s=Jt(e),r={};return s.forEach(a=>{r[a.pageName]=N.default.resolve(t,a.path)}),{input:r,pages:s}}function Jt({pagesDirectory:t,includes:e,ignore:s}){return e=e.filter(Boolean).map(r=>r[0]==="/"?r:"/"+r),Ae.default.sync(`${t}/**/*.html`.replace("//","/"),{objectMode:!0,ignore:s.map(r=>(r.includes(".")?r:`**/${r}/**`).replace("//","/"))}).filter(r=>e.some(a=>r.path.includes(a))?!0:!r.path.includes("/_")).map(({name:r,path:a})=>{const i={filename:r,path:a,route:"",pageName:""};return i.route=a.replace(`${t}/`,""),i.pageName=i.route.replace(/(\/index)?\.html/,"").replace("/","-"),i})}const zt="0123456789abcdef",Qt={"=":"\\:",php:"\\#","\\:":"=","\\#":"php",":":"=","#":"php"},Yt=/\\{\\@(\\:|\\#)(.*?)\\@\\}/gs,ks=/{@(:|#)(.*?)@}/gs,Ss=/<\?(=|php)(.*?)\?>/gs,As=/(\\@\\})=""/g;function Zt(t){const e=function(s,r,a){return`<?${Qt[r]||r}${a}?>`};return t.replace(Yt,e).replace(ks,e)}function Xt(t){return t.replace(Ss,function(e,s,r){return`\\{\\@${Qt[s]||s}${Rs(r,zt)}\\@\\}`})}function Kt(t){return t.replace(As,"$1").replace(Yt,function(e,s,r){return`\\{\\@${s}${Ds(r,zt)}\\@\\}`})}function Rs(t,e){const s=F.createCipheriv("aes128",e,e);let r=s.update(t,"utf8","hex");return r+=s.final("hex"),r}function Ds(t,e){const s=F.createDecipheriv("aes128",e,e);let r=s.update(t,"hex","utf8");return r+=s.final("utf8"),r}async function Ts(t,e,s=!0){let r=null;if(Re.default.test("-f",t))try{let a=null;(o=>{s&&require&&require.cache&&!!require.cache[o]&&delete require.cache[o]})(t),a=require(t),a&&(a=a.__esModule?a.default:a,typeof a=="function"?r=a(e):r=a)}catch(a){console.error(a)}return r||{}}const te=new Map;async function Hs(t,e,s,r){const a=N.default.join(s,".php-dev",r);return te.get(r)!==t&&(te.set(r,t),await Y.default.outputFile(N.default.resolve(e,a),t,"utf8")),{tplFileName:a,__views:""}}async function Ns(t,e,s){const{__views:r,...a}=s,i=a;i._TEMPLATE=t,i._REGISTER_GLOBAL_MODEL=!0,i._VIEWS_PATH=r;const o=JSON.stringify(i,De.default()),{stdout:u}=await Te.default("php",e&&e.length?e:[N.default.join(__dirname,"/loader.php")],{input:o});return u}const ot={caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!0,collapseWhitespace:!0,conservativeCollapse:!1,html5:!0,minifyCSS:!0,minifyJS:!0,minifyURLs:!0,noNewlinesBeforeTagClose:!0,removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!1,useShortDoctype:!0};let ut;async function rt(t,e){return typeof e.minifyHtml=="function"&&(e.minifyHtml=e.minifyHtml(ot)),e.minifyHtml&&(ut=ut||(e.minifyHtml===!0?ot:{...ot,...e.minifyHtml,removeTagWhitespace:!1}),t=await je.minify(t,ut),typeof e.minifyHtmlAfter=="function"?t=e.minifyHtmlAfter(t):t=t.replace(/>(\s+)</g,"><")),t}function ft(t){return t.split("?__posthtml_view__=")[0]}const Os=(t,e,s,r,a)=>{function i(d){const m=N.default.resolve(t.root,e.pagesDirectory);return N.default.relative(m,d)}const o=t.command==="serve",u='<div style="text-align:center;"><h1>posthtml-view</h1><p>No content</p></div>';return async(d,m)=>{const g=i(m.filename);e.php&&(d=Xt(d));const E=L.default([Ut({...e,from:m.filename,htmlProcessor($){return Xt($)},styled:{...e.styled,extract:$=>{const I=ft($.mainjs),k=`${s}/${$.resolveId.replace(".html",".css")}`,C=`import '${k}';`;a.set(k,$.source||"");const l=r.get(I)||"";l.includes(k)||r.set(I,l+C)}},js:{...e.js,extract:$=>{const I=ft($.mainjs);if($.src){const k=r.get(I)||"",C=`import '${$.src}';`;k.includes($.src)||r.set(I,k+C)}else{const k=`${s}/${$.resolveId.replace(".html","")}`,C=`import '${k}';`;a.set(k,$.source||"");const l=r.get(I)||"";l.includes(k)||r.set(I,l+C)}}}}),...e.plugins||[]]);if(typeof e.usePlugins=="function"&&e.usePlugins(E),d=(await E.process(d,{directives:[{name:"!DOCTYPE",start:"<",end:">"},{name:"?php",start:"<",end:">"},{name:"?=",start:"<",end:">"}],...e.parser,sync:!1})).html.trim(),o)if(e.php){if(d=Kt(d),e.devMinifyHtml&&(d=await rt(d,e)),d=Zt(d),typeof e.php.devRender=="function")d=await e.php.devRender({html:d,options:e});else{const $=N.default.join(t.root,e.mocksDirectory,g.replace(".html",".js"));typeof e.php.writeTemplateBefore=="function"&&(d=e.php.writeTemplateBefore(d)||d);const[I,{tplFileName:k,__views:C}]=await Promise.all([Ts($,m.originalUrl||"",!0),Hs(d,t.root,e.cacheDirectory,g)]);d=await Ns(k,e.php.args,{__views:C,...I})}return d||u}else e.devMinifyHtml&&(d=await rt(d,e));return d}};let M,pt,ht,W;const T={classesKey:"_classes",idsKey:"_ids",_classes:{},_ids:{},classes:{},ids:{}},J={},z={};function ee(t,e){try{const s=JSON.parse(W.getItem(t)||"{}")||{};return Object.keys(s).forEach(r=>{const a=s[r];e[a]=null}),s}catch{return{}}}async function qs(){if(W){const t={},e={};Object.keys(T.classes).sort().forEach(s=>{t[s]=T.classes[s]}),Object.keys(T.ids).sort().forEach(s=>{e[s]=T.ids[s]}),W.setItem(T.classesKey,JSON.stringify(t,null,2)),W.setItem(T.idsKey,JSON.stringify(e,null,2))}}function Ms(t){M=M||t,M.__cache_file__&&!W&&(W=new Pe.LocalStorage(M.__cache_file__),T._classes=ee(T.classesKey,J),T._ids=ee(T.idsKey,z)),pt=pt||nt(M.generateNameFilters,M.upperCase,e=>J[e]!==null),ht=ht||nt(M.generateNameFilters,M.upperCase,e=>z[e]!==null)}function se(t){const e=wt.default(t);function s(r){r.forEach(a=>{if(a.type==="atrule"&&(a.name==="media"||a.name==="supports"))s(a.nodes);else switch(a.type){case"rule":a.selector=Bs(a.selector);break}})}return s(e.nodes),e.toString()}function Bs(t){return bt.default(e=>{e.walkClasses(s=>{if(U(s.value,!1,!1))return;let r=s.value,a=!1;const i=r.replace(X,o=>(a=!0,` ${o} `));if(a){r=i.split(/\s+/).map(o=>{if(!o)return"";if(U(o,!1))return o;const u=mt(o);return G(u)||o}).filter(Boolean).join("").trim(),r=Pt(r),s.setPropertyWithoutEscape("value",r);return}s.setPropertyWithoutEscape("value",G(mt(r))||r)}),e.walkIds(s=>{U(s.value,!0)||(s.value=G(dt(s.value))||s.value)})}).processSync(t)}function mt(t){const e=T._classes[t];if(e)return J[e]=null,T.classes[t]=e,delete T._classes[t],e;const s=T.classes[t];if(s)return J[s]=null,s;const r=pt.next().value;return J[r]=null,T.classes[t]=r,r}function dt(t){const e=T._ids[t];if(e)return z[e]=null,T.ids[t]=e,delete T._ids[t],e;const s=T.ids[t];if(s)return z[s]=null,s;const r=ht.next().value;return z[r]=null,T.ids[t]=r,r}function U(t,e,s){return s!==!1&&At(t)?!0:(t=(e?"#":".")+t,M.filters.some(r=>typeof r=="string"?r===t:r.test(t)))}function G(t){return t&&M.prefix+t}function Fs(t){if(U(t,!0))return;const e=dt(t);if(e)return G(e)}function re(t){if(t=t.slice(1),U(t,!0))return;const e=T.ids[t];if(e)return"#"+G(e)}const Vs=/\\?@\\?}(.*?)\\?{\\?@/gs,Ws=/\s+(\\?{\\?@)/g;function Q(t,e,s){return t&&(e||(t=t.replace(X,r=>` ${r} `)),t=t.split(/\s+/).map(r=>{if(!r)return"";if(U(r,e)||typeof s=="function"&&s(r))return r;const a=e?dt(r):mt(r);return G(a)||r}).filter(Boolean).join(" ").trim(),e||(t=t.replace(Vs,(r,a)=>a?r.replace(a,` ${a.trim()} `):r).replace(Ws,"$1")),t)}const ae="[[rtl]]",ne="[[ltr]]",gt={type:"syntax",syntax:`<?php if($rtl): ?>${ae}<?php else: ?>${ne}<?php endif; ?>`,devPreview:t=>!!(t&&(t.includes("rtl=1")||t.includes("lang=ar")))},ce={enableCache:!0,generateNameFilters:[],upperCase:!0,filters:[/^(\.|#)js-/],attributes:[],blurryAttrs:[],prefix:"",__cache_file__:""};let H;function Us(t){return typeof t.rtl=="boolean"?t.rtl?gt:!1:{...gt,...t.rtl}}const Gs=/(.*)\[\[(rtl|ltr)\]\](.*)\[\[(rtl|ltr)\]\](.*)/si;function Ls(t,e){const s=Ee.createFilter(["**/*.html"]);let r,a=t.preloadCss!==!1;const{type:i,syntax:o}=e||gt,u=C=>ct(C,{transformDirInUrl:e&&e.transformDirInUrl||!1,transformEdgeInUrl:e&&e.transformEdgeInUrl||!1}),d=()=>o&&(o.includes(ae)||o.includes(ne));let m=null;if(e&&i==="syntax"&&d()){const C=o.match(Gs);C&&C.length>=6&&(m=C.slice(1).map(l=>l.trim()).filter(Boolean))}const g=["crossorigin","nomodule","defer","async","hidden","x-transition","x-ignore","x-cloak","x-collapse",...t.boolAttrs||[]],E=[],$=[];function I(C){C.walk(l=>(l.attrs&&Object.keys(l.attrs).forEach(w=>{l.attrs[w]===""&&g.some(y=>y.indexOf(w)===0)&&(l.attrs[w]=!0)}),l))}const k=async C=>(await L.default([]).use(l=>{let p=!1;return l.match(S.default("body"),w=>(p=!0,w)),p||l.match(S.default('script[type="module"],script[nomodule]'),w=>(w.tag=!1,delete w.content,w)),l.match(S.default("head"),w=>{const y=[];l.match.call(w,S.default('link[rel="stylesheet"][href]'),f=>{const b=f.attrs||{};return f.tag&&b.href&&E.some(j=>b.href&&b.href.includes(j))&&(a&&y.push({tag:"link",attrs:{...b,rel:"preload",as:"style",href:b.href}}),y.push({tag:"link",attrs:b}),f.tag=!1),f}),l.match.call(w,S.default('script[type="module"][src],link[rel="modulepreload"][href]'),f=>{const b=f.attrs||{},j=b.href||b.src;return f.tag&&j&&$.some(n=>j.includes(n))&&(y.push({tag:f.tag,attrs:b}),f.tag=!1),f});const v=[];l.match.call(w,S.default('link[rel="preload"][as="image"][href]'),f=>{const b=f.attrs||{};return f.tag&&b.href&&(v.push({tag:"link",attrs:b}),f.tag=!1),f});const D=[];l.match.call(w,S.default("style[__posthtml_view_css__]"),f=>{const b=at(f.content);return f.tag&&b&&!D.includes(b)&&D.push(b),f.tag=!1,delete f.content,f});const c=D.map(f=>({tag:"style",content:f}));return l.match.call(w,S.default('meta[property="posthtml:view-head-placeholder"]'),f=>(f.content=[...y,...v,...c],f.tag=!1,f)),w}),H&&l.match(S.default("style"),w=>{if(w.attrs&&w.attrs["data-min-class-ignore"]!=null)return delete w.attrs["data-min-class-ignore"],w;const y=at(w.content);return y&&(w.content=[se(y)]),w}),l}).use(l=>{const p=new Map,w=c=>(c&&p.size&&p.forEach((f,b)=>{c=le(c,b,f)}),c);l.match(S.default("div[__posthtml_view_assets_div__]"),c=>(l.match.call(c,S.default("[data-raw-url]"),f=>(f.attrs&&f.attrs["data-raw-url"]&&p.set(f.attrs["data-raw-url"],f.attrs.href||f.attrs.src||""),f.tag=!1,f)),c.tag=!1,delete c.content,c));const y=t.assets.attributes,v=t.assets.attrRegExp;l.walk(c=>{if(typeof c=="string")return c;if(c.attrs){const f=Object.keys(c.attrs);f.forEach(j=>{!y.includes(j)&&v.test(j)&&y.push(j)}),y&&y.forEach(j=>{c.attrs[j]&&(c.attrs[j]=w(c.attrs[j]))}),c.attrs.style&&(c.attrs.style=w(c.attrs.style));const b=(c.attrs["view-build-class"]||"").split(" ").filter(Boolean);if(delete c.attrs["view-build-class"],H){const j=[...H.attributes,/^[xv]-transition/],n=[...H.blurryAttrs,/^([xv]-bind)?:class/],h=(x,A)=>x.some(O=>typeof O=="string"?O===A:O.test&&O.test(A)),P=x=>r.assetsInclude(x)?!0:b.length?!b.includes(x):!1;if(f.forEach(x=>{if(!(x==="id"||x==="class")&&typeof c.attrs[x]=="string"&&!(typeof c.attrs[x]=="string"&&!c.attrs[x].trim()))if(h(j,x))c.attrs[x]=Q(c.attrs[x],!1,P);else if(h(n,x)){const A=c.attrs[x]||"";let O;const _t=A.replace(/('|")(.*?)('|")/g,(ie,Qs,Ys,Zs)=>(O=!0,`${Qs}${Q(Ys,!1,P)}${Zs}`));c.attrs[x]=O?_t:A}else b.length&&b.forEach(A=>{if(c.attrs[x].includes(A)){const O=Q(A);c.attrs[x]=le(c.attrs[x],A,O)}})}),c.attrs.class&&(c.attrs.class=Q(c.attrs.class)),c.attrs.id&&(c.attrs.id=Q(c.attrs.id,!0)),c.attrs.for){const x=Fs(c.attrs.for);x&&(c.attrs.for=x)}if(["mask","fill","filter"].forEach(x=>{if(c.attrs[x]){const A=re(c.attrs[x].replace(/url\((.*?)\)/g,"$1"));A&&(c.attrs[x]=`url(${A})`)}}),c.tag==="use"&&(c.attrs.href||c.attrs["xlink:href"])){const x=c.attrs.href?"href":"xlink:href",A=re(c.attrs[x]||"");A&&(c.attrs[x]=A)}}}return c});const D="posthtml-view-syntax-style-x";return l.match(S.default("style"),c=>{let f=w(at(c.content)),b=f&&lt(f,"");if(b&&m&&m.length){const j=u(f);if(j!==b)return c.content=m.map(n=>n==="rtl"?{tag:D,attrs:c.attrs,content:j}:n==="ltr"?{tag:D,attrs:c.attrs,content:b}:n),c.tag=!1,c.attrs=void 0,c}return b&&(c.content=[b]),c}),m&&m.length?(l.match(S.default("link[href]"),c=>{const f=c.attrs&&c.attrs.href;if(c.attrs&&f&&f.endsWith(".css")&&m){const b=f.replace(".css",".rtl.css");c.attrs.href=m.map(j=>j==="rtl"?b:j==="ltr"?f:j).join("")}return c}),l.match(S.default("html"),c=>(m&&(c.attrs=c.attrs||{},c.attrs.dir=m.map(f=>f==="rtl"?"rtl":f==="ltr"?"ltr":f).join("")),c))):l.match(S.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir="ltr",c)),Promise.resolve().then(()=>(l.match(S.default(D),c=>(c.tag="style",c)),l))}).use(l=>Promise.resolve().then(()=>{let p;return typeof t.generateUsePlugins=="function"&&(p=t.generateUsePlugins(l)),I(p||l)})).process(C,{})).html;return{name:"view:posthtml-view-bundle",enforce:"post",apply:"build",configResolved(C){r=C},async generateBundle(C,l){const p=t.minifyClassnames;p&&!H&&(H=p===!0?ce:{...ce,...p},H.prefix=H.prefix&&Z(H.prefix),H.filters=[...H.filters,"#vite-legacy-polyfill","#vite-legacy-entry"],H.enableCache?H.__cache_file__=N.default.join(r.root,N.default.join(t.cacheDirectory,"css")):H.__cache_file__="",Ms(H));const w=Object.values(l);for(const y of w)if(y.fileName.endsWith(".js")&&!$.includes(y.fileName)&&$.push(y.fileName),y.type==="asset"&&y.fileName.endsWith(".css")){!E.includes(y.fileName)&&E.push(y.fileName);let v=yt(y.source);H&&(v=se(v)),y.source=lt(v,""),e&&this.emitFile({type:"asset",fileName:y.fileName.replace(".css",".rtl.css"),name:y.name?y.name.replace(".css",".rtl.css"):void 0,source:u(v)})}for(const y of w){if(y.type==="asset"&&s(y.fileName)){let v=yt(y.source);v=await k(v),t.php&&(v=Kt(v)),v=await rt(v,t),t.php&&(v=Zt(v)),y.source=v;const{fileName:D,name:c}=Js(y.fileName,y.name,t);if(y.fileName=D,y.name=c,e&&i==="new-html"){let f=(await L.default([]).use(b=>(b.match(S.default("html"),j=>(j.attrs=j.attrs||{},j.attrs.dir="rtl",j)),b.match(S.default("link[href]"),j=>(j.attrs&&j.attrs.href&&j.attrs.href.endsWith(".css")&&(j.attrs.href=j.attrs.href.replace(".css",".rtl.css")),j)),b.match(S.default("style"),j=>{const n=at(j.content);return n&&(j.content=[u(n)]),j}),I(b))).process(v,{})).html;f&&(f=await rt(f,t),this.emitFile({type:"asset",fileName:D.replace(/\.(html?|php)/g,".rtl.$1"),name:c?c.replace(/\.(html?|php)/g,".rtl.$1"):void 0,source:f}))}}if(y.type==="chunk"&&y.fileName.includes("-legacy")&&typeof t.removeCssInJs=="function"){const v=t.removeCssInJs(yt(y.code));y.code=v||y.code}}await qs()}}}function Js(t,e,s){const{buildPagesDirectory:r,pagesDirectory:a,php:i}=s;if(r!==a){const o=t.indexOf(a);o>=0&&(t=r+t.slice(o+a.length))}return i&&i.rename&&(t=t.replace(/\.(html?)/g,".php"),e&&(e=e.replace(/\.(html?)/g,".php"))),{fileName:t,name:e}}function yt(t){return t instanceof Uint8Array?Buffer.from(t).toString("utf-8"):t}function le(t,e,s){for(;t.includes(e);)t=t.replace(e,s);return t}function at(...t){return[].concat(...t).filter(Boolean).join("").trim()}function zs(t){const e=vt.merge({includes:[],ignore:[],pagesDirectory:"pages",mocksDirectory:"mocks",buildPagesDirectory:"pages",cacheDirectory:".posthtml-view-cache",usePlugins:null,rtl:!1,minifyHtml:!0,devMinifyHtml:!1,minifyClassnames:!1,preloadCss:!0},t||{});e.pagesDirectory=e.pagesDirectory||"pages",e.buildPagesDirectory=e.buildPagesDirectory||e.pagesDirectory,e.cacheDirectory=e.cacheDirectory||".posthtml-view-cache",e.getOptions=d=>{e.styled=d.styled,e.assets=d.assets};const s=new Map,r=new Map,a="virtual:posthtml-view",i=Us(e),o=()=>{const d="view:posthtml-view-pages";let m;return{name:d,enforce:"pre",config(g,{mode:E}){Ps(g,e)},configResolved(g){m=g,e.root=m.root,e.assets=e.assets||{},e.assets._include=m.assetsInclude,e.mode=m.command==="build"?"production":"development"},transformIndexHtml:{enforce:"pre",async transform(g,E){return m.command==="serve"?i&&typeof i.devPreview=="function"&&i.devPreview(E.originalUrl)?e.rtl=i:e.rtl=!1:e.rtl=i,await Os(m,e,a,s,r)(g,E)}},async resolveId(g,E){return g===a||/\?__posthtml_view__=(0|1)/g.test(g)||g.startsWith(a)?g:null},async load(g){if(g===a)return"";if(/\?__posthtml_view__=(0|1)/g.test(g)){const E=ft(g),$=g.includes("__posthtml_view__=1");let I="";return $||(I=I+`import '${E.replace(/\.(t|j)s/g,"")}';`),I=I+(s.get(E)||""),I}return g.startsWith(a)?r.get(g)||"":null},async transform(g,E){return m.command==="build"&&i&&Lt(E)?kt(g):null}}};return[(()=>({name:"view:posthtml-view-dev",enforce:"pre",apply:"serve",configureServer(d){d.middlewares.use(Se.default({verbose:Boolean({}.DEBUG)&&{}.DEBUG!=="false",disableDotRule:void 0,htmlAcceptHeaders:["text/html","application/xhtml+xml"],rewrites:Cs(e)}))},async transform(d,m){return i&&e.rtl&&Lt(m)?ct(d,{transformDirInUrl:i.transformDirInUrl||!1,transformEdgeInUrl:i.transformEdgeInUrl||!1}):null},async handleHotUpdate({file:d,server:m}){return(d.includes("/"+e.mocksDirectory)||d.includes(".html"))&&m.ws.send({type:"full-reload",path:"*"}),[]}}))(),o(),Ls(e,i)]}R.compilerViewPlugin=Ut,R.generateName=nt,R.slugify=$t,R.toValidCSSIdentifier=Z,R.vitePluginPosthtmlView=zs,Object.defineProperty(R,"__esModule",{value:!0}),R[Symbol.toStringTag]="Module"});

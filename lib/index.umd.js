(function(R,B){typeof exports=="object"&&typeof module!="undefined"?B(exports,require("crypto"),require("path"),require("posthtml"),require("posthtml-expressions"),require("posthtml-match-helper"),require("posthtml-render"),require("lodash"),require("fs-extra"),require("postcss"),require("postcss-load-config"),require("postcss-safe-parser"),require("postcss-selector-parser"),require("connect-history-api-fallback"),require("fast-glob"),require("shelljs"),require("circular"),require("execa"),require("html-minifier-terser"),require("@rollup/pluginutils"),require("node-localstorage")):typeof define=="function"&&define.amd?define(["exports","crypto","path","posthtml","posthtml-expressions","posthtml-match-helper","posthtml-render","lodash","fs-extra","postcss","postcss-load-config","postcss-safe-parser","postcss-selector-parser","connect-history-api-fallback","fast-glob","shelljs","circular","execa","html-minifier-terser","@rollup/pluginutils","node-localstorage"],B):(R=typeof globalThis!="undefined"?globalThis:R||self,B(R.posthtmlView={},R.crypto,R.path,R.posthtml,R.expressions,R.match,R.posthtmlRender,R.lodash,R.fse,R.postcss,R.postcssrc,R.postcssSafeParser,R.postcssSelectorParser,R.history,R.fg,R.shell,R.circular,R.execa,R.htmlMinifierTerser,R.pluginutils,R.nodeLocalstorage))})(this,function(R,B,oe,ue,fe,pe,he,vt,me,de,ge,ye,_e,ve,we,be,$e,xe,je,Ce,Ee){"use strict";function N(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var q=N(oe),L=N(ue),Pe=N(fe),k=N(pe),Z=N(me),Ie=N(de),ke=N(ge),wt=N(ye),bt=N(_e),Se=N(ve),Ae=N(we),$t=N(be),Re=N($e),De=N(xe);function He(t,e=0){const s=1540483477,r=24;let n=t.length,i=e^n,o=0;for(;n>=4;){let f=Te(t,o);f=F(f,s),f^=f>>>r,f=F(f,s),i=F(i,s),i^=f,o+=4,n-=4}switch(n){case 3:i^=xt(t,o),i^=t.charCodeAt(o+2)<<16,i=F(i,s);break;case 2:i^=xt(t,o),i=F(i,s);break;case 1:i^=t.charCodeAt(o),i=F(i,s);break}return i^=i>>>13,i=F(i,s),i^=i>>>15,i>>>0}function Te(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function xt(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function F(t,e){t|=0,e|=0;const s=t&65535,r=t>>>16;return s*e+((r*e&65535)<<16)|0}function jt(t){return He(t).toString(36)}const qe=/[^-_a-z0-9\u00A0-\uFFFF]/gi,Ne=/^\d/;function X(t,e){return t&&t.replace(qe,e||"_").replace(Ne,e||"_")}const Me=/^(https?:)?\/\//,Ct=t=>Me.test(t),Oe=/^\s*data:/i,Et=t=>Oe.test(t),Fe=/({|%|:|})/g;function Pt(t){return t.replace(Fe,"\\$1")}function*at(t=[],e=!0,s){s=s||(g=>!0);let r="abcdefghijklmnopqrstuvwxyz";e&&(r=r+r.toUpperCase());const i=r+"0123456789",o=r.length,f=i.length;t=[...t||[],/ad/i];let h=0,m=0;for(;;){let g=o,x="";do x=x+i.charAt(m%g),m=~~(m/g),g=f;while(m>0);!t.some(w=>w.test(x))&&s(x)&&(yield x),h++,m=h}}function Ve(t,e,s,r){return q.default.join(q.default.isAbsolute(r)?t:q.default.dirname(s||e),r)}function Be(t,e,s){return e=We(q.default.normalize(q.default.relative(t,e))),s?e[0]==="/"?e:`/${e}`:e}function We(t){const e=/^\\\\\?\\/.test(t),s=/[^\u0000-\u0080]+/.test(t);return e||s?t:t.replace(/\\/g,"/")}const Ge=require("cssjanus"),It=new Map,kt=/\/\*(.*?)\*\//gs,Ue=/--noflip-rtl-placeholder-\d+:\s*1;?/g,Le=/{(.*?)}/gs;function nt(t,e){const s=It.get(t);if(s)return s;let r=ct(t);return r=Ge.transform(r,{transformDirInUrl:!1,transformEdgeInUrl:!1,...e}),r=r.replace(kt,""),It.set(t,r),r}function St(t){return t.replace(Le,e=>{let s=-1;return e.replace(kt,r=>r.includes("@noflip")?(s=s+1,`--noflip-rtl-placeholder-${s}:1;`):r)})}function ct(t,e){return t.replace(Ue,e===""?e:"/* @noflip */")}const At=/^(?:x-|v-|:|@)/,Je=/\B([A-Z])/g;function ze(t){return(t||"").replace(Je,"-$1").toLowerCase()}function Qe(t){let e=t.replace(".html","-html").replace(/\.|_/g,"").split("/").map(s=>ze(s)).filter(Boolean);return X(e.join("-"),"-")}const K=/\\?{\\?%(\\?:|\\?#)(.*?)\\?%\\?}/gs;function tt(t){const e=!!(t&&K.test(t));return K.lastIndex=0,e}function Rt(t){return tt(t)}const Ye=/\.(ttf|eot|woff|woff2)$/;function Ze(t){return t=t.split("#")[0],t=t.split("?")[0],Ye.test(t)}const Xe=/\/\*(.*?)\*\//gs;function Ke(t){return t=t&&t.replace(Xe,e=>tt(e)?"":e),tt(t)}function ts(t){return t&&t.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function Dt(t,e=!0){return t=t.replace(/ ?[\n\r]+ ?/g,"").replace(/\s{2,}/g,e?" ":""),ts(t).replace(/\s*;\s*/g,";")}const es=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","menu","menuitem","meta","meter","nav","nobr","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"],ss=["a","animate","animateMotion","animateTransform","circle","clipPath","color-profile","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","hatch","hatchpath","image","line","linearGradient","marker","mask","mesh","meshgradient","meshpatch","meshrow","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","solidcolor","stop","style","svg","switch","symbol","text","textPath","title","tspan","unknown","use","view"];function rs(t,e,s){return function(r){const n=t.content||[],i={};n.length&&r.match.call(n,k.default("template"),f=>(!f.attrs||!f.attrs.slot||(i[f.attrs.slot]=f),f));const o=r.match(k.default("slot"),f=>{const h=f.attrs&&f.attrs.name||"";if(!h)return Ht(f.content,n.filter(g=>!(g.tag==="template"&&g.attrs&&g.attrs.slot)));const m=i[h];return m?Ht(f.content,m.content,as(m)):f.content||[]});return t.tag=!1,t.content=o,r}}function Ht(t,e,s){switch(t=Array.isArray(t)?t:[t||""],e=Array.isArray(e)?e:[e||""],s){case"replace":t=e;break;case"prepend":t=[...e,...t];break;case"append":t=[...t,...e];break;default:t=e.filter(Boolean).length===0?t:e;break}return t}function as(t){let e=t.attrs&&t.attrs.type||"";return["replace","prepend","append"].includes(e)||(e="replace"),e}function Tt(t,e,s,r){return L.default((r||[]).concat(e)).process(he.render(s),t).then(n=>n.tree)}function ns(t,e,s,r){const n={};Object.entries(e||{}).forEach(([f,h])=>{n[f]=cs(h)});const i={MODE:s.mode,DEV:s.mode==="development",PROD:s.mode==="production",PAGE:s.slash(s.from,!0)},o={[s.$attrs]:vt.merge({},s.locals,t.locals,n,{env:i})};return Pe.default({locals:o})}function cs(t){try{return new Function(`return ${t}`)()}catch{return t}}let lt;async function ls({registerComponentsFile:t,root:e,mode:s,encoding:r,prefix:n,join:i,slash:o}){if(lt)return lt;if(!t)return{};const f={},h=i(e,t),m=await Z.default.readFile(h,r);function g(x){x.match(k.default(n("components")),w=>(w.content&&w.content.forEach(E=>{if(typeof E=="string")return;let{src:j,...C}=E.attrs||{};E.tag&&j&&(j=i(h,j),f[E.tag]={tag:E.tag,src:j,resolveId:o(j),locals:C})}),w))}return await L.default([]).use(g).process(m,{}),s!=="development"&&(lt=f),f}const is=/^(-\w+-)?animation-name$/,os=/^(-\w+-)?animation$/,us=/-?keyframes$/,qt=/(?<=^|[^\w\-\u0080-\uffff])url\(\s*('[^']+'|"[^"]+"|[^'")]+)\s*\)/,Nt=/image-set\(([^)]+)\)/;function it(t,e,s,r,n,i,o){const f=wt.default(t,{from:r}),h={classNames:[],tags:{},assetsCache:new Set},m=Object.create(null);let g=!1,x="";if(!o){let w=function(l){l.forEach(u=>{if(u.type==="atrule"&&(u.name==="media"||u.name==="supports"))w(u.nodes);else switch(u.type){case"rule":if([n,i].includes(u.selector+"{}"))return;gs(u.nodes),u.selector=Vt(ds(u.selector,x,h));break;case"atrule":if(us.test(u.name))if(u.params.startsWith(":global"))u.params=Vt(u.params);else{const y=`_${C}`;u.params.endsWith(y)||(g=!0,m[u.params]=u.params=u.params+y)}break}})};const E=l=>l.replace(n,"").replace(i,""),j=s.mode==="production",C=jt(`scoped-${e}:`+(j?E(t||""):""));x=X((s.styled.prefix||"")+C),w(f.nodes)}return f.walkDecls(w=>{g&&(is.test(w.prop)&&(w.value=w.value.split(",").map(C=>m[C.trim()]||C.trim()).join(",")),os.test(w.prop)&&(w.value=w.value.split(",").map(C=>{const l=C.trim().split(/\s+/),u=l.findIndex(P=>m[P]);return u!==-1?(l.splice(u,1,m[l[u]]),l.join(" ")):C}).join(",")));const E=qt.test(w.value),j=Nt.test(w.value);if(E||j){const C=u=>(u=s.join(r,u),u=s.slash(u,!0),h.assetsCache.add(u),u),l=E?fs:ps;w.value=l(w.value,C)}}),{scopedHash:x,scopedClasses:h,css:f.toString()}}function fs(t,e){return Mt(t,qt,s=>{const[r,n]=s;return Ot(n,r,e)})}function ps(t,e){return Mt(t,Nt,s=>{const[r,n]=s;return`image-set(${ms(n,({url:o})=>Ot(o,r,e))})`})}function Mt(t,e,s){let r,n=t,i="";for(;r=e.exec(n);)i+=n.slice(0,r.index),i+=s(r),n=n.slice(r.index+r[0].length);return i+=n,i}function Ot(t,e,s){let r="";const n=t[0];return(n==='"'||n==="'")&&(r=n,t=t.slice(1,-1)),Ct(t)||Et(t)||t.startsWith("#")?e:`url(${r}${s(t)}${r})`}const hs=/( |\\t|\\n|\\f|\\r)+/g;function ms(t,e){const r=t.split(",").map(n=>{const[i,o]=n.replace(hs," ").trim().split(" ",2);return{url:i,descriptor:o}}).filter(({url:n})=>!!n).map(({url:n,descriptor:i})=>({url:e({url:n,descriptor:i}),descriptor:i}));return r.reduce((n,{url:i,descriptor:o},f)=>(o=o||"",n+=i+` ${o}${f===r.length-1?"":", "}`),"")}function ds(t,e,s){return bt.default(r=>{r.walk(n=>{if((n.type==="class"||n.type==="tag")&&!(Ft(n.parent)||Ft(n.parent&&n.parent.parent))){let o=n.value;n.type==="class"&&(Rt(o)&&(o=Pt(o)),s.classNames.includes(o)||s.classNames.push(o)),n.type==="tag"&&(s.tags[o]=!0),n.setPropertyWithoutEscape("value",`${o}.${e}`)}})}).processSync(t)}function gs(t){t.forEach(e=>{e.type==="decl"&&["undefined","null"].includes(e.value)&&(e.remove(),e.cleanRaws())})}function Ft(t){return!!(t&&t.type==="pseudo"&&t.value===":global")}const ys=/:global\((.*?)\)/gs;function Vt(t){return t.replace(ys,"$1")}let V,J;const Bt=()=>{try{V=V||ke.default.sync()}catch{V={file:"",options:{},plugins:[]}}J=J||Ie.default(V.plugins)};function _s(t){function e(s,r){return async function(n){const i=[],o=js(n,s);if(n.walk(f=>{if(typeof f=="string"||!f.tag)return f;const h=f.attrs||{},m=xs(h,f.tag,o,s);if(m){if(es.includes(m.tag))throw new Error(`The component <${m.tag}> is the HTML tag. page file: ${s.from}`);if(ss.includes(m.tag))throw new Error(`The component <${m.tag}> is the SVG tag. page file: ${s.from}`);f.attrs&&delete f.attrs[s.prefix("query")],i.push($s(m,s.encoding).then(ws(f,m,s)).then(g=>{const x={...s,from:m.src};return e(x,!1)(g)}).then(rs(f)))}return f}),r){const f=s.slash(s.from);i.push(Wt(null,{tag:f.replace(/\/|\./g,"-"),src:s.from,resolveId:f,locals:{}},s)(n))}return i.length>0&&(await Promise.all(i),i.length=0),r?await vs(n,s):n}}return e(t,!0)}async function vs(t,e){const{styled:s,js:r,from:n,mode:i,rtl:o}=e,f=i==="development",h="@",m="__posthtml_view_css__";let g="";const x=[];f&&(t.match(k.default("body"),c=>{const p={tag:"div",attrs:{id:m,"data-id":"development_css_container",style:"display: none !important;"}};return c.content=[p,...c.content||[]],c}),t.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir=o?"rtl":"ltr",c)));const w=new Map,E=[],j=new Map,C=[],l=typeof s.extract=="function",u=r.type==="ts"?"ts":"js";t.match(k.default("style"),function(c){const p=et(c.content);c.attrs=c.attrs||{};const b=c.attrs["data-scoped-hash"]||"",S=c.attrs["data-resolve-id"]||"";let $=c.attrs["data-to"]||s.to||"head";if(f&&$!=="*"&&($=`#${m}`),(c.attrs["data-to"]==="file"||$==="file")&&l)p&&!j.has(S)&&(j.set(S,{}),!C.includes(S)&&C.push(S),j.set(S,{to:"file",css:p,scopedHash:b,resolveId:S}));else if(p&&!w.has(S)){if(w.set(S,{}),$==="*")return f||(delete c.attrs["data-to"],delete c.attrs["data-scoped-hash"],delete c.attrs["data-resolve-id"]),c;!E.includes(S)&&E.push(S),w.set(S,{to:$,css:p,scopedHash:b,resolveId:S})}return c.tag=!1,delete c.content,c}),t.match(k.default('script[type="module"]'),c=>{if(!g&&c.attrs&&c.attrs.src){if(/^(https?:)?\/\//.test(c.attrs.src))return c;c.attrs.src=c.attrs.src+"?__posthtml_view__=0",g=c.attrs.src}return c});function P(){return g||(g=e.slash(n,!0).replace(".html","."+u)+"?__posthtml_view__=1",Array.isArray(t)&&t.push({tag:"script",attrs:{type:"module",src:g}}),g)}const y=new Map,_=c=>{r&&typeof r.extract=="function"&&r.extract(c)};t.match(k.default("script[data-resolve-id]"),c=>{c.attrs=c.attrs||{};const p=c.attrs["data-resolve-id"]||"";if(p&&!y.has(p)){y.set(p,null);const b=c.attrs.src||"",S=c.attrs["data-scoped-hash"]||"",$=(b?"":et(c.content))||"";let v=b&&q.default.extname(b).replace(".","")||u;v=v==="ts"?"ts":"js",_({type:v,from:n,resolveId:p,scopedHash:S,source:$,mainjs:P(),src:b.replace(`.${v}`,"")})}return c.tag=!1,delete c.content,c});const A=new Set;Bt(),C.forEach(c=>{const p=j.get(c);if(!!p&&!!p.css){if(f){p.to=`#${m}`,A.add(p.to),t.match(k.default(p.to),b=>{A.delete(p.to);const S={tag:"style",attrs:{"data-to":"file","data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};return b.content?b.content=[S,...b.content]:b.content=[S],b});return}l&&x.push(J.process(p.css,{...V.options,from:n||void 0}).then(b=>{s.extract&&s.extract({type:"css",from:n,mainjs:P(),resolveId:p.resolveId,scopedHash:p.scopedHash,source:b.css})}))}}),E.forEach(c=>{const p=w.get(c);!p||!p.css||(A.add(p.to),t.match(k.default(p.to),b=>{switch(A.delete(p.to),b.tag){case"head":const S=b.content&&b.content.find(v=>!v||typeof v=="string"?!1:v.tag==="style"&&v.attrs&&v.attrs[m]===h);if(S)S.content=st(S.content,p.css);else{const v={tag:"style",attrs:{[m]:h},content:p.css};b.content?b.content=st(b.content,v):b.content=[v]}break;case"style":b.content=st(b.content,p.css);break;default:const $={tag:"style",attrs:{"data-scoped-hash":p.scopedHash,"data-resolve-id":p.resolveId},content:p.css};b.content?b.content=st(b.content,$):b.content=[$];break}return b}))});const a=typeof e.trimAttr=="function"?e.trimAttr:null,d=typeof e.cumbersomeTrim=="function"?e.cumbersomeTrim:null,I=(c,p)=>{if(typeof p=="string"&&p.trim()){if(a)return a(c,p,Dt);if(c==="application/ld+json"||At.test(c))if(p=Dt(p).trim(),p=p.replace(/^{\s+/g,"{").replace(/\s+}$/g,"}"),d)p=d(c,p);else{const b="[<?=@#$%!*&^@?>]";let S=[],$="";p.replace(/('|")(.*?)('|")/g,(v,D,M,_t)=>(S.push(`${D}${M}${_t}`),b)).replace(/\s+(&&|\|\||===?|!==?|<=|>=|\+=|-=)\s+/g,"$1").replace(/\s*\?\s*(.*?)\s*:\s*/g,"?$1:").replace(/(?<=[():\[\],\{\}"!'=])\s+/g,"").replace(/\s+(?=[():\[\],\{\}"!'=])/g,"").split(b).forEach((v,D)=>{$=$+v+(S[D]||"")}),p=$}return p}return null};return t.walk(c=>{if(c.tag&&c.attrs){if(Object.entries(c.attrs).forEach(([p,b])=>{if(["null","undefined"].includes(b)){delete c.attrs[p];return}const S=I(p,b||"");S&&(c.attrs[p]=S)}),c.tag==="script"&&c.attrs.type==="application/ld+json"&&c.content){const p=I(c.attrs.type,[].concat(c.content).join(""));p&&(c.content=[p])}c.attrs.class=(c.attrs.class||"").trim(),c.attrs.class||delete c.attrs.class}return c.tag&&(c.attrs=c.attrs||{},c.tag==="img"&&(c.attrs.alt=c.attrs.alt||""),c.tag==="button"&&(c.attrs.type=c.attrs.type||"button")),c}),t.match(k.default("style"),c=>{const p=et(c.content);return p&&x.push(J.process(p,{...V.options,from:n||void 0}).then(b=>{c.content=[b.css]})),c}),A.forEach(c=>{throw Error("Invalid selector: "+c)}),await Promise.all(x).then(()=>(f||t.match(k.default("head"),c=>{const p={tag:"meta",attrs:{property:"posthtml:view-head-placeholder",content:"*"}};return c.content?c.content.push(p):c.content=[p],c}),t))}function ws(t,e,s,r){return function(n){return typeof s.htmlProcessor=="function"&&(n=s.htmlProcessor(n)),Tt(s.parser,s.plugins,n,[Wt(t,e,s),ns(e,t.attrs,s)])}}function Wt(t,e,s){Bt();const{stylePreprocessor:r,styled:n,addClassIncludes:i,assets:o,noflip:f,cssjanus:h}=s,m=g=>Promise.resolve(r(g));return async function(g){const x=[];let w=!1,E="",j=null;if(g.match(k.default("style"),l=>{const u=l.attrs||{},P=bs(n,u),y=et(l.content);let _=u.src;const A=u.dynamic!=null||Ke(y);return(_||y)&&x.push(Promise.resolve(null).then(()=>_?(_=s.join(e.src,_),Z.default.readFile(_,s.encoding)):Promise.resolve(y)).then(a=>a?(a=f(a),m(a)):{code:""}).then(a=>{const d=a&&a.code;return{...a,code:h(d||""),to:A&&P.to==="file"?"head":P.to,type:P.type}})),w&&(l.tag=!1,delete l.content),w=!0,l}),x.length>0){const l=await Promise.all(x);x.length=0;const u=l[0].type;let P="",y="",_=n.to;const A=":__posthtml_view_to_file_start_mark__{}",a=":__posthtml_view_to_file_end_mark__{}";l.forEach($=>{$.to==="file"&&$.code&&($.code=`${A}${$.code}${a}`),$.type==="scoped"&&(P=P+($.code||"")),$.type==="global"&&(y=y+($.code||"")),$.to!=="file"&&$.to!==n.to&&(_=$.to)});const d=it(P,e.resolveId,s,e.src,A,a,!1),I=it(y,e.resolveId,s,e.src,A,a,!0);P=d.css,E=d.scopedHash,j=d.scopedClasses,y=I.css,I.scopedClasses.assetsCache.forEach($=>{j&&j.assetsCache.add($)}),I.scopedClasses.assetsCache.clear(),l.length=0;const c=$=>{let v="";return $=$.replace(/:__posthtml_view_to_file_start_mark__{}(.*?):__posthtml_view_to_file_end_mark__{}/gs,function(D,M){return v=v+M,""}),{css:$,fileCss:v}},p=c(P),b=c(y);P=p.css,y=b.css;let S="";u==="global"?S=b.fileCss+p.fileCss:S=p.fileCss+b.fileCss,g.match(k.default("style"),$=>(u==="global"?$.content=[y+P]:$.content=[P+y],P="",y="",$.attrs=$.attrs||{},$.attrs["data-to"]=_,$.attrs["data-scoped-hash"]=E,$.attrs["data-resolve-id"]=e.resolveId,delete $.attrs.scoped,delete $.attrs.global,delete $.attrs.src,delete $.attrs.to,delete $.attrs.dynamic,$)),S&&Array.isArray(g)&&g.push({tag:"style",attrs:{"data-to":"file","data-scoped-hash":E,"data-resolve-id":e.resolveId},content:S})}const C=s.prefix("js");if(g.match(k.default("script"),l=>{l.attrs=l.attrs||{};let u=l.attrs.src;return u&&/^(https?:)?\/\//.test(u)?l:l.attrs[C]==="null"||l.attrs[C]==="false"?(delete l.attrs[C],l):u&&l.attrs.type&&l.attrs.type==="module"?(l.attrs.src=s.join(e.src,u),l.attrs.src=s.slash(l.attrs.src,!0),l):(l.attrs.type&&l.attrs[C]==null||(u&&(u=s.join(e.src,u),l.attrs.src=s.slash(u,!0)),l.attrs["data-to"]=l.attrs.to,l.attrs["data-scoped-hash"]=E,l.attrs["data-resolve-id"]=e.resolveId,delete l.attrs.to),l)}),g.walk(l=>{if(typeof l=="string")return l;l.attrs=l.attrs||{};const u=j;if(u&&E&&l.tag){const _=l.attrs,A=_.class||"",a=d=>{i&&i.length&&(d={},i.forEach(I=>{d[I]=_[I]}));for(const I in d)if(Object.prototype.hasOwnProperty.call(d,I)){const c=d[I]||"";if(u.classNames.some(p=>c.includes(p)))return!0}return!1};(u.tags[l.tag]||a(_))&&!A.includes(E)&&(l.attrs.class=`${E} ${A}`.trim())}l.attrs.style&&x.push(J.process(l.attrs.style,{...V.options,from:e.src||void 0}).then(_=>{const A=".__posthtml_view_inline_css_123456_abcdef__{",a=it(`${A}${_.css}}`,e.resolveId,s,e.src,"","",!0);a.scopedClasses.assetsCache.forEach(I=>{j&&j.assetsCache.add(I)}),a.scopedClasses.assetsCache.clear();const d=a.css.replace(A,"").replace("}","");l.attrs&&(l.attrs.style=h(d))})),Object.keys(l.attrs).forEach(_=>{!o.attributes.includes(_)&&o.attrRegExp.test(_)&&o.attributes.push(_)});const P=typeof o._include=="function"&&o._include,y=_=>{if(!String(_).trim()||P&&!P(_)||Ct(_)||Et(_)||_.startsWith("#")||tt(_))return _;let A=s.join(e.src,_);return A=s.slash(A,!0),j&&j.assetsCache.add(A),A};return o.attributes.forEach(_=>{if(l.attrs[_]){const A=l.attrs[_];let a;const d=A.replace(/('|")(.*?)('|")/g,(I,c,p,b)=>(a=!0,`${c}${y(p)}${b}`));l.attrs[_]=a?d:y(A)}}),l}),x.length>0&&(await Promise.all(x),x.length=0),s.mode!=="development"&&j&&j.assetsCache.size){const l={tag:"div",attrs:{__posthtml_view_assets_div__:!0,style:"display:none;"},content:[]};j.assetsCache.forEach(u=>{Ze(u)?l.content.push({tag:"link",attrs:{rel:"preload",as:"font",href:u,"data-raw-url":u}}):l.content.push({tag:"img",attrs:{src:u,"data-raw-url":u}})}),l.content.length&&Array.isArray(g)&&g.push(l),j.assetsCache.clear()}return g}}function bs(t,e){t={...t},t.to=e.to||t.to||"head";let s=t.type;return e.scoped!=null?s="scoped":e.global!=null&&(s="global"),t.type=s||"scoped",t}function $s(t,e){return t.source!=null?Promise.resolve(t.source||""):Z.default.readFile(t.src,e)}function xs(t,e,s,r){const n=r.prefix("query");return(t[n]||"")==="global"?r.components[e]:s[e]||r.components[e]}function js(t,{from:e,prefix:s,join:r,slash:n}){const i={};return t.match(k.default(s("components")),o=>(o.content&&o.content.forEach(f=>{if(typeof f=="string")return;let{src:h,...m}=f.attrs||{};f.tag&&h&&(h=r(e,h),i[f.tag]={tag:f.tag,src:h,resolveId:n(h),locals:m})}),o.tag=!1,delete o.content,o)),t.match(k.default(s("component")),o=>{const f=o.attrs||{};let h=!1;if(f.src){const m="view-src-"+Qe(f.src),g=r(e,f.src);i[m]={tag:m,src:g,resolveId:n(g),locals:{}},o.tag=m,delete f.src}else h=!0;return h&&(o.tag=!1,delete o.content),o}),i}function et(t){return[].concat(t||"").join("").trim()}function st(...t){return[].concat(...t).filter(Boolean)}function Gt(t){const e={...t||{}};return e.root=e.root||process.cwd(),e.mode=e.mode||"development",e.encoding=e.encoding||"utf8",e.viewPrefix=e.viewPrefix||"view:",e.from=e.from||"",e.plugins=e.plugins||[],e.parser=e.parser||{},e.locals=e.locals||{},e.$attrs=e.$attrs||"$attrs",e.stylePreprocessor=e.stylePreprocessor||(s=>({code:s})),e.js={type:"ts",...e.js},e.assets={...e.assets},e.assets.attributes=e.assets.attributes||["data-src","data-img"],e.assets.attrRegExp=e.assets.attrRegExp||At,e.styled={type:"scoped",to:"head",prefix:"view-",...e.styled},typeof e.getOptions=="function"&&e.getOptions(e),e.join=(s,r)=>Ve(e.root,e.from,s,r),e.slash=(s,r)=>Be(e.root,s,r),e.prefix=s=>`${e.viewPrefix}${s}`,e.rtl=e.rtl||!1,e.cssjanus=s=>e.rtl&&e.mode==="development"?nt(s,{transformEdgeInUrl:e.rtl.transformEdgeInUrl,transformDirInUrl:e.rtl.transformDirInUrl}):s,e.noflip=s=>e.rtl?St(s):s,async function(r){e.components=await ls(e);const n=await _s(e)(r);return await Tt(e.parser,e.plugins,n)}}const Ut=/\.(css|scss|less|sass|styl|stylus|pcss|postcss)$/;function Lt(t){const e=Ut.test(t);return Ut.lastIndex=0,e}function Cs(t,e){t.build=t.build||{},t.build.rollupOptions=t.build.rollupOptions||{},t.build.ssr=!1;const{input:s,pages:r}=Ps(t.root||process.cwd(),e);return t.build.rollupOptions.input=s,t.server=t.server||{},t.server.open===!0&&(t.server.open=r[0]&&`/${r[0].route||""}`||"/"),t}function Es(t){const e=[];return Jt(t).forEach(r=>{const n=`./${r.path}`;r.pageName==="index"&&e.push({from:/^\/$/,to:n}),e.push({from:new RegExp(`^/${r.route}/*`),to:n}),e.push({from:new RegExp(`^/${r.route}$`),to:n})}),e}function Ps(t,e){const s=Jt(e),r={};return s.forEach(n=>{r[n.pageName]=q.default.resolve(t,n.path)}),{input:r,pages:s}}function Jt({pagesDirectory:t,includes:e,ignore:s}){return e=e.filter(Boolean).map(r=>r[0]==="/"?r:"/"+r),Ae.default.sync(`${t}/**/*.html`.replace("//","/"),{objectMode:!0,ignore:s.map(r=>(r.includes(".")?r:`**/${r}/**`).replace("//","/"))}).filter(r=>e.some(n=>r.path.includes(n))?!0:!r.path.includes("/_")).map(({name:r,path:n})=>{const i={filename:r,path:n,route:"",pageName:""};return i.route=n.replace(`${t}/`,""),i.pageName=i.route.replace(/(\/index)?\.html/,"").replace("/","-"),i})}const zt="0123456789abcdef",Qt={"=":"\\:",php:"\\#","\\:":"=","\\#":"php"},Yt=/\\{\\%(\\:|\\#)(.*?)\\%\\}/gs,Is=/<\?(=|php)(.*?)\?>/gs,ks=/(\\%\\})=""/g;function Zt(t){return t.replace(Yt,function(e,s,r){return`<?${Qt[s]||s}${r}?>`})}function Xt(t){return t.replace(Is,function(e,s,r){return`\\{\\%${Qt[s]||s}${Ss(r,zt)}\\%\\}`})}function Kt(t){return t.replace(ks,"$1").replace(Yt,function(e,s,r){return`\\{\\%${s}${As(r,zt)}\\%\\}`})}function Ss(t,e){const s=B.createCipheriv("aes128",e,e);let r=s.update(t,"utf8","hex");return r+=s.final("hex"),r}function As(t,e){const s=B.createDecipheriv("aes128",e,e);let r=s.update(t,"hex","utf8");return r+=s.final("utf8"),r}async function Rs(t,e=!0){let s=null;if(t){const r=$t.default.test("-f",t),n=t.replace(".ts",".js"),i=r||$t.default.test("-f",n);try{let o=null;const f=h=>{e&&require&&require.cache&&!!require.cache[h]&&delete require.cache[h]};r?(f(t),o=require(t)):i&&(f(n),o=require(n)),o&&(s=o.__esModule?o.default:o)}catch(o){console.error(o)}}return s||{}}const te=new Map;async function Ds(t,e,s,r){const n=q.default.join(s,".php-dev",r);return te.get(r)!==t&&(te.set(r,t),await Z.default.outputFile(q.default.resolve(e,n),t,"utf8")),{tplFileName:n,__views:""}}async function Hs(t,e){const{__views:s,...r}=e,n=r;n._TEMPLATE=t,n._REGISTER_GLOBAL_MODEL=!0,n._VIEWS_PATH=s;const i=JSON.stringify(n,Re.default()),{stdout:o}=await De.default("php",[q.default.join(__dirname,"/loader.php")],{input:i});return o}const ot={caseSensitive:!0,collapseBooleanAttributes:!0,collapseInlineTagWhitespace:!0,collapseWhitespace:!0,conservativeCollapse:!1,html5:!0,minifyCSS:!0,minifyJS:!0,minifyURLs:!0,noNewlinesBeforeTagClose:!0,removeAttributeQuotes:!0,removeComments:!0,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,removeTagWhitespace:!1,useShortDoctype:!0};let ut;async function rt(t,e){return typeof e.minifyHtml=="function"&&(e.minifyHtml=e.minifyHtml(ot)),e.minifyHtml&&(ut=ut||(e.minifyHtml===!0?ot:{...ot,...e.minifyHtml,removeTagWhitespace:!1}),t=await je.minify(t,ut),typeof e.minifyHtmlAfter=="function"?t=e.minifyHtmlAfter(t):t=t.replace(/>(\s+)</g,"><")),t}function ft(t){return t.split("?__posthtml_view__=")[0]}const Ts=(t,e,s,r,n)=>{function i(h){const m=q.default.resolve(t.root,e.pagesDirectory);return q.default.relative(m,h)}const o=t.command==="serve",f='<div style="text-align:center;"><h1>posthtml-view</h1><p>No content</p></div>';return async(h,m)=>{const g=i(m.filename);e.php&&(h=Xt(h));const x=L.default([Gt({...e,from:m.filename,htmlProcessor(w){return Xt(w)},styled:{...e.styled,extract:w=>{const E=ft(w.mainjs),j=`${s}/${w.resolveId.replace(".html",".css")}`,C=`import '${j}';`;n.set(j,w.source||"");const l=r.get(E)||"";l.includes(j)||r.set(E,l+C)}},js:{...e.js,extract:w=>{const E=ft(w.mainjs);if(w.src){const j=r.get(E)||"",C=`import '${w.src}';`;j.includes(w.src)||r.set(E,j+C)}else{const j=`${s}/${w.resolveId.replace(".html","")}`,C=`import '${j}';`;n.set(j,w.source||"");const l=r.get(E)||"";l.includes(j)||r.set(E,l+C)}}}}),...e.plugins||[]]);if(typeof e.usePlugins=="function"&&e.usePlugins(x),h=(await x.process(h,{directives:[{name:"!DOCTYPE",start:"<",end:">"},{name:"?php",start:"<",end:">"},{name:"?=",start:"<",end:">"}],...e.parser,sync:!1})).html.trim(),o)if(e.php){if(h=Kt(h),e.devMinifyHtml&&(h=await rt(h,e)),h=Zt(h),typeof e.php.devRender=="function")h=await e.php.devRender({html:h,options:e});else{const w=q.default.join(t.root,e.mocksDirectory,g.replace(".html",".ts")),[E,{tplFileName:j,__views:C}]=await Promise.all([Rs(w,!0),Ds(h,t.root,e.cacheDirectory,g)]);h=await Hs(j,{__views:C,...E})}return h||f}else e.devMinifyHtml&&(h=await rt(h,e));return h}};let O,pt,ht,W;const H={classesKey:"_classes",idsKey:"_ids",_classes:{},_ids:{},classes:{},ids:{}},z={},Q={};function ee(t,e){try{const s=W.getItem(t)||{};return Object.keys(s).forEach(r=>{const n=s[r];e[n]=null}),s}catch{return{}}}async function qs(){W&&(W.setItem(H.classesKey,H.classes),W.setItem(H.idsKey,H.ids))}function Ns(t){O=O||t,O.__cache_file__&&!W&&(W=new Ee.JSONStorage(O.__cache_file__),H._classes=ee(H.classesKey,z),H._ids=ee(H.idsKey,Q)),pt=pt||at(O.generateNameFilters,O.upperCase,e=>z[e]!==null),ht=ht||at(O.generateNameFilters,O.upperCase,e=>Q[e]!==null)}function se(t){const e=wt.default(t);function s(r){r.forEach(n=>{if(n.type==="atrule"&&(n.name==="media"||n.name==="supports"))s(n.nodes);else switch(n.type){case"rule":n.selector=Ms(n.selector);break}})}return s(e.nodes),e.toString()}function Ms(t){return bt.default(e=>{e.walkClasses(s=>{if(G(s.value,!1,!1))return;let r=s.value,n=!1;const i=r.replace(K,o=>(n=!0,` ${o} `));if(n){r=i.split(/\s+/).map(o=>{if(!o)return"";if(G(o,!1))return o;const f=mt(o);return U(f)||o}).filter(Boolean).join("").trim(),r=Pt(r),s.setPropertyWithoutEscape("value",r);return}s.setPropertyWithoutEscape("value",U(mt(r))||r)}),e.walkIds(s=>{G(s.value,!0)||(s.value=U(dt(s.value))||s.value)})}).processSync(t)}function mt(t){const e=H._classes[t];if(e)return z[e]=null,H.classes[t]=e,delete H._classes[t],e;const s=H.classes[t];if(s)return z[s]=null,s;const r=pt.next().value;return z[r]=null,H.classes[t]=r,r}function dt(t){const e=H._ids[t];if(e)return Q[e]=null,H.ids[t]=e,delete H._ids[t],e;const s=H.ids[t];if(s)return Q[s]=null,s;const r=ht.next().value;return Q[r]=null,H.ids[t]=r,r}function G(t,e,s){return s!==!1&&Rt(t)?!0:(t=(e?"#":".")+t,O.filters.some(r=>typeof r=="string"?r===t:r.test(t)))}function U(t){return t&&O.prefix+t}function Os(t){if(G(t,!0))return;const e=dt(t);if(e)return U(e)}function re(t){if(t=t.slice(1),G(t,!0))return;const e=H.ids[t];if(e)return"#"+U(e)}const Fs=/\\?%\\?}(.*?)\\?{\\?%/gs,Vs=/\s+(\\?{\\?%)/g;function Y(t,e,s){return t&&(e||(t=t.replace(K,r=>` ${r} `)),t=t.split(/\s+/).map(r=>{if(!r)return"";if(G(r,e)||typeof s=="function"&&s(r))return r;const n=e?dt(r):mt(r);return U(n)||r}).filter(Boolean).join(" ").trim(),e||(t=t.replace(Fs,(r,n)=>n?r.replace(n,` ${n.trim()} `):r).replace(Vs,"$1")),t)}const ae="[[rtl]]",ne="[[ltr]]",gt={type:"syntax",syntax:`<?php if($rtl): ?>${ae}<?php else: ?>${ne}<?php endif; ?>`,devPreview:t=>!!(t&&(t.includes("rtl=1")||t.includes("lang=ar")))},ce={enableCache:!0,generateNameFilters:[],upperCase:!0,filters:[/^(\.|#)js-/],attributes:[],blurryAttrs:[],prefix:"",__cache_file__:""};let T;function Bs(t){return typeof t.rtl=="boolean"?t.rtl?gt:!1:{...gt,...t.rtl}}const Ws=/(.*)\[\[(rtl|ltr)\]\](.*)\[\[(rtl|ltr)\]\](.*)/si;function Gs(t,e){const s=Ce.createFilter(["**/*.html"]);let r,n=t.preloadCss!==!1;const{type:i,syntax:o}=e||gt,f=C=>nt(C,{transformDirInUrl:e&&e.transformDirInUrl||!1,transformEdgeInUrl:e&&e.transformEdgeInUrl||!1}),h=()=>o&&(o.includes(ae)||o.includes(ne));let m=null;if(e&&i==="syntax"&&h()){const C=o.match(Ws);C&&C.length>=6&&(m=C.slice(1).map(l=>l.trim()).filter(Boolean))}const g=["crossorigin","nomodule","defer","async","hidden","x-transition","x-ignore","x-cloak","x-collapse",...t.boolAttrs||[]],x=[],w=[];function E(C){C.walk(l=>(l.attrs&&Object.keys(l.attrs).forEach(P=>{l.attrs[P]===""&&g.some(y=>y.indexOf(P)===0)&&(l.attrs[P]=!0)}),l))}const j=async C=>(await L.default([]).use(l=>(l.match(k.default("head"),u=>{const P=[];l.match.call(u,k.default('link[rel="preload"][as="style"][href]'),a=>(a.tag=!1,a)),l.match.call(u,k.default('link[rel="stylesheet"][href]'),a=>{const d=a.attrs||{};return a.tag&&d.href&&x.some(I=>d.href&&d.href.includes(I))&&(n&&P.push({tag:"link",attrs:{...d,rel:"preload",as:"style",href:d.href}}),P.push({tag:"link",attrs:d}),a.tag=!1),a}),l.match.call(u,k.default('script[type="module"][src],link[rel="modulepreload"][href]'),a=>{const d=a.attrs||{},I=d.href||d.src;return a.tag&&I&&w.some(c=>I.includes(c))&&(P.push({tag:a.tag,attrs:d}),a.tag=!1),a});const y=[];l.match.call(u,k.default('link[rel="preload"][as="image"][href]'),a=>{const d=a.attrs||{};return a.tag&&d.href&&(y.push({tag:"link",attrs:d}),a.tag=!1),a});const _=[];l.match.call(u,k.default("style[__posthtml_view_css__]"),a=>{const d=ie(a.content);return a.tag&&d&&!_.includes(d)&&_.push(d),a.tag=!1,delete a.content,a});const A=_.map(a=>({tag:"style",content:a}));return l.match.call(u,k.default('meta[property="posthtml:view-head-placeholder"]'),a=>(a.content=[...P,...y,...A],a.tag=!1,a)),u}),T&&l.match(k.default("style"),u=>{if(u.attrs&&u.attrs["data-min-class-ignore"]!=null)return delete u.attrs["data-min-class-ignore"],u;const P=ie(u.content);return P&&(u.content=[se(P)]),u}),l)).use(l=>{const u=new Map,P=a=>(a&&u.size&&u.forEach((d,I)=>{a=le(a,I,d)}),a);l.match(k.default("div[__posthtml_view_assets_div__]"),a=>(l.match.call(a,k.default("[data-raw-url]"),d=>(d.attrs&&d.attrs["data-raw-url"]&&u.set(d.attrs["data-raw-url"],d.attrs.href||d.attrs.src||""),d.tag=!1,d)),a.tag=!1,delete a.content,a));const y=t.assets.attributes,_=t.assets.attrRegExp;l.walk(a=>{if(typeof a=="string")return a;if(a.attrs){const d=Object.keys(a.attrs);d.forEach(c=>{!y.includes(c)&&_.test(c)&&y.push(c)}),y&&y.forEach(c=>{a.attrs[c]&&(a.attrs[c]=P(a.attrs[c]))}),a.attrs.style&&(a.attrs.style=P(a.attrs.style));const I=(a.attrs["view-build-class"]||"").split(" ").filter(Boolean);if(delete a.attrs["view-build-class"],T){const c=[...T.attributes,/^[xv]-transition/],p=[...T.blurryAttrs,/^([xv]-bind)?:class/],b=(v,D)=>v.some(M=>typeof M=="string"?M===D:M.test&&M.test(D)),S=v=>r.assetsInclude(v)?!0:I.length?!I.includes(v):!1;if(d.forEach(v=>{if(!(v==="id"||v==="class")&&typeof a.attrs[v]=="string"&&!(typeof a.attrs[v]=="string"&&!a.attrs[v].trim()))if(b(c,v))a.attrs[v]=Y(a.attrs[v],!1,S);else if(b(p,v)){const D=a.attrs[v]||"";let M;const _t=D.replace(/('|")(.*?)('|")/g,(Ys,Js,zs,Qs)=>(M=!0,`${Js}${Y(zs,!1,S)}${Qs}`));a.attrs[v]=M?_t:D}else I.length&&I.forEach(D=>{if(a.attrs[v].includes(D)){const M=Y(D);a.attrs[v]=le(a.attrs[v],D,M)}})}),a.attrs.class&&(a.attrs.class=Y(a.attrs.class)),a.attrs.id&&(a.attrs.id=Y(a.attrs.id,!0)),a.attrs.for){const v=Os(a.attrs.for);v&&(a.attrs.for=v)}if(["mask","fill","filter"].forEach(v=>{if(a.attrs[v]){const D=re(a.attrs[v].replace(/url\((.*?)\)/g,"$1"));D&&(a.attrs[v]=`url(${D})`)}}),a.tag==="use"&&(a.attrs.href||a.attrs["xlink:href"])){const v=a.attrs.href?"href":"xlink:href",D=re(a.attrs[v]||"");D&&(a.attrs[v]=D)}}}return a});const A="posthtml-view-syntax-style-x";return l.match(k.default("style"),a=>{let d=P([].concat(a.content||"").join("").trim()),I=d&&ct(d,"");if(I&&m&&m.length){const c=f(d);if(c!==I)return a.content=m.map(p=>p==="rtl"?{tag:A,attrs:a.attrs,content:c}:p==="ltr"?{tag:A,attrs:a.attrs,content:I}:p),a.tag=!1,a.attrs=void 0,a}return I&&(a.content=[I]),a}),m&&m.length?(l.match(k.default("link[href]"),a=>{const d=a.attrs&&a.attrs.href;if(a.attrs&&d&&d.endsWith(".css")&&m){const I=d.replace(".css",".rtl.css");a.attrs.href=m.map(c=>c==="rtl"?I:c==="ltr"?d:c).join("")}return a}),l.match(k.default("html"),a=>(m&&(a.attrs=a.attrs||{},a.attrs.dir=m.map(d=>d==="rtl"?"rtl":d==="ltr"?"ltr":d).join("")),a))):l.match(k.default("html"),a=>(a.attrs=a.attrs||{},a.attrs.dir="ltr",a)),Promise.resolve().then(()=>(l.match(k.default(A),a=>(a.tag="style",a)),l))}).use(l=>Promise.resolve().then(()=>{let u;return typeof t.generateUsePlugins=="function"&&(u=t.generateUsePlugins(l)),E(u||l)})).process(C,{})).html;return{name:"view:posthtml-view-bundle",enforce:"post",apply:"build",configResolved(C){r=C},async generateBundle(C,l){const u=t.minifyClassnames;u&&!T&&(T=u===!0?ce:{...ce,...u},T.prefix=T.prefix&&X(T.prefix),T.filters=[...T.filters,"#vite-legacy-polyfill","#vite-legacy-entry"],T.enableCache?T.__cache_file__=q.default.join(r.root,q.default.join(t.cacheDirectory,"css")):T.__cache_file__="",Ns(T));const P=Object.values(l);for(const y of P)if(y.fileName.endsWith(".js")&&!w.includes(y.fileName)&&w.push(y.fileName),y.type==="asset"&&y.fileName.endsWith(".css")){!x.includes(y.fileName)&&x.push(y.fileName);let _=yt(y.source);T&&(_=se(_)),y.source=ct(_,""),e&&this.emitFile({type:"asset",fileName:y.fileName.replace(".css",".rtl.css"),name:y.name?y.name.replace(".css",".rtl.css"):void 0,source:f(_)})}for(const y of P){if(y.type==="asset"&&s(y.fileName)){let _=yt(y.source);_=await j(_),t.php&&(_=Kt(_)),_=await rt(_,t),t.php&&(_=Zt(_)),y.source=_;const{fileName:A,name:a}=Us(y.fileName,y.name,t);if(y.fileName=A,y.name=a,e&&i==="new-html"){let d=(await L.default([]).use(I=>(I.match(k.default("html"),c=>(c.attrs=c.attrs||{},c.attrs.dir="rtl",c)),I.match(k.default("link[href]"),c=>(c.attrs&&c.attrs.href&&c.attrs.href.endsWith(".css")&&(c.attrs.href=c.attrs.href.replace(".css",".rtl.css")),c)),I.match(k.default("style"),c=>{const p=[].concat(c.content||"").join("").trim();return p&&(c.content=[f(p)]),c}),E(I))).process(_,{})).html;d&&(d=await rt(d,t),this.emitFile({type:"asset",fileName:A.replace(/\.(html?|php)/g,".rtl.$1"),name:a?a.replace(/\.(html?|php)/g,".rtl.$1"):void 0,source:d}))}}if(y.type==="chunk"&&y.fileName.includes("-legacy")&&typeof t.removeCssInJs=="function"){const _=t.removeCssInJs(yt(y.code));y.code=_||y.code}}await qs()}}}function Us(t,e,s){const{buildPagesDirectory:r,pagesDirectory:n,php:i}=s;if(r!==n){const o=t.indexOf(n);o>=0&&(t=r+t.slice(o+n.length))}return i&&i.rename&&(t=t.replace(/\.(html?)/g,".php"),e&&(e=e.replace(/\.(html?)/g,".php"))),{fileName:t,name:e}}function yt(t){return t instanceof Uint8Array?Buffer.from(t).toString("utf-8"):t}function le(t,e,s){for(;t.includes(e);)t=t.replace(e,s);return t}function ie(...t){return[].concat(...t).filter(Boolean).join("").trim()}function Ls(t){const e=vt.merge({includes:[],ignore:[],pagesDirectory:"pages",mocksDirectory:"mocks",buildPagesDirectory:"pages",cacheDirectory:".posthtml-view-cache",usePlugins:null,rtl:!1,minifyHtml:!0,devMinifyHtml:!1,minifyClassnames:!1,preloadCss:!0},t||{});e.pagesDirectory=e.pagesDirectory||"pages",e.buildPagesDirectory=e.buildPagesDirectory||e.pagesDirectory,e.cacheDirectory=e.cacheDirectory||".posthtml-view-cache",e.getOptions=h=>{e.styled=h.styled,e.assets=h.assets};const s=new Map,r=new Map,n="virtual:posthtml-view",i=Bs(e),o=()=>{const h="view:posthtml-view-pages";let m;return{name:h,enforce:"pre",config(g,{mode:x}){Cs(g,e)},configResolved(g){m=g,e.root=m.root,e.assets=e.assets||{},e.assets._include=m.assetsInclude,e.mode=m.command==="build"?"production":"development"},transformIndexHtml:{enforce:"pre",async transform(g,x){return m.command==="serve"?i&&typeof i.devPreview=="function"&&i.devPreview(x.originalUrl)?e.rtl=i:e.rtl=!1:e.rtl=i,await Ts(m,e,n,s,r)(g,x)}},async resolveId(g,x){return g===n||/\?__posthtml_view__=(0|1)/g.test(g)||g.startsWith(n)?g:null},async load(g){if(g===n)return"";if(/\?__posthtml_view__=(0|1)/g.test(g)){const x=ft(g),w=g.includes("__posthtml_view__=1");let E="";return w||(E=E+`import '${x.replace(/\.(t|j)s/g,"")}';`),E=E+(s.get(x)||""),E}return g.startsWith(n)?r.get(g)||"":null},async transform(g,x){return m.command==="build"&&i&&Lt(x)?St(g):null}}};return[(()=>({name:"view:posthtml-view-dev",enforce:"pre",apply:"serve",configureServer(h){h.middlewares.use(Se.default({verbose:Boolean({}.DEBUG)&&{}.DEBUG!=="false",disableDotRule:void 0,htmlAcceptHeaders:["text/html","application/xhtml+xml"],rewrites:Es(e)}))},async transform(h,m){return i&&e.rtl&&Lt(m)?nt(h,{transformDirInUrl:i.transformDirInUrl||!1,transformEdgeInUrl:i.transformEdgeInUrl||!1}):null},async handleHotUpdate({file:h,server:m}){return(h.includes("/"+e.mocksDirectory)||h.includes(".html"))&&m.ws.send({type:"full-reload",path:"*"}),[]}}))(),o(),Gs(e,i)]}R.compilerViewPlugin=Gt,R.generateName=at,R.slugify=jt,R.toValidCSSIdentifier=X,R.vitePluginPosthtmlView=Ls,Object.defineProperty(R,"__esModule",{value:!0}),R[Symbol.toStringTag]="Module"});
